<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>


<script language="javascript" type="text/javascript">

function sendLogoutMsg()
{
	document.logoutForm.logoutMsg.value = "yes";
	document.logoutForm.submit();
	return;
}

function isBridgeMode()
{
        var wan_type="";
        if (wan_type=="bridge")
                document.getElementById("add_applybtn").disabled=true;
}

function check_process()
{    
	var process="Success";
	if (process=="Existed")
		warn_wait();
		//alert("Please wait!!Another client is upgading firmware.");
}

function DmzCheck()
{
	if (document.natfw_dmz_form.DMZEnable.value==0) 
	{
		document.natfw_dmz_form.DmzOpt[0].disabled=true; 
		document.natfw_dmz_form.DmzOpt[1].disabled=true; 
		document.natfw_dmz_form.NATDmzIpAddrSelect.disabled=true;
		document.natfw_dmz_form.NATDmzIpAddrInput.disabled=true;
	    	document.getElementById("id_NATDmzIpAddrInput_item1").disabled=true;
		document.getElementById("id_NATDmzIpAddrInput_item2").disabled=true;
		document.getElementById("id_NATDmzIpAddrInput_item3").disabled=true;
    		document.getElementById("id_NATDmzIpAddrInput_item4").disabled=true;
		document.natfw_dmz_form.DMZTimer.disabled=true; 
	}
	else
	{
		document.natfw_dmz_form.DmzOpt[0].disabled=false; 
		document.natfw_dmz_form.DmzOpt[1].disabled=false;
		document.natfw_dmz_form.NATDmzIpAddrSelect.disabled=false;
		document.natfw_dmz_form.NATDmzIpAddrInput.disabled=false;
		document.getElementById("id_NATDmzIpAddrInput_item1").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item2").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item3").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item4").disabled=false;
		document.natfw_dmz_form.DMZTimer.disabled=false;
		DmzChange();
	}
}

function DmzChange()
{
	if (document.natfw_dmz_form.DmzOpt[0].checked==true) 
	{
		document.natfw_dmz_form.NATDmzIpAddrSelect.disabled=false; 
		document.natfw_dmz_form.NATDmzIpAddrInput.disabled=true;
		document.getElementById("id_NATDmzIpAddrInput_item1").disabled=true;
    		document.getElementById("id_NATDmzIpAddrInput_item2").disabled=true;
    		document.getElementById("id_NATDmzIpAddrInput_item3").disabled=true;
    		document.getElementById("id_NATDmzIpAddrInput_item4").disabled=true;
	}
	else
	{
		document.natfw_dmz_form.NATDmzIpAddrSelect.disabled=true; 
		document.natfw_dmz_form.NATDmzIpAddrInput.disabled=false;
		document.getElementById("id_NATDmzIpAddrInput_item1").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item2").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item3").disabled=false;
    		document.getElementById("id_NATDmzIpAddrInput_item4").disabled=false;
	}
}

function valueMatch(s1, s2, match_return)
{
	if(s1 == s2)
		return match_return;
	else
		return "";
}

function natfw_dmz()
{
  //merge ip to hidden item
  merge_ip("id_NATDmzIpAddrInput", "id_NATDmzIpAddrInput_item1", "id_NATDmzIpAddrInput_item2", "id_NATDmzIpAddrInput_item3", "id_NATDmzIpAddrInput_item4");

	if (document.natfw_dmz_form.DMZEnable.value==1)
	{       
	      	if(document.natfw_dmz_form.DMZTimer.value.length!=0)
	      	{
	      		if((!check_integer(document.natfw_dmz_form.DMZTimer.value))||(isInitialZero(document.natfw_dmz_form.DMZTimer.value)))
	        	{
					warn_int("DMZ timer");
					//alert("The DMZ timer should be an integer.");
					return false;
				}
			}	
		if (document.natfw_dmz_form.DmzOpt[0].checked==true)
		{
			document.natfw_dmz_form.NATDmzIpAddr.value=document.natfw_dmz_form.NATDmzIpAddrSelect.value;
		}
		else
		{
		
			if((document.natfw_dmz_form.NATDmzIpAddrInput.value == "")     ||
			   (!check_ip(document.natfw_dmz_form.NATDmzIpAddrInput.value)))
			{
				var item="DMZ Host IP Address";
				//var no="";
				//alert("The" + item + "is invalid!");
				alert("The "  + item + " is invalid!");
				return false;
			}
			
		 	document.natfw_dmz_form.NATDmzIpAddr.value=document.natfw_dmz_form.NATDmzIpAddrInput.value;
		}
	}

//	alert("After applying changes, you shall reboot it.");
	fvt_form_submit('natfw_dmz_form');
	document.natfw_dmz_form.submit();

}
function fvt_form_init(form_name) 
{
	if (form_name=='natfw_dmz_form' || form_name=='*') {
		fvt_form_obj_set("natfw_dmz_form", "DMZEnable", fvt_meta_config('nat0_dmz_enable'));		//select-one
		console.log("fvt_meta_config('nat0_dmz_option')=="+fvt_meta_config('nat0_dmz_option'));
		if(fvt_meta_config("nat0_dmz_option")=="")
		{
			document.getElementById("id_dmz_ip_auto").checked = true;
			document.getElementById("id_NATDmzIpAddrInput_item1").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item2").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item3").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item4").value = "";
		}
		else if( fvt_meta_config("nat0_dmz_option")=='192.168.1.2')
		{
			document.getElementById("id_dmz_ip_auto").checked = true;
			document.getElementById("id_NATDmzIpAddrInput_item1").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item2").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item3").value = "";
			document.getElementById("id_NATDmzIpAddrInput_item4").value = "";
		}
		else
		{
			document.getElementById("id_dmz_ip_manual").checked = true;
			var ip_item = new Array();
			ip_item = fvt_meta_config('nat0_dmz_option').split(".");
			document.getElementById("id_NATDmzIpAddrInput_item1").value = ip_item[0];
			document.getElementById("id_NATDmzIpAddrInput_item2").value = ip_item[1];
			document.getElementById("id_NATDmzIpAddrInput_item3").value = ip_item[2];
			document.getElementById("id_NATDmzIpAddrInput_item4").value = ip_item[3];
		}
		
		fvt_form_obj_set("natfw_dmz_form", "DMZTimer", fvt_meta_config('nat0_dmz_timer'));		//text
	}
}

function fvt_form_submit(form_name) 	{
	fvt_paramlist_clear();
	if (form_name=='natfw_dmz_form' || form_name=='*') {
		for (var i =0; i < 8; i++)
		{
			fvt_paramlist_cat_str("nat"+i+"_dmz_enable", fvt_form_obj_get("natfw_dmz_form", "DMZEnable"));		//select-one
			if (document.getElementById("id_dmz_ip_auto").checked)
			{
				fvt_paramlist_cat_str("nat"+i+"_dmz_option", fvt_form_obj_get(form_name, "NATDmzIpAddrSelect"));	
			}
			else
			{
				fvt_paramlist_cat_str("nat"+i+"_dmz_option", fvt_form_obj_get(form_name, "NATDmzIpAddrInput"));		
			}
			
			fvt_paramlist_cat_str("nat"+i+"_dmz_timer", fvt_form_obj_get("natfw_dmz_form", "DMZTimer"));		//text
		}
	}
	fvt_paramlist_presubmit(form_name);
}

</script>
</head>

<body align="left" onload="fvt_form_init('natfw_dmz_form');DmzCheck();check_process();isBridgeMode();">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="id_natfw_dmz_form" name="natfw_dmz_form" method="post">
	<fieldset>
		<div class="lv1_title">
		Firewall Setup&nbsp;&gt;&nbsp;Demilitarized Zone(DMZ)</div>
	</fieldset>
<div class="div1_indent">
	<div class="lv3_new" ctrlflip="etc" ctrltxt="dmz">
		Please note that these settings should only be configured with the help and guidance of your service provider.
	</div>
  <div class="lv2_new top_dmz">
	<input name="NATDmzIpAddr" type="hidden">
	<table>
		<tr>
			<td class="width_dmz1"><table ctrlflip="right"><tr>
				<td><div iid='220' ctrlid="220">Demilitarized Zone</div></td>
				<td><div>(</div></td>
				<td><div ctrlid="471">DMZ</div></td>
				<td><div>)</div></td>
			</tr></table></td>
			<td ctrlflip="etc"><select ar='1' name="DMZEnable" onchange="DmzCheck();" class="width_select80" >
					<option value="0">Disable</option>
					<option value="1">Enable</option>								
				</select>
			</td>
		</tr>		
		<tr>
			<td><div ctrlflip="right" ctrlid="221">DMZ Host IP Address</div></td>
			<td>
				<input disabled="disabled" name="DmzOpt" id="id_dmz_ip_auto" value="0" onclick="DmzChange()" type="radio" class="radio">
				<select name="NATDmzIpAddrSelect"  class="width_select80">
					<option value="192.168.1.2">192.168.1.2</option>			
				</select>
			</td>
		</tr>
		<tr>
			<td></td><td>
				<input disabled="disabled" name="DmzOpt"   id="id_dmz_ip_manual" value="1" onclick="DmzChange()" type="radio" class="radio">
				<input disabled="disabled" name="NATDmzIpAddrInput" id="id_NATDmzIpAddrInput" value="" type="hidden">
				<input id="id_NATDmzIpAddrInput_item1" class="width_ip" size="2" maxlength="3" type="text">.
				<input id="id_NATDmzIpAddrInput_item2" class="width_ip" size="2" maxlength="3" type="text">.
				<input id="id_NATDmzIpAddrInput_item3" class="width_ip" size="2" maxlength="3" type="text">.
				<input id="id_NATDmzIpAddrInput_item4" class="width_ip" size="2" maxlength="3" type="text">
			</td>
		</tr>
	</table>
  </div>
  <div class="top_dmz2">
	<table>
		<tr>
			<td class="width_dmz1" ctrlflip="right">
			<table><tr>
				<td><div class='lv2_new' iid='222' ctrlid="472">DMZ Timer</div></td>
				<td><div class='lv2_new'>(</div></td>
				<td><div class='lv2_new' ctrlid="368">Option</div></td>
				<td><div class='lv2_new'>)</div></td>
			</tr></table></td>
			<td>
				<table><tr>
					<td><input ctrlflip="etc" name="DMZTimer"  size="8" maxlength="8" type="text" class="width_text80"></td>
					<td><div class="suffix_lr" ctrlflip="etc">s</div></td>
				</tr></table>
			</td>
		</tr>
	</table>
 </div>
  <div class="top_cwmp2">
	<table>
		<tr>
			<td class="button_center">
				<input type="button" onclick="natfw_dmz()" id="add_applybtn" name="applybtn"  value="Apply Changes" class="width_button" class="width_apply">
			</td>
		</tr>
	</table>
  </div>
 </div>
</form>
</td></tr>	
</tbody></table>
</div>

<br>		
</body>
</html>





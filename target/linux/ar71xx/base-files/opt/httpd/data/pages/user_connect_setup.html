<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<link href="../css/zycss.css" rel="stylesheet" type="text/css" />
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<script language="javascript" type="text/javascript" src="../js/md5.js"></script>
<script language="javascript" type="text/javascript" src="../js/rc4.js"></script>

<style type="text/css">
tr.rowt{background-color:#E0E0E0}
tr.rowh{background-color:#F0F0F0}
/* DarkBlue */
div.rowh{color:#00008B}
div.cellt{color:DarkGray}
/* DarkSlateGrey */
div.cells{color:#2F4F4F}
</style>
<script language="javascript" type="text/javascript">
var NavLang=GetNavLang();
if (NavLang == "ZH")
{
var vHidden = "隱藏";
var vNotHidden = "不隱藏";
var vDhcpSetting = "DHCP 設定";
var vSetup = "設定";
var vOpen = "開放系統";
var vShared = "共用金鑰";
var vNameSSID = "名稱\(SSID\)";
var vAppSave = "儲存";
var vLocalNet = "區域網路";
var vWanMode = "WAN端模式";
var vWanUserPasswd = "請輸入中華電信所提供之使用者名稱與密碼以建立網路連線";
var vWlanpw = "<br>\(8~63個ASCII字元. 預設值為 \"00000000\"\)"
var vWlanweppw = "\(預設值為 \"1234567890\"\)"
var vradiuskey = "\(預設值為 \"123456\"\)"
}
else
{
var vHidden = "Hidden";
var vNotHidden = "Not hidden";
var vDhcpSetting = "DHCP Setting";
var vSetup = "Setup";
var vOpen = "Open Syatem";
var vShared = "WEP";
var vNameSSID = "Name\(SSID\)";
var vAppSave = "Save";
var vLocalNet = "Local Network";
var vWanMode = "WAN Side Mode";
var vWanUserPasswd = "Please enter Username and Password which provided by ISP";
var vWlanpw = "<br>\(8~63 ASCII characters, default: \"00000000\"\)"
var vWlanweppw = "\(default: \"1234567890\"\)"
var vradiuskey = "\(default: \"123456\"\)"
}

var rc4Key = "27885vt8118";
var ency_set = 1;
var show_802_1x = 0;
var show_wep = 0;

var authtype_flag=0;
var security_flag=0;

var wan_max = 8;
var lan_max = 8;
function faceinter()
{
	var ifname;
	for (var k=0;k<wan_max;k++)
	{
		if(fvt_meta_config("wan"+k+"_if_name") != '')
		{
			ifname = fvt_meta_config("wan"+k+"_if_name");
			ifinter = fvt_meta_config("dev_wan"+k+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"("+ifname+")</option>");
		}
	}
	for (var l=0;l<lan_max;l++)
	{
		if(fvt_meta_config("dev_lan"+l+"_interface") != '')
		{
			//ifname = fvt_meta_config("wan"+l+"_if_name");
			ifinter = fvt_meta_config("dev_lan"+l+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"</option>");
		}
	}
}

function valueMatch(s1, s2, match_return)
{
	if(s1 == s2)
		return match_return;
	else
		return "";
}

function ChannelList()
{
	var i = 0;
	var selectChannel = fvt_meta_config('wlan_channel');
	document.write("<option "+valueMatch(selectChannel, 0,'selected')+" value='0'>Auto</option>");
	for(i=1 ; i<=11 ; i++)
		{
			document.write("<option "+valueMatch(selectChannel, i,'selected')+" value="+i+">"+i+"</option>");
		}
}

function check_WAN()
{
	if(document.getElementById("id_WANUsername").value == "")
	{
			warn_not_empty("WAN User Name");
			return false;
	}
	if(document.getElementById("id_WANPassword").value == "")
	{
			warn_not_empty("WAN Password");
			return false;
	}
	return true;
}

function changedhcpIP(index)
{
	document.getElementById("id_DHCPSIPStart"+index).value = document.getElementById("id_LanIPAddr"+index).value;
	document.getElementById("id_DHCPSIPEnd"+index).value = document.getElementById("id_LanIPAddr"+index).value;
}

function check_LAN()
{
	merge_ip("id_LanIPAddr","id_LanIPAddr1","id_LanIPAddr2","id_LanIPAddr3","id_LanIPAddr4");
	merge_ip("id_LanNetmask","id_LanNetmask1","id_LanNetmask2","id_LanNetmask3","id_LanNetmask4");
	merge_ip("id_DHCPSIPStart","id_DHCPSIPStart1","id_DHCPSIPStart2","id_DHCPSIPStart3","id_DHCPSIPStart4");
	merge_ip("id_DHCPSIPEnd","id_DHCPSIPEnd1","id_DHCPSIPEnd2","id_DHCPSIPEnd3","id_DHCPSIPEnd4");
	if (document.connect_setup.LanIPAddr.value=="")
	{
		msg="IP Address";
		no="";
		warn_invalid(msg);
		//alert(msg +" " +no + " is invalid");
		return false;
	}

	if (document.connect_setup.LanIPAddr.value.match(/192.168.[2][.]/g) )
	{
		alert("192.168.2.X section is reserved for system!");
		document.getElementById("id_LanIPAddr3").value="";
		document.getElementById("id_DHCPSIPStart3").value="";
		document.getElementById("id_DHCPSIPEnd3").value="";
		return false;
	}

	//if( document.getElementById('id_LanIPAddr4').value >=251 && document.getElementById('id_LanIPAddr4').value <=254)
	//{
	//	alert("Lan IP range 251~254 is reserved for system");
	//	return false;
	//}

	if ((document.connect_setup.LanNetmask.value == "")||(!check_netmask(document.connect_setup.LanNetmask.value)))
	{
		warn_invalid("Subnet Mask");
		//alert("Subnet Mask is invalid!");
		return false ;
	}
	if (!check_ip(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value))
		{
				msg="IP Address";
				no="";
				warn_invalid(msg);
				//alert(msg +" " +no + " is invalid");
				return false;
		}
	if ( document.connect_setup.DHCPSEnable.selectedIndex == 1)
	{
		if (! check_ip(document.getElementById("id_DHCPSIPStart").value,document.connect_setup.LanNetmask.value))
		{
			warn_invalid("DHCP Starting IP Address1");
			//alert("DHCP Starting IP Address is invalid!");
			return false;
		}

		//if( (document.getElementById('id_DHCPSIPStart4').value >=251 && document.getElementById('id_DHCPSIPStart4').value <=254) ||
		//	(document.getElementById('id_DHCPSIPEnd4').value >=251 && document.getElementById('id_DHCPSIPEnd4').value <=254) )
		//{
		//	alert("DHCP pool range 251~254 is reserved for system");
		//	return false;
		//}

		if ( !checkSubnet(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value,document.getElementById("id_DHCPSIPStart").value))
		{
			warn_invalid("DHCP Starting IP Address2");
		//	alert("DHCP Starting IP Address is invalid!");
			document.getElementById("id_DHCPSIPStart").value = document.getElementById("id_DHCPSIPStart").defaultValue;
			return false;
		}

			if ( !check_ip(document.connect_setup.DHCPSIPEnd.value,document.connect_setup.LanNetmask.value))
			{
				warn_invalid("DHCP Ending IP Address");
				//alert("DHCP Ending IP Address is invalid!");
				return false;
			}

			if ( !checkSubnet(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value,document.connect_setup.DHCPSIPEnd.value))
			{
				warn_invalid("DHCP Ending IP Address");
				//alert("DHCP Ending IP Address is invalid!");
				document.connect_setup.DHCPSIPEnd.value = document.connect_setup.DHCPSIPEnd.defaultValue;
				return false;
			}
			if ( !checkClientRange(document.connect_setup.LanIPAddr.value,document.getElementById("id_DHCPSIPStart").value,document.connect_setup.DHCPSIPEnd.value) )
			{
				warn_ipdhcp();
				//alert("Invalid DHCP range value! Please check IP address and DHCP Address!");
				return false;

			}
	}
	return true;
}
function checkClientRange(gw,start,end)
{
	var gw_d,start_d,end_d;

	gw_d = getDigit(gw,4);
	gw_d +=	getDigit(gw,3)*256;
	gw_d +=	getDigit(gw,2)*256;
	gw_d +=	getDigit(gw,1)*256;

	start_d	= getDigit(start,4);
	start_d	+= getDigit(start,3)*256;
	start_d	+= getDigit(start,2)*256;
	start_d	+= getDigit(start,1)*256;

	end_d =	getDigit(end,4);
	end_d += getDigit(end,3)*256;
	end_d += getDigit(end,2)*256;
	end_d += getDigit(end,1)*256;
	if( start_d <= end_d ){
		if((start_d <= gw_d) &&	(gw_d <= end_d))
			return false;
		else
			return true;
	}

	return false;
}

function dhcpChange()
{
	var i;
	if ( document.connect_setup.DHCPSEnable.value == 0 )
	{
		document.getElementById("id_DHCPSIPStart1").disabled=true;
		document.getElementById("id_DHCPSIPStart2").disabled=true;
		document.getElementById("id_DHCPSIPStart3").disabled=true;
		document.getElementById("id_DHCPSIPStart4").disabled=true;
		document.getElementById("id_DHCPSIPEnd1").disabled=true;
		document.getElementById("id_DHCPSIPEnd2").disabled=true;
		document.getElementById("id_DHCPSIPEnd3").disabled=true;
		document.getElementById("id_DHCPSIPEnd4").disabled=true;
	}else
	{
		document.getElementById("id_DHCPSIPStart1").disabled=false;
		document.getElementById("id_DHCPSIPStart2").disabled=false;
		document.getElementById("id_DHCPSIPStart3").disabled=false;
		document.getElementById("id_DHCPSIPStart4").disabled=false;
		document.getElementById("id_DHCPSIPEnd1").disabled=false;
		document.getElementById("id_DHCPSIPEnd2").disabled=false;
		document.getElementById("id_DHCPSIPEnd3").disabled=false;
		document.getElementById("id_DHCPSIPEnd4").disabled=false;
	}
}

function Authen(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);
	var nvram;
	nvram=item1;
	document.getElementById("id_sercurityNon" + val).disabled= true;
	document.getElementById("id_sercurityWep" + val).disabled= true;
	document.getElementById("id_sercurityTkip" + val).disabled= true;
	document.getElementById("id_sercurityAes" + val).disabled= true;
	document.getElementById("id_sercurityTkipAes" + val).disabled= true;

	if (val==1)
	{
		document.getElementById("id_WIFIRadiusWanif").disabled=true;
		document.getElementById("id_WIFIRadiusServer_item1").disabled=true;
		document.getElementById("id_WIFIRadiusServer_item2").disabled=true;
		document.getElementById("id_WIFIRadiusServer_item3").disabled=true;
		document.getElementById("id_WIFIRadiusServer_item4").disabled=true;
		document.getElementById("id_WIFIRadiusServer").disabled=true;
		document.getElementById("id_WIFIRadiusPort").disabled=true;
		document.getElementById("id_WIFIRadiusKey").disabled=true;
	}

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).disabled= false;
		document.getElementById("id_sercurityWep" + val).disabled= false;
		set_auth_flag(0,val);
	}

	if (item1=="SHARED")
	{
		document.getElementById("id_sercurityWep" + val).disabled= false;
		set_auth_flag(1,val);
	}
	if (item1=="WPAPSK")
	{
		document.getElementById("id_sercurityTkip" + val).disabled= false;
		document.getElementById("id_sercurityAes" + val).disabled= false;
		document.getElementById("id_sercurityTkipAes" + val).disabled= false;
		set_auth_flag(2,val);
	}
	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityTkip" + val).disabled= false;
		document.getElementById("id_sercurityAes" + val).disabled= false;
		document.getElementById("id_sercurityTkipAes" + val).disabled= false;
		set_auth_flag(3,val);
	}
	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkip" + val).disabled= false;
		document.getElementById("id_sercurityAes" + val).disabled= false;
		document.getElementById("id_sercurityTkipAes" + val).disabled= false;
		set_auth_flag(4,val);
	}
		if (item1=="WPA")
		{
			document.getElementById("id_sercurityTkip" + val).disabled= false;
			document.getElementById("id_sercurityAes" + val).disabled= false;
			document.getElementById("id_sercurityTkipAes" + val).disabled= false;
			set_auth_flag(5,val);
		}
		if (item1=="WPA2")
		{
			document.getElementById("id_sercurityTkip" + val).disabled= false;
			document.getElementById("id_sercurityAes" + val).disabled= false;
			document.getElementById("id_sercurityTkipAes" + val).disabled= false;
			set_auth_flag(6,val);
		}
	if (nvram=="SHARED" || nvram=="WPA" || nvram=="WPA2")

	if (item2[0].checked)
		encryptNone(val);

	if (item2[1].checked)
		encryptWep(val);

	if (item2[2].checked)
		encryptTkip(val);

	if (item2[3].checked)
		encryptAes(val);

	if (item2[4].checked)
		encryptTkipAes(val);
}

function change_auth(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).checked= true;
		set_auth_flag(0,val);
		encryptNone(val);
	}

	if (item1=="SHARED")
	{
		document.getElementById("id_sercurityWep" + val).checked= true;
		set_auth_flag(1,val);
	}
	if (item1=="WPAPSK")
	{
		document.getElementById("id_sercurityTkip" + val).checked= true;
		set_auth_flag(2,val);
	}
	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityAes" + val).checked= true;
		set_auth_flag(3,val);
	}
	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAes" + val).checked= true;
		set_auth_flag(4,val);
	}
		if (item1=="WPA")
		{
			document.getElementById("id_sercurityAes" + val).checked= true;
			set_auth_flag(5,val);
		}
		if (item1=="WPA2")
		{
			document.getElementById("id_sercurityAes" + val).checked= true;
			set_auth_flag(6,val);
		}

	if (item2[0].checked)
		encryptNone(val);

	if (item2[1].checked)
		encryptWep(val);

	if (item2[2].checked)
		encryptTkip(val);

	if (item2[3].checked)
		encryptAes(val);

	if (item2[4].checked)
		encryptTkipAes(val);
}

function set_auth_flag(index,tag)
{
	switch (tag) {
		case 1:
			authtype_flag=index;
			break;
		case 2:
			authtype_flag2=index;
			break;
		case 3:
			authtype_flag3=index;
			break;
		case 4:
			authtype_flag4=index;
			break;
		case 5:
			authtype_flag5=index;
			break;
		case 6:
			authtype_flag6=index;
			break;
		case 7:
			authtype_flag7=index;
			break;
		case 8:
			authtype_flag8=index;
			break;
	}
}
function set_security_flag(index,tag)
{
	switch (tag) {
		case 1:
			security_flag=index;
			break;
		case 2:
			security_flag2=index;
			break;
		case 3:
			security_flag3=index;
			break;
		case 4:
			security_flag4=index;
			break;
		case 5:
			security_flag5=index;
			break;
		case 6:
			security_flag6=index;
			break;
		case 7:
			security_flag7=index;
			break;
		case 8:
			security_flag8=index;
			break;
	}
}

function encryptNone(val)
{
	set_security_flag(0,val);
	document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	document.getElementById("id_WIFIWEPKeyIndex" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey1_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey2_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey3_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey4_S" + val).disabled=true;
	document.getElementById("id_weplLength" + val).disabled=true;
	document.getElementById("id_Passphrase" + val).disabled=true;
	document.getElementById("id_genBtn" + val).disabled=true;
}

function encryptWep(val)
{
	set_security_flag(1,val);
	document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	document.getElementById("id_WIFIWEPKeyIndex" + val).disabled=false;
	document.getElementById("id_WIFIWEPKey1_S" + val).disabled=false;
	document.getElementById("id_WIFIWEPKey2_S" + val).disabled=false;
	document.getElementById("id_WIFIWEPKey3_S" + val).disabled=false;
	document.getElementById("id_WIFIWEPKey4_S" + val).disabled=false;
	document.getElementById("id_weplLength" + val).disabled=false;
	document.getElementById("id_Passphrase" + val).disabled=false;
	document.getElementById("id_genBtn" + val).disabled=false;
}

function encryptTkip(val)
{
	set_security_flag(2,val);
	document.getElementById("id_WIFIWPAPSK" + val).disabled=false;
	document.getElementById("id_WIFIWEPKeyIndex" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey1_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey2_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey3_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey4_S" + val).disabled=true;
	document.getElementById("id_weplLength" + val).disabled=true;
	document.getElementById("id_Passphrase" + val).disabled=true;
	document.getElementById("id_genBtn" + val).disabled=true;
	if (val==1 && authtype_flag>4)
	{
		document.getElementById("id_WIFIRadiusWanif").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item1").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item2").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item3").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item4").disabled=false;
		document.getElementById("id_WIFIRadiusServer").disabled=false;
		document.getElementById("id_WIFIRadiusPort").disabled=false;
		document.getElementById("id_WIFIRadiusKey").disabled=false;
		document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}

function encryptAes(val)
{
	set_security_flag(3,val);
	document.getElementById("id_WIFIWPAPSK" + val).disabled=false;
	document.getElementById("id_WIFIWEPKeyIndex" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey1_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey2_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey3_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey4_S" + val).disabled=true;
	document.getElementById("id_weplLength" + val).disabled=true;
	document.getElementById("id_Passphrase" + val).disabled=true;
	document.getElementById("id_genBtn" + val).disabled=true;
	if (val==1 && authtype_flag>4)
	{
		document.getElementById("id_WIFIRadiusWanif").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item1").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item2").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item3").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item4").disabled=false;
		document.getElementById("id_WIFIRadiusServer").disabled=false;
		document.getElementById("id_WIFIRadiusPort").disabled=false;
		document.getElementById("id_WIFIRadiusKey").disabled=false;
		document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}

function encryptTkipAes(val)
{
	set_security_flag(4,val);
	document.getElementById("id_WIFIWPAPSK" + val).disabled=false;
	document.getElementById("id_WIFIWEPKeyIndex" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey1_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey2_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey3_S" + val).disabled=true;
	document.getElementById("id_WIFIWEPKey4_S" + val).disabled=true;
	document.getElementById("id_weplLength" + val).disabled=true;
	document.getElementById("id_Passphrase" + val).disabled=true;
	document.getElementById("id_genBtn" + val).disabled=true;
	if (val==1 && authtype_flag>4)
	{
		document.getElementById("id_WIFIRadiusWanif").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item1").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item2").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item3").disabled=false;
		document.getElementById("id_WIFIRadiusServer_item4").disabled=false;
		document.getElementById("id_WIFIRadiusServer").disabled=false;
		document.getElementById("id_WIFIRadiusPort").disabled=false;
		document.getElementById("id_WIFIRadiusKey").disabled=false;
		document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}
function genPassphraseKey(tag)
{
	var text_item=document.getElementById("id_Passphrase" + tag);
	var wep_index_item=document.getElementById("id_WIFIWEPKeyIndex" + tag);
	var index=wep_index_item.selectedIndex+1;
	var wep_text_item=document.getElementById("id_WIFIWEPKey" + index + "_S" + tag);

	if (text_item.value.length==0 || isBlank(text_item.value))
	{
		document.getElementById("id_WIFIWEPKey1_S" + tag).value='';
		document.getElementById("id_WIFIWEPKey2_S" + tag).value='';
		document.getElementById("id_WIFIWEPKey3_S" + tag).value='';
		document.getElementById("id_WIFIWEPKey4_S" + tag).value='';
		return false;
	}

	if (document.getElementById("id_weplLength" + tag).value==64)
	{
		document.getElementById("id_WIFIWEPKey1_S" + tag).value=Get64bitkey(text_item.value,1);
		document.getElementById("id_WIFIWEPKey2_S" + tag).value=Get64bitkey(text_item.value,2);
		document.getElementById("id_WIFIWEPKey3_S" + tag).value=Get64bitkey(text_item.value,3);
		document.getElementById("id_WIFIWEPKey4_S" + tag).value=Get64bitkey(text_item.value,4);
	}
	else
	{
		document.getElementById("id_WIFIWEPKey1_S" + tag).value=Get128bitkey(text_item.value+1);
		document.getElementById("id_WIFIWEPKey2_S" + tag).value=Get128bitkey(text_item.value+2);
		document.getElementById("id_WIFIWEPKey3_S" + tag).value=Get128bitkey(text_item.value+3);
		document.getElementById("id_WIFIWEPKey4_S" + tag).value=Get128bitkey(text_item.value+4);
		//wep_text_item.value=Get128bitkey(text_item.value);
	}
}
function checkRadius()
{
	var item1=document.getElementById("id_WIFIRadiusServer");
	var item2=document.getElementById("id_WIFIRadiusPort");
	var item3=document.getElementById("id_WIFIRadiusKey");

	//merge radius server ip to hidden item
	merge_ip("id_WIFIRadiusServer", "id_WIFIRadiusServer_item1", "id_WIFIRadiusServer_item2", "id_WIFIRadiusServer_item3", "id_WIFIRadiusServer_item4");

	if (item1.value.length==0 && item2.value.length==0 && item3.value.length==0)
	{
		warn_invalid("8021x Setting");
		//alert("8021x Setting is invalid!!");
		return false;
	}
	if (item3.value.length==0)
	{
		var item ="Radius Key";
		warn_invalid(item);
		//alert(item + " is invalid!!");
		return false;
	}
	if ((item2.value.length==0)||(!check_port(item2.value)))
	{
		var item ="Radius Port"
		warn_int_between(item,1,65535);
		//alert("The Radius port should be an integer between 1 and 65535");
		return false;
	}
	if ((item1.value.length==0)||(!check_ip(item1.value)))
	{
		var item ="Radius Server"
		warn_invalid(item);
		//alert(item + " is invalid!!");
		return false;
	}
	return true;
}
function checkSpecSymbol(s,index)
{
	for(i=0;i<s.length;i++)
	{
		c=s.charAt(i);
		if (index==1)
		{
			if((c==';')||(c=='\\'))
			return false;
		}
		else
		{
			if(c==';')
			return false;
		}
	}
	return true;
}

function check_ssidname()
{
	var temp_ssid= document.getElementById("id_ssid1").value;

	if (temp_ssid.length==0)
	{
		warn_not_empty("SSID1 SSID");
		//alert("SSID1 SSID can not be empty!!");
		return false;
	}
	else if (!checkSpecSymbol(temp_ssid,0))
	{
		warn_ssid_illegal("SSID1");
		//alert("SSID1 contains illegal characters, like" + " \";\"");
		return false;
	}
	else if (isChinese(temp_ssid))
	{
		warn_ssid_illegal2("SSID1 SSID");
		//alert("SSID1 SSID contains illegal characters.");
		return false;
	}

	return true;
}

function wifi_set1()
{
	var temp=new Array(4);
	var temp_preshared;
	temp[0] = document.getElementById("id_WIFIWEPKey1_S1").value;
	temp[1] = document.getElementById("id_WIFIWEPKey2_S1").value;
	temp[2] = document.getElementById("id_WIFIWEPKey3_S1").value;
	temp[3] = document.getElementById("id_WIFIWEPKey4_S1").value;
	temp_preshared = document.getElementById("id_WIFIWPAPSK1").value;

	if ((authtype_flag==0)&&((security_flag==2)||(security_flag==3)||(security_flag==4)))
	{
		warn_wifi_not_match2("Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}
	if ((authtype_flag==1)&&((security_flag==2)||(security_flag==3)||(security_flag==0)||(security_flag==4)))
	{
		warn_wifi_not_match2("Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}
	if (((authtype_flag==2)||(authtype_flag==3)||(authtype_flag==4))&&
			((security_flag==0)||(security_flag==1)))
	{
		warn_wifi_not_match2("Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}
	if (((authtype_flag==5)||(authtype_flag==6))&&
		((security_flag==0)||(security_flag==1)))
	{
		warn_wifi_not_match2("Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}
	if(document.getElementById("id_Passphrase1").disabled==false && document.connect_setup.WIFIWEPPassphraseKey1.value.length==0)
	{
		warn_not_empty2("Passphrase Key","SSID1");
		return false;
	}
	if(security_flag==1)
	{
		var i;
		for (i=0;i<4;i++)
		{
			if (temp[i].length== 0)
			{
				if (document.wifisetup_form.WIFIWEPKeyIndex1.value==(i+1))
				{
					warn_invalid2("Key"+(i+1),"SSID1");
					//alert("WEP Key" + (i+1) + " is invalid!!");
					return false;
				}
				else
					continue;
			}
			else if(((temp[i].length== 5)||(temp[i].length== 10))&&(checkSpecSymbol(temp[i],0)))/*ASCII*/
			{
				if(document.getElementById("id_weplLength1").value=="64")
					continue;
				else
				{
					warn_invalid2("Key"+(i+1),"SSID1");
					return false;
				}

			}
			else if ((temp[i].length== 13)||(temp[i].length== 26))/*HEX*/
			{
				if(document.getElementById("id_weplLength1").value=="128")
				{
					for (j=0;(j<temp[i].length);j++)
					{
						c=temp[i].charAt(j);

						if((c != '0') && (c != '1')&& (c != '2')&& (c != '3')&& (c != '4')&& (c != '5')&& (c != '6')
							&& (c != '7')&& (c != '8')&& (c!= '9')&& (c != 'a')&& (c != 'b')&& (c != 'c')
							&& (c != 'd')&& (c != 'e')&& (c != 'f')&& (c != 'A')&& (c != 'B')
							&& (c != 'C')&& (c != 'D')&& (c != 'E')&& (c != 'F'))
						{
							warn_invalid2("Key"+(i+1),"SSID1");
							//alert("WEP Key" + (i+1) + " is invalid!!");
							return false;
						}
					}
				}
				else
				{
					warn_invalid2("Key"+(i+1),"SSID1");
					return false;
				}
			}
			else
			{
				warn_invalid2("Key"+(i+1),"SSID1");
				//alert("WEP Key" + (i+1) + " is invalid!!");
				return false;
			}
		}
	}

	if(((security_flag==2)||(security_flag==3)||(security_flag==4))&& !((authtype_flag==5)||(authtype_flag==6)))
	{
		if (temp_preshared.length==0)
		{
			warn_not_empty2("Preshared Key",'SSID1');
			//alert("Preshared Key is empty!!");
			return false;
		}
		else if ((8>temp_preshared.length)||(temp_preshared.length>63)||!((temp_preshared.length!=0)&&
			(checkSpecSymbol(temp_preshared,0)&&isChinese(temp_preshared)==0)))
		{
			var item="Preshared Key";
			warn_invalid2("Preshared Key","SSID1");
			//alert(item + " is invalid!!");
			return false;
		}
	}

	if ((authtype_flag==5)||(authtype_flag==6))
	{
		if (!checkRadius())
			return false;
	}
	return true;
}


function save_change()
{
	if(!check_WAN())
	{
		return false;
	}
	if(!check_LAN())
	{
		return false;
	}
	if(!check_ssidname())
		return false;
	if(!wifi_set1())
		return false;

	if (!check_integer_range(document.connect_setup.WIFITxPower.value,1,100))
	{
		item = "Tx Power";
		min = "1";
		max = "100";
		warn_int_between(item,min,max);
		return false;
	}

	if ((authtype_flag==5)||(authtype_flag==6))
	{
		if (!checkRadius())
			return false;
	}

	fvt_form_submit('connect_setup');
	document.getElementById('id_wait_progress').style.display="";
	document.connect_setup.submit();
}

function fvt_form_init(form_name)
{
	if(fvt_meta_config("wlan_enable")==0)
		document.getElementById("id_wifi_11n_setup").style.display="none";
	else
		document.getElementById("id_wifi_11n_setup").style.display="inline";

	if (form_name=='connect_setup' || form_name=='*') {
		fvt_form_obj_set(form_name, "WANUsername", fvt_meta_config('wan0_pppoe_username'));
		fvt_form_obj_set(form_name, "WANPassword", fvt_meta_config('wan0_pppoe_password'));
		fvt_form_obj_set(form_name, "DHCPSEnable", fvt_meta_config('dhcp0_enable'));

		fvt_form_obj_set(form_name, "WIFISsid1", fvt_meta_config('wlan_ssid'));
		fvt_form_obj_set(form_name, "WIFIHideSSID1", fvt_meta_config('wlan_hiddenAP'));
		fvt_form_obj_set(form_name, "WIFIHTBW", fvt_meta_config('wlan_use40M'));
		fvt_form_obj_set(form_name, "WIFITxPower", fvt_meta_config('wlan_tx_power'));
		fvt_form_obj_set(form_name, "WIFIChannel", fvt_meta_config('wlan_channel'));
		fvt_form_obj_set(form_name, "WIFIAuthType1", fvt_meta_config("wlan_auth_type"));
		fvt_form_obj_set(form_name, "WIFIEncrypType1", fvt_meta_config("wlan_security_type"));
		fvt_form_obj_set(form_name, "WIFIWEPPassphraseLen1", fvt_meta_config("wlan_wep_passphrase_len"));
		fvt_form_obj_set(form_name, "WIFIWEPPassphraseKey1", fvt_meta_config("wlan_wep_passphrase"));
		fvt_form_obj_set(form_name, "WIFIWEPKeyIndex1", fvt_meta_config("wlan_wepindex"));
		fvt_form_obj_set(form_name, "WIFIWEPKey1_S1", fvt_meta_config("wlan_wepkey1"));
		fvt_form_obj_set(form_name, "WIFIWEPKey2_S1", fvt_meta_config("wlan_wepkey2"));
		fvt_form_obj_set(form_name, "WIFIWEPKey3_S1", fvt_meta_config("wlan_wepkey3"));
		fvt_form_obj_set(form_name, "WIFIWEPKey4_S1", fvt_meta_config("wlan_wepkey4"));
		fvt_form_obj_set(form_name, "WIFIWPAPSK1", fvt_meta_config("wlan_wpawpa2_presharedkey"));
		fvt_form_obj_set(form_name, "WIFIRadiusWanif", fvt_meta_config('wlan_802_1x_server_dev'));
		fvt_form_obj_set(form_name, "WIFIRadiusServer", fvt_meta_config('wlan_802_1x_server'));
		fvt_form_obj_set(form_name, "WIFIRadiusPort", fvt_meta_config('wlan_802_1x_port'));
		fvt_form_obj_set(form_name, "WIFIRadiusKey", fvt_meta_config('wlan_802_1x_key'));
	}
	Authen(1);
	if (show_802_1x == 1)
		{document.getElementById("id_802_1x_table").style.display ="inline";}
	else
		{document.getElementById("id_802_1x_table").style.display ="none";}

	if (show_wep == 1)
		{
		document.getElementById("id_wep_table").style.display ="inline";
		}
	else
		{
		document.getElementById("id_wep_table").style.display ="none";
		document.getElementById("id_weptd1").style.display ="none";
		document.getElementById("id_weptd2").style.display ="none";
		}
}

function fvt_form_submit(form_name)		{
	fvt_paramlist_clear();
	if (form_name=='connect_setup' || form_name=='*') {
		fvt_paramlist_cat_str('wan0_pppoe_username', fvt_form_obj_get(form_name, "WANUsername"));

		//fvt_paramlist_cat_str('wan0_pppoe_password', fvt_form_obj_get(form_name, "WANPassword"));
		var password;
		if(fvt_form_obj_get(form_name, "WANPassword") != fvt_meta_config('wan0_pppoe_password'))
		{
			password = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WANPassword"));
		}
		else
		{
			password =fvt_meta_config('wan0_pppoe_password');
		}
		fvt_paramlist_cat_str('wan0_pppoe_password', password);

		fvt_paramlist_cat_str('dhcp0_enable', fvt_form_obj_get(form_name, "DHCPSEnable"));
		fvt_paramlist_cat_str('dhcp0_number_start', fvt_form_obj_get(form_name, "DHCPSIPStart"));
		fvt_paramlist_cat_str('dhcp0_number_end', fvt_form_obj_get(form_name, "DHCPSIPEnd"));
		fvt_paramlist_cat_str('lan0_ip', fvt_form_obj_get(form_name, "LanIPAddr"));
		fvt_paramlist_cat_str('lan0_netmask', fvt_form_obj_get(form_name, "LanNetmask"));

		fvt_paramlist_cat_str('wlan_ssid', fvt_form_obj_get(form_name, "WIFISsid1"));
		fvt_paramlist_cat_str('wlan_hiddenAP', fvt_form_obj_get(form_name, "WIFIHideSSID1"));
		fvt_paramlist_cat_str('wlan_use40M', fvt_form_obj_get(form_name, "WIFIHTBW"));
		fvt_paramlist_cat_str('wlan_tx_power', fvt_form_obj_get(form_name, "WIFITxPower"));
		fvt_paramlist_cat_str('wlan_channel', fvt_form_obj_get(form_name, "WIFIChannel"));
		fvt_paramlist_cat_str("wlan_auth_type", fvt_form_obj_get(form_name, "WIFIAuthType1"));
		fvt_paramlist_cat_str("wlan_security_type", fvt_form_obj_get(form_name, "WIFIEncrypType1"));
		fvt_paramlist_cat_str("wlan_wep_passphrase_len", fvt_form_obj_get(form_name, "WIFIWEPPassphraseLen1"));
		//fvt_paramlist_cat_str("wlan_wep_passphrase", fvt_form_obj_get(form_name, "WIFIWEPPassphraseKey1"));
		var wlan_weppw;
		if(fvt_form_obj_get(form_name, "WIFIWEPPassphraseKey1") != fvt_meta_config("wlan_wep_passphrase"))
		{
			if (ency_set=="1")
			wlan_weppw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWEPPassphraseKey1"));
			else
			wlan_weppw = fvt_form_obj_get(form_name, "WIFIWEPPassphraseKey1");
		}
		else
		{
			wlan_weppw = fvt_meta_config("wlan_wep_passphrase");
		}
		fvt_paramlist_cat_str("wlan_wep_passphrase", wlan_weppw);

		fvt_paramlist_cat_str("wlan_wepindex", fvt_form_obj_get(form_name, "WIFIWEPKeyIndex1"));
		fvt_paramlist_cat_str("wlan_wepkey1", fvt_form_obj_get(form_name, "WIFIWEPKey1_S1"));
		fvt_paramlist_cat_str("wlan_wepkey2", fvt_form_obj_get(form_name, "WIFIWEPKey2_S1"));
		fvt_paramlist_cat_str("wlan_wepkey3", fvt_form_obj_get(form_name, "WIFIWEPKey3_S1"));
		fvt_paramlist_cat_str("wlan_wepkey4", fvt_form_obj_get(form_name, "WIFIWEPKey4_S1"));
		//fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
		var wlan_pw;
		if (document.connect_setup.WIFIAuthType1.value == "OPEN")
			fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", "");
		else
		{
			//fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
			if(fvt_form_obj_get(form_name, "WIFIWPAPSK1") != fvt_meta_config('wlan_wpawpa2_presharedkey'))
			{
				if (ency_set=="1")
				wlan_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
				else
				wlan_pw = fvt_form_obj_get(form_name, "WIFIWPAPSK1");
			}
			else
			{
				wlan_pw = fvt_meta_config('wlan_wpawpa2_presharedkey');
			}
			fvt_paramlist_cat_str('wlan_wpawpa2_presharedkey', wlan_pw);
		}

		fvt_paramlist_cat_str('wlan_802_1x_server_dev', fvt_form_obj_get(form_name, "WIFIRadiusWanif"));
		fvt_paramlist_cat_str('wlan_802_1x_server', fvt_form_obj_get(form_name, "WIFIRadiusServer"));
		fvt_paramlist_cat_str('wlan_802_1x_port', fvt_form_obj_get(form_name, "WIFIRadiusPort"));
		fvt_paramlist_cat_str('wlan_802_1x_key', fvt_form_obj_get(form_name, "WIFIRadiusKey"));
	}
	fvt_paramlist_presubmit(form_name);
}

</script>
</head>

<body align="left" onload="fvt_form_init('connect_setup');dhcpChange()">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="connect_setup" name="connect_setup" method="post">
	<fieldset>
		<div class="lv1_title">
		Connection Setup&nbsp;&gt;&nbsp;Connect Setup</div>
	</fieldset>
<div class="div1_indent lv3_new">
	<div class="lv1_new topbottom_usage1 rowh" ctrlflip="right" ctrlid="2">WAN Setup</div>
	<div>
	<table><tbody>
	<div><hr class="hr5"></div>
		<tr>
			<td class="width_connectSetup1"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write(vWanMode);
				</script>
			</div></td>
		</tr>
		<tr>
			<td style="padding-left:20px;" colspan="2"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write(vWanUserPasswd);
				</script>
			</div></td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="361">User Name</div></td>
			<td>
				<input ctrlflip='etc' type="text" name="WANUsername" id="id_WANUsername" size="30" maxlength="30" value=''>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="262">Password</div></td>
			<td>
				<input ctrlflip='etc' type="password" name="WANPassword" class="width_routePpoe_password" id="id_WANPassword" maxlength="30" value='' ">
			</td>
		</tr>
	</tbody></table>
	</div>

	<div><hr class="hr2"></div>
	<div class="lv1_new topbottom_usage1 rowh" ctrlflip="right" ctrlid="2">LAN Setup</div>
	<div>
	<table><tbody>
		<tr>
			<td class="width_connectSetup1"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write(vDhcpSetting);
				</script>
			</div></td>
		</tr>
	<div><hr class="hr5"></div>
		<tr>
			<input ctrlflip='etc' name="nosave_DHCPSEnable" id="mm_DHCPSEnable" type="hidden">
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="75">DHCP Server</div></td>
			<td ctrlflip='etc'>
				<select ar='1' name="DHCPSEnable" id="id_DHCPSEnable" style="width:128px" onchange="dhcpChange();">
					<option value='0'>Disable</option>
					<option value='1'>Enable</option>
				</select>
			</td>
		</tr>
			<td class="width_connectSetup2"><div ctrlflip='right' ctrlid="79">DHCP&nbsp;Starting&nbsp;IP&nbsp;Address</div></td>
			<input ctrlflip='etc' name="DHCPSIPStart" id="id_DHCPSIPStart" type="hidden">

			<script language="javascript" type="text/javascript">
				var IP_Address = fvt_meta_config('dhcp0_number_start');
				var IP_Address_split = IP_Address.split(".");
				document.write("<td ctrlflip='right'><div dir='ltr'>");
				document.write("<input id='id_DHCPSIPStart1' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[0]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart2' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[1]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart3' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[2]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart4' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[3]+"' type='text' name='DHCPSIPStart4'>");
				document.write("</div></td>");
			</script>
		</tr>
		<td class="width_connectSetup2"><div ctrlflip='right' ctrlid="80">DHCP&nbsp;Ending&nbsp;IP&nbsp;Address</div></td>
		<input ctrlflip="etc" name="DHCPSIPEnd" id="id_DHCPSIPEnd" type="hidden">

		<script language="javascript" type="text/javascript">
			var IP_Address = fvt_meta_config('dhcp0_number_end');
			var IP_Address_split = IP_Address.split(".");
			document.write("<td ctrlflip='right'><div dir='ltr'>");
			document.write("<input id='id_DHCPSIPEnd1' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[0]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd2' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[1]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd3' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[2]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd4' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[3]+"' type='text' name='DHCPSIPEnd4'>");
			document.write("</div></td>");
		</script>
		</tr>
		<tr></tr>
		<tr>
			<td class="width_connectSetup1"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
				document.write(vLocalNet);
				</script> 
			TCP/IP</div></td>
		</tr>
		<tr>
			<input name="lan_gateway" value="0.0.0.0" type="hidden">
			<input name="LanIPAddr" id="id_LanIPAddr" type="hidden">
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="32">IP Address</div></td>
			<script language="javascript" type="text/javascript">
				var IP_Address = fvt_meta_config('lan0_ip');
				var IP_Address_split = IP_Address.split(".");
				document.write("<td ctrlflip='etc'><div dir='ltr'>");
				document.write("<input id='id_LanIPAddr1' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[0]+"' onkeyup='changedhcpIP(1)' type='text'> . ");
				document.write("<input id='id_LanIPAddr2' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[1]+"' onkeyup='changedhcpIP(2)' type='text'> . ");
				document.write("<input id='id_LanIPAddr3' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[2]+"' onkeyup='changedhcpIP(3)' type='text'> . ");
				document.write("<input id='id_LanIPAddr4' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[3]+"' type='text'>");
				document.write("</div></td>");
			</script>
		</tr>
		<tr>
			<input name="LanNetmask" id="id_LanNetmask" type="hidden">
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="69">Subnet Mask</div></td>
			<script language="javascript" type="text/javascript">
				var Sub_Mask = fvt_meta_config('lan0_netmask');
				var Sub_Mask_split = Sub_Mask.split(".");
				document.write("<td ctrlflip='etc'><div dir='ltr'>");
				document.write("<input id='id_LanNetmask1' class='width_ip' size='3' maxlength='3' value='"+Sub_Mask_split[0]+"' type='text'> . ");
				document.write("<input id='id_LanNetmask2' class='width_ip' size='3' maxlength='3' value='"+Sub_Mask_split[1]+"' type='text'> . ");
				document.write("<input id='id_LanNetmask3' class='width_ip' size='3' maxlength='3' value='"+Sub_Mask_split[2]+"' type='text'> . ");
				document.write("<input id='id_LanNetmask4' class='width_ip' size='3' maxlength='3' value='"+Sub_Mask_split[3]+"' type='text'>");
				document.write("</div></td>");
			</script>
		</tr>
	</tbody></table>
	</div>

<!-- 11n -->

	<div name="wifi_11n_setup" id="id_wifi_11n_setup">
	<div><hr class="hr2"></div>
	<div class="lv1_new topbottom_usage1 rowh" ctrlflip="right" ctrlid="2">Wireless 11n Setup</div>
	<div>
	<table><tbody>
	<div><hr class="hr5"></div>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="119">
				<script language="javascript" type="text/javascript">
				document.write(vNameSSID);
				</script>
			</div></td>
			<td ctrlflip="etc"><input class="width_text150" id="id_ssid1" name="WIFISsid1" type="text" maxlength="32"></input></td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="120">
			<script language="javascript" type="text/javascript">
				document.write(vHidden);
			</script>
			SSID</div></td>
			<td ctrlflip="etc">
			<select ar='1' name="WIFIHideSSID1" class="width_select80">
				<script language="javascript" type="text/javascript">
				document.write("<option value='1'>"+vHidden+"</option>");
				document.write("<option value='0'>"+vNotHidden+"</option>");
				</script>
			</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="120">Bandwidth</div></td>
			<td ctrlflip="etc">
			<select ar='1' name="WIFIHTBW" id="id_WIFIHTBW" class="width_select80" ">
				<option value="0">20Mhz</option>
				<option value="1">20/40Mhz</option>
			</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="109">Tx Power</div></td>
			<td><select ar='1' ctrlflip="etc" id="id_WIFITxPower" name="WIFITxPower" class="width_select80">
				<option value="100">Level 1(High)</option>
				<option value="70">Level 2</option>
				<option value="50">Level 3</option>
				<option value="35">Level 4(Low)</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="113">Channel</div></td>
			<td>
				<select ctrlflip="etc" name="WIFIChannel" class="width_select80">
					<script language="javascript" type="text/javascript">
						ChannelList();
					</script>
				</select>
			</td>
			<script language="javascript" type="text/javascript">
				if( fvt_meta_config('wlan_channel') == '0')
				{
					document.write("<td><div class=\"suffix_lr\" ctrlflip=\"right\" ctrlid=\"117\">(Current Channel:");
					document.write(fvt_meta_config('kv_channel_num1'));
					document.write(")</div></td>");
				}
			</script>
		</tr>

		<div class="div2_indent">
		<table><tbody>
		<div><hr class="hr5"></div>
			<tr>
				<td class="width_connectSetup2">Authentication</td>
				<td>
					<select ar='1' ctrlflip="etc" id="id_WIFIAuthType1" name="WIFIAuthType1" onchange="Authen(1);change_auth(1);" width="170px">
					<option value="OPEN">
						<script language="javascript" type="text/javascript">
							document.write(vOpen);
						</script>
					</option>
					<script language="javascript" type="text/javascript">
						if (show_wep == 1)
						{
							document.write("<option value=\"SHARED\">");
							document.write(vShared);
							document.write("</option>");
						}
					</script>
					<option value="WPAPSK">WPA-PSK</option>
					<option value="WPA2PSK">WPA2-PSK</option>
					<option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK Mixed</option>
					<script language="javascript" type="text/javascript">
						if (show_802_1x == 1)
						{
							document.write("<option value=\"WPA\">WPA(802.1x)</option>");
							document.write("<option value=\"WPA2\">WPA2(802.1x)</option>");
						}
					</script>
					</select>
				</td>
			</tr>
			<tr>
				<td class="width_connectSetup2">Security</td>
				<td>
					<table><tr>
						<td><input ctrlflip="etc" id="id_sercurityNon1" name="WIFIEncrypType1" value="NONE" onclick="encryptNone(1)" type="radio" class="radio"></td>
						<td class="width_wifiSe_n"><div ctrlflip="right" ctrlid="179">NONE</div></td>
						<td id=id_weptd1><input id="id_sercurityWep1" name="WIFIEncrypType1" value="WEP" onclick="encryptWep(1)" type="radio" class="radio"></td>
						<td id=id_weptd2 class="width_wifiSe_wep"><div>WEP</div></td>
						<td><input ctrlflip="etc" id="id_sercurityTkip1" name="WIFIEncrypType1" value="TKIP" onclick="encryptTkip(1)" type="radio" class="radio"></td>
						<td class="width_wifiSe_tkip"><div ctrlflip="right" ctrlid="181">TKIP</div></td>
						<td><input ctrlflip="etc" id="id_sercurityAes1" name="WIFIEncrypType1" value="AES" onclick="encryptAes(1)" type="radio" class="radio"></td>
						<td class="width_wifiSe_aes"><div ctrlflip="right" ctrlid="182">AES</div></td>
						<td><input ctrlflip="etc" id="id_sercurityTkipAes1" name="WIFIEncrypType1" value="TKIPAES" onclick="encryptAes(1)" type="radio" class="radio"></td>
						<td><div ctrlflip="right" ctrlid="183">TKIP/AES Mixed</div></td>
					</tr></table>
				</td>
			</tr>
			</tbody></table>

			<table><tbody>
			<tr>
				<td class="width_connectSetup2" valign="top">WPA-PSK/WPA2-PSK</td>
				<td valign="top">Preshared Key:</td>
				<td width="5px"></td>
				<td valign="top">
					<input disabled="disabled" id="id_WIFIWPAPSK1" name="WIFIWPAPSK1" class="width_wifiSe_pkey" size="32" maxlength="63" type="password">
					<script language="javascript" type="text/javascript">
						document.write(vWlanpw);
					</script>
				</td>
			</tr>
			</tbody></table>

			<table id="id_wep_table"><tbody>
			<tr>
				<td class="width_connectSetup2"><div class="" ctrlflip="right" ctrlid="180">WEP</div></td>
				<td>
					<table><tr>
						<td>Passphrase Key:</td>
					</tr></table>
				</td>
				<td class="width_wifisecurity3" ctrlflip="etc">
					<select ar='1' disabled="disabled" name="WIFIWEPPassphraseLen1" id="id_weplLength1"	 class="width_wifiSe_bits">
						<option value="64">64 Bits</option>
						<option value="128">128 Bits</option>
					</select>
				</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_Passphrase1" name="WIFIWEPPassphraseKey1" class="width_text200" size="32" maxlength="32" type="password">
					<script language="javascript" type="text/javascript">
						document.write(vWlanweppw);
					</script>
				</td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td></td>
				<td ctrlflip="etc">
					<input disabled="disabled" name="genBtn1" id="id_genBtn1" class="width_buttoncreate" value="Generate" onclick="genPassphraseKey(1)" type="button">
				</td>
			</tr>
			<tr>
				<td></td>
				<td ctrlflip="etc">
					<select ar='1' disabled="disabled" name="WIFIWEPKeyIndex1" id="id_WIFIWEPKeyIndex1" class="width_wifiSe_keys">
						<option value="1">Key1</option>
						<option value="2">Key2</option>
						<option value="3">Key3</option>
						<option value="4">Key4</option>
					</select>
				</td>
				<td ctrlflip="right">Key1</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWEPKey1_S1" name="WIFIWEPKey1_S1" class="width_text200" size="26" maxlength="26" type="text">
				</td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td ctrlflip="right">Key2</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWEPKey2_S1" name="WIFIWEPKey2_S1" class="width_text200" size="26" maxlength="26" type="text">
				</td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td ctrlflip="right">Key3</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWEPKey3_S1" name="WIFIWEPKey3_S1" class="width_text200" size="26" maxlength="26" type="text">
				</td>
			</tr>
			<tr>
				<td></td>
				<td></td>
				<td ctrlflip="right">Key4</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWEPKey4_S1" name="WIFIWEPKey4_S1" class="width_text200" size="26" maxlength="26" type="text">
				</td>
			</tr>
			</tbody></table>

			<table id="id_802_1x_table"><tbody>
			<tr>
				<td class="width_connectSetup2" ctrlflip="right">802.1X</td>
				<td ctrlflip="right"><div ctrlid="193">Interface</div></td>
				<td><select class='width_routeS_selectif' name="WIFIRadiusWanif" id="id_WIFIRadiusWanif" value='' class='width_select80'>
						<script>
							faceinter();
						</script>
					</select>
				</td>
			</tr>
			<tr>
				<td></td>
				<td ctrlflip="right">Radius Server</td>
				<td dir='ltr'>
					<script language="javascript" type="text/javascript">
						var radiusIP = new Array();
						var RadiusServerAddress = fvt_meta_config('wlan_802_1x_server');
						radiusIP = RadiusServerAddress.split(".");
						document.write("<input type='text' id='id_WIFIRadiusServer_item1' class='width_ip1' size='2' value='"+radiusIP[0]+"' maxlength='3'/>.");
						document.write("<input type='text' id='id_WIFIRadiusServer_item2' class='width_ip1' size='2' value='"+radiusIP[1]+"' maxlength='3'/>.");
						document.write("<input type='text' id='id_WIFIRadiusServer_item3' class='width_ip1' size='2' value='"+radiusIP[2]+"' maxlength='3'/>.");
						document.write("<input type='text' id='id_WIFIRadiusServer_item4' class='width_ip1' size='2' value='"+radiusIP[3]+"' maxlength='3'/>");
						document.write("<input type='hidden' id='id_WIFIRadiusServer' name='WIFIRadiusServer' value='"+RadiusServerAddress+"'>");
					</script>
				</td>
			</tr>
			<tr>
				<td></td>
				<td	 ctrlflip="right">Radius Port</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIRadiusPort" name="WIFIRadiusPort" class="width_textip2" size="15" maxlength="5" type="text">
				</td>
			</tr>
			<tr>
				<td></td>
				<td ctrlflip="right">Radius Key</td>
				<td ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIRadiusKey" name="WIFIRadiusKey" class="width_textip2" size="15" value="12345" maxlength="64" type="password">
					<script language="javascript" type="text/javascript">
						document.write(vradiuskey);
					</script>
				</td>
			</tr>
			</tbody></table>
		</div>
	</tbody></table>
	</div>
	</div>

<div class="div1_indent">
	<div>
	<div><hr class="hr2"></div>

	<div class="top_cwmp2">
		<table>
			<tr>
				<td class="button_center">
				<script language="javascript" type="text/javascript">
				document.write("<input ctrlflip='etc' type='submit' onclick='save_change()' ");
				document.write("name='applybtn' value='"+ vAppSave +"' ");
				document.write("class='btnstyle'>");
				</script>
				</td>
			</tr>
			<tr id="id_wait_progress" style="display:none;position:fixed;top:0px;left:0px;width:100%;height:100%;opacity:0.3;background-color:rgb(0,0,0);">
				<td class="button_center">
					<img src="../images/progress1.gif" style="position:fixed;display:block;top:50%;left:50%;transform:translate(-50%,-50%);">
				</td>
			</tr>
		</table>
	</div>
</div>
</form>
</td></tr>
</tbody></table>
</div>
<br>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<link href="../css/zycss.css" rel="stylesheet" type="text/css" />
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<script language="javascript" type="text/javascript" src="../js/md5.js"></script>
<script language="javascript" type="text/javascript" src="../js/rc4.js"></script>

<script language="javascript" type="text/javascript">
var NavLang=GetNavLang();

if (NavLang == "ZH")
{
var vRegSLID = "註冊ID\(SLID\)值";
var vEnterLN = "請輸入專線編號後10碼";
var vNotice = "請注意：";
var vRegInfo = "SLID格式最多為10個ASCII字元或是以0x開頭的20個16進位字元所組成";
var vWarningRestart = "警告： 改變SLID將會導致重新啟動設備";
var vWanMode = "WAN端模式";
var vEnPPPoE = "請輸入中華電信所提供之使用者名稱與密碼以建立網路連線";
var vSetup = "設定";
var vSSIDName = "名稱\(SSID\)";
var vOpen = "開放系統";
var vAppSave = "儲存";
var vTRSucess = "供裝成功";
var vTRFail = "供裝失敗";
var vNetFail = "網路異常";
var vWlanpw = "<br>\(8~63個ASCII字元. 預設值為 \"00000000\"\)"
}
else
{
var vRegSLID = "Registration ID\(SLID\)";
var vEnterLN = "";
var vNotice = "Notice :";
var vRegInfo = "Registration ID is composed by 10 ASCII characters or 20 hex characters";
var vWarningRestart = "Warning : It will reboot device if changing Registration ID";
var vWanMode = "WAN Mode";
var vEnPPPoE = "Please enter PPPoE username and password to enable network connection";
var vSetup = "Setup";
var vSSIDName = "Name\(SSID\)";
var vOpen = "OPEN";
var vAppSave = "Save";
var vTRSucess = "Apply Successful";
var vTRfail = "Alpply Fail";
var vNetFail = "Network Fail";
var vWlanpw = "<br>\(8~63 ASCII characters, default: \"00000000\"\)"
}

if ( fvt_meta_config('system_modelname') == "I-040GW")
	{var ShowWPA=1;}
else
	{var ShowWPA=0;}

var authtype_flag=0;
var security_flag=0;
var authtype_flagac=0;
var security_flagac=0;
var rc4Key = "27885vt8118";
var ency_set = 1;

var wan_max = 8;
var lan_max = 8;
var cpe_deviceid_str_old;

if (fvt_meta_config('dev_wlanac0_interface') != '') var ac_installed = "1";

function faceinter()
{
	var ifname;
	for (var k=0;k<wan_max;k++)
	{
		if(fvt_meta_config("wan"+k+"_if_name") != '')
		{
			ifname = fvt_meta_config("wan"+k+"_if_name");
			ifinter = fvt_meta_config("dev_wan"+k+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"("+ifname+")</option>");
		}
	}
	for (var l=0;l<lan_max;l++)
	{
		if(fvt_meta_config("dev_lan"+l+"_interface") != '')
		{
			//ifname = fvt_meta_config("wan"+l+"_if_name");
			ifinter = fvt_meta_config("dev_lan"+l+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"</option>");
		}
	}
}

function check_WAN()
{
	if(document.getElementById("id_WANUsername").value == "")
	{
		warn_not_empty("WAN User Name");
		return false;
	}
	if(document.getElementById("id_WANPassword").value == "")
	{
		warn_not_empty("WAN Password");
		return false;
	}
	return true;
}

function changedhcpIP(index)
{
	document.getElementById("id_DHCPSIPStart"+index).value = document.getElementById("id_LanIPAddr"+index).value;
	document.getElementById("id_DHCPSIPEnd"+index).value = document.getElementById("id_LanIPAddr"+index).value;
}

function checkClientRange(gw,start,end)
{
	var gw_d,start_d,end_d;

	gw_d = getDigit(gw,4);
	gw_d +=	getDigit(gw,3)*256;
	gw_d +=	getDigit(gw,2)*256;
	gw_d +=	getDigit(gw,1)*256;

	start_d	= getDigit(start,4);
	start_d	+= getDigit(start,3)*256;
	start_d	+= getDigit(start,2)*256;
	start_d	+= getDigit(start,1)*256;

	end_d =	getDigit(end,4);
	end_d += getDigit(end,3)*256;
	end_d += getDigit(end,2)*256;
	end_d += getDigit(end,1)*256;
	if( start_d <= end_d ){
		if((start_d <= gw_d) &&	(gw_d <= end_d))
			return false;
		else
			return true;
	}

	return false;
}

function dhcpChange()
{
/*	var i;
	if ( document.quick_setup.DHCPSEnable.value == 0 )
	{
		document.getElementById("id_DHCPSIPStart1").disabled=true;
		document.getElementById("id_DHCPSIPStart2").disabled=true;
		document.getElementById("id_DHCPSIPStart3").disabled=true;
		document.getElementById("id_DHCPSIPStart4").disabled=true;
		document.getElementById("id_DHCPSIPEnd1").disabled=true;
		document.getElementById("id_DHCPSIPEnd2").disabled=true;
		document.getElementById("id_DHCPSIPEnd3").disabled=true;
		document.getElementById("id_DHCPSIPEnd4").disabled=true;
	}else
	{
		document.getElementById("id_DHCPSIPStart1").disabled=false;
		document.getElementById("id_DHCPSIPStart2").disabled=false;
		document.getElementById("id_DHCPSIPStart3").disabled=false;
		document.getElementById("id_DHCPSIPStart4").disabled=false;
		document.getElementById("id_DHCPSIPEnd1").disabled=false;
		document.getElementById("id_DHCPSIPEnd2").disabled=false;
		document.getElementById("id_DHCPSIPEnd3").disabled=false;
		document.getElementById("id_DHCPSIPEnd4").disabled=false;
	}*/
}

function Authen(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);
	var nvram;
	nvram=item1;
	document.getElementById("id_sercurityNon" + val).disabled= true;
	document.getElementById("id_sercurityAes" + val).disabled= true;
	document.getElementById("id_sercurityTkipAes" + val).disabled= true;
	document.getElementById("id_WIFIWPAPSK" + val).disabled = false;

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).disabled= false;
		document.getElementById("id_WIFIWPAPSK" + val).disabled = true;
		set_auth_flag(0,val);
		encryptNone(val);
	}

	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityAes" + val).disabled= false;
		set_auth_flag(3,val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAes" + val).disabled= false;
		set_auth_flag(4,val);
	}

	if (item2[0].checked) encryptNone(val);
	if (item2[1].checked) encryptAes(val);
	if (item2[2].checked) encryptTkipAes(val);
}

function Authenac(val)
{
	var item1=document.getElementById("id_WIFIAuthTypeac" + val).value;
	var item2=document.getElementsByName("WIFIEncrypTypeac" + val);
	var nvram;
	nvram=item1;
	document.getElementById("id_sercurityNonac" + val).disabled= true;
	document.getElementById("id_sercurityTkipAesac" + val).disabled= true;

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNonac" + val).disabled= false;
		set_auth_flagac(0,val);
		encryptNoneac(val);
	}

	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityAesac" + val).disabled= false;
		set_auth_flag(3,val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAesac" + val).disabled= false;
		set_auth_flagac(4,val);
	}

	if (item2[0].checked) encryptNoneac(val);
	if (item2[1].checked) encryptAesac(val);
	if (item2[2].checked) encryptTkipAesac(val);
}

function change_auth(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).checked= true;
		document.getElementById("id_WIFIWPAPSK" + val).disabled= true;
		set_auth_flag(0,val);
		encryptNone(val);
	}

	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityAes" + val).checked= true;
		document.getElementById("id_WIFIWPAPSK" + val).disabled= false;
		set_auth_flag(3,val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAes" + val).checked= true;
		document.getElementById("id_WIFIWPAPSK" + val).disabled= false;
		set_auth_flag(4,val);
	}

	if (item2[0].checked) encryptNone(val);
	if (item2[1].checked) encryptAes(val);
	if (item2[2].checked) encryptTkipAes(val);
	if (document.quick_setup.WIFIModuleEnable.value == '0')
		document.getElementById("id_WIFIWPAPSK" + val).disabled= true;
}

function change_authac(val)
{
	var item1=document.getElementById("id_WIFIAuthTypeac" + val).value;
	var item2=document.getElementsByName("WIFIEncrypTypeac" + val);

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNonac" + val).checked= true;
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= true;
		set_auth_flagac(0,val);
		encryptNoneac(val);
	}

	if (item1=="WPA2PSK")
	{
		document.getElementById("id_sercurityAesac" + val).checked= true;
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= false;
		set_auth_flagac(3,val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAesac" + val).checked= true;
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= false;
		set_auth_flagac(4,val);
	}

	if (item2[0].checked) encryptNoneac(val);
	if (item2[1].checked) encryptAesac(val);
	if (item2[2].checked) encryptTkipAesac(val);
	if (document.quick_setup.WIFIModuleEnableac.value == '0')
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= true;

}

function set_auth_flag(index,tag)
{
	switch (tag) {
		case 1:
			authtype_flag=index;
			break;
		case 2:
			authtype_flag2=index;
			break;
		case 3:
			authtype_flag3=index;
			break;
		case 4:
			authtype_flag4=index;
			break;
	}
}

function set_auth_flagac(index,tag)
{
	switch (tag) {
		case 1:
			authtype_flagac=index;
			break;
		case 2:
			authtype_flagac2=index;
			break;
		case 3:
			authtype_flagac3=index;
			break;
		case 4:
			authtype_flagac4=index;
			break;
	}
}

function set_security_flag(index,tag)
{
	switch (tag) {
		case 1:
			security_flag=index;
			break;
		case 2:
			security_flag2=index;
			break;
		case 3:
			security_flag3=index;
			break;
		case 4:
			security_flag4=index;
			break;
	}
}

function set_security_flagac(index,tag)
{
	switch (tag) {
		case 1:
			security_flagac=index;
			break;
		case 2:
			security_flagac2=index;
			break;
		case 3:
			security_flagac3=index;
			break;
		case 4:
			security_flagac4=index;
			break;
	}
}

function encryptNone(val)
{
	set_security_flag(0,val);
}

function encryptNoneac(val)
{
	set_security_flagac(0,val);
}

function encryptTkipAes(val)
{
	set_security_flag(4,val);
	if (val==1 && authtype_flag>4)
	{
		document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}

function encryptTkipAesac(val)
{
	set_security_flagac(4,val);
	if (val==1 && authtype_flagac>4)
	{
		document.getElementById("id_WIFIWPAPSKac" + val).disabled=true;
	}
}

function encryptAes(val)
{
	set_security_flag(3,val);
	if(val==1 && authtype_flag>4)
	{
	  document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}

function encryptAesac(val)
{
	set_security_flagac(3,val);
	if(val==1 && authtype_flag>4)
	{
	  document.getElementById("id_WIFIWPAPSKac" + val).disabled=true;
	}
}
function checkSpecSymbol(s,index)
{
	for(i=0;i<s.length;i++)
	{
		c=s.charAt(i);
		if (index==1)
		{
			if((c==';')||(c=='\\'))
			return false;
		}
		else
		{
			if(c==';')
			return false;
		}
	}
 return true;
}

function check_ssidname()
{
	var temp_ssid= document.getElementById("id_ssid1").value;

	if (temp_ssid.length==0)
	{
		warn_not_empty("11n SSID1 SSID");
		//alert("SSID1 SSID can not be empty!!");
		return false;
	}
	else if (!checkSpecSymbol(temp_ssid,0))
	{
		warn_ssid_illegal("11n SSID1");
		//alert("SSID1 contains illegal characters, like" + " \";\"");
		return false;
	}
	else if (isChinese(temp_ssid))
	{
		warn_ssid_illegal2("11n SSID1 SSID");
		//alert("SSID1 SSID contains illegal characters.");
		return false;
	}

	return true;
}

function check_ssidnameac()
{
	var temp_ssid= document.getElementById("id_ssidac1").value;

	if (temp_ssid.length==0)
	{
		warn_not_empty("11ac SSID1 SSID");
		//alert("SSID1 SSID can not be empty!!");
		return false;
	}
	else if (!checkSpecSymbol(temp_ssid,0))
	{
		warn_ssid_illegal("11ac SSID1");
		//alert("SSID1 contains illegal characters, like" + " \";\"");
		return false;
	}
	else if (isChinese(temp_ssid))
	{
		warn_ssid_illegal2("11ac SSID1 SSID");
		//alert("SSID1 SSID contains illegal characters.");
		return false;
	}

	return true;
}

function wifi_init(val)
{
	if (document.quick_setup.WIFIModuleEnable.value == '0')  //all disable
	{
		document.quick_setup.WIFISsid1.disabled = true;
		document.quick_setup.WIFIAuthType1.disabled = true;
		document.getElementById("id_sercurityNon1").disabled = true;
		document.getElementById("id_sercurityTkipAes1").disabled = true;
		document.quick_setup.WIFIWPAPSK1.disabled = true;
	}
	else //all enable first
	{
		document.quick_setup.WIFISsid1.disabled = false;
		document.quick_setup.WIFIAuthType1.disabled = false;
		document.getElementById("id_sercurityNon1").disabled = false;
		document.getElementById("id_sercurityTkipAes1").disabled = false;
		document.quick_setup.WIFIWPAPSK1.disabled = false;
		Authen(1);
	}
}

function wifi_initac(val)
{
	if (document.quick_setup.WIFIModuleEnableac.value == '0')  //all disable
	{
		document.quick_setup.WIFISsidac1.disabled = true;
		document.quick_setup.WIFIAuthTypeac1.disabled = true;
		document.getElementById("id_sercurityNonac1").disabled = true;
		document.getElementById("id_sercurityTkipAesac1").disabled = true;
		document.quick_setup.WIFIWPAPSKac1.disabled = true;
	}
	else //all enable first
	{
		document.quick_setup.WIFISsidac1.disabled = false;
		document.quick_setup.WIFIAuthTypeac1.disabled = false;
		document.getElementById("id_sercurityNonac1").disabled = false;
		document.getElementById("id_sercurityTkipAesac1").disabled = false;
		document.quick_setup.WIFIWPAPSKac1.disabled = false;
		Authenac(1);
	}
}

function wifi_set1()
{
	var temp=new Array(4);
	var temp_preshared;

	temp_preshared = document.getElementById("id_WIFIWPAPSK1").value;

	if ((authtype_flag==0)&&(security_flag==4))
	{
		warn_wifi_not_match2("11n Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if ( (authtype_flag==4) && (security_flag==0) )
	{
		warn_wifi_not_match2("11n Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if( (security_flag==4) && !((authtype_flag==5)||(authtype_flag==6)) )
	{
		if (temp_preshared.length==0)
		{
			warn_not_empty2("11n Preshared Key",'SSID1');
			//alert("Preshared Key is empty!!");
			return false;
		}
		else if ((8>temp_preshared.length)||(temp_preshared.length>63)||!((temp_preshared.length!=0)&&
			(checkSpecSymbol(temp_preshared,0)&&isChinese(temp_preshared)==0)))
		{
			var item="Preshared Key";
			warn_invalid2("11n Preshared Key","SSID1");
			//alert(item + " is invalid!!");
			return false;
		}
	}

	return true;
}

function wifi_setac1()
{
	var temp=new Array(4);
	var temp_preshared;

	temp_preshared = document.getElementById("id_WIFIWPAPSKac1").value;

	if ((authtype_flagac==0)&&(security_flagac==4))
	{
		warn_wifi_not_match2("11ac Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if ( (authtype_flagac==4) && (security_flagac==0) )
	{
		warn_wifi_not_match2("11ac Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if( (security_flagac==4) && !((authtype_flagac==5)||(authtype_flagac==6)) )
	{
		if (temp_preshared.length==0)
		{
			warn_not_empty2("11ac Preshared Key",'SSID1');
			//alert("Preshared Key is empty!!");
			return false;
		}
		else if ((8>temp_preshared.length)||(temp_preshared.length>63)||!((temp_preshared.length!=0)&&
			(checkSpecSymbol(temp_preshared,0)&&isChinese(temp_preshared)==0)))
		{
			var item="Preshared Key";
			warn_invalid2("11ac Preshared Key","SSID1");
			//alert(item + " is invalid!!");
			return false;
		}
	}

	return true;
}

function changeEnable()
{
	if ( fvt_meta_config('pon_status') == 'O5') {
		document.getElementById("id_hint").style.display ="";
		document.getElementById("onu_password").disabled = true;
	}
	else {
		document.getElementById("id_hint").style.display ="none";
		document.getElementById("onu_password").disabled = false;
	}
}

function checkRegID() {
	var regId = document.getElementById("onu_password").value;
	if (regId.substring(0,2) == "0x" ) {
		/* Hex input case */
		/* Check length first */
		if( regId.length > 22 ) {
			showErrMsg("Error: Register ID(SLID) value exceed maximum length: 20 ");
			return false;
		} else {

			if( regId.length % 2 != 0 ) {
				showErrMsg("Error: Wrong Register ID(SLID) format, please input correct hex value");
				return false;
			}

			/* Check HEX format */
			var regu = /^[0-9a-fA-F]+$/;
			if( regu.test(regId.substring(2, regId.length)) ){
				document.getElementById("onu_password").value="0x"+regId.substring(2, regId.length).toUpperCase();
				return true;
			} else {
				showErrMsg("Error: Wrong Register ID(SLID) format, please input correct hex value");
				return false;
			}
		}
	} else {
		/* ASCII case */
		if ( regId.length > 10 ) {
			alert("SLID value exceed maximum length: 10");
			return false;
		} else {
			return true;
		}
	}
	return true;
}

function save_change()
{
	if(!check_WAN())
		{return false;}

	if(!check_ssidname())
		{return false;}

	if(!wifi_set1())
		{return false;}

	if(ac_installed == "1")
	{
		if(!check_ssidnameac())
			{return false;}

		if(!wifi_setac1())
			{return false;}
	}
	if(!checkRegID())
		{return false;}

	fvt_form_submit('quick_setup');
	document.getElementById('id_wait_progress').style.display="";
	document.quick_setup.submit();
}

function fvt_form_init(form_name)
{
	if(fvt_meta_config("ont_mode")==0)
	{
		document.getElementById("id_wifi_11n_setup").style.display="none";
		document.getElementById("id_wan_label").style.display="none";
		document.getElementById("id_wan_content").style.display="none";
		document.getElementById("id_tr069_label").style.display="none";
		document.getElementById("id_tr069_content").style.display="none";
		document.getElementById("id_lan_label").style.display="none";
		document.getElementById("id_lan_content").style.display="none";
	}
	else
	{
		if(fvt_meta_config('sess_level')=='user')
		{
			//11n
			document.getElementById("WIFIModuleEnable").style.display="none";
			if(fvt_meta_config("wlan_enable")=='1')
			{
				document.getElementById("id_wifi_11n_setup").style.display="inline";
				Authen(1);
			}
			else
			{
				document.getElementById("id_wifi_11n_setup").style.display="none";
			}
			//11ac
			document.getElementById("WIFIModuleEnableac").style.display="none";
			if(fvt_meta_config("wlanac_enable")=='1' && ac_installed == "1")
			{
				document.getElementById("id_wifi_11ac_setup").style.display="inline";
				Authenac(1);
			}
			else
			{
				document.getElementById("id_wifi_11ac_setup").style.display="none";
			}
		}
		else{
			document.getElementById("id_wifi_11n_setup").style.display="inline";
			document.getElementById("WIFIModuleEnable").style.display="inline";
			if(ac_installed == "1")
			{
				document.getElementById("id_wifi_11ac_setup").style.display="inline";
				document.getElementById("WIFIModuleEnableac").style.display="inline";
			}
			else
			{
				document.getElementById("id_wifi_11ac_setup").style.display="none";
				document.getElementById("WIFIModuleEnableac").style.display="none";
			}
		}
	}

	if(fvt_meta_config('sess_level')=='user')
	{
		document.getElementById("slid_setup").style.display="none";
		document.getElementById("tr069_setup").style.display="none";
	}
	else
	{
		document.getElementById("slid_setup").style.display="inline";
		document.getElementById("tr069_setup").style.display="inline";
	}

	if (form_name=='quick_setup' || form_name=='*')
	{
		fvt_form_obj_set(form_name, "onu_password", fvt_meta_config('kv_onu_password'));

		fvt_form_obj_set(form_name, "WANUsername", fvt_meta_config('wan0_pppoe_username'));
		fvt_form_obj_set(form_name, "WANPassword", fvt_meta_config('wan0_pppoe_password'));
		fvt_form_obj_set(form_name, "DHCPSEnable", fvt_meta_config('dhcp0_enable'));

		fvt_form_obj_set(form_name, "WIFIModuleEnable", fvt_meta_config('wlan_enable'));
		fvt_form_obj_set(form_name, "WIFISsid1", fvt_meta_config('wlan_ssid'));
		fvt_form_obj_set(form_name, "WIFIHideSSID1", fvt_meta_config('wlan_hiddenAP'));
		fvt_form_obj_set(form_name, "WIFIAuthType1", fvt_meta_config("wlan_auth_type"));
		fvt_form_obj_set(form_name, "WIFIEncrypType1", fvt_meta_config("wlan_security_type"));

		if (fvt_meta_config("wlan_wpawpa2_presharedkey") == "")
			document.getElementById("id_WIFIWPAPSK1").value = "00000000";
		else
			document.getElementById("id_WIFIWPAPSK1").value = fvt_meta_config("wlan_wpawpa2_presharedkey");

		fvt_form_obj_set(form_name, "WIFIModuleEnableac", fvt_meta_config('wlanac_enable'));
		fvt_form_obj_set(form_name, "WIFISsidac1", fvt_meta_config('wlanac_ssid'));
		fvt_form_obj_set(form_name, "WIFIHideSSIDac1", fvt_meta_config('wlanac_hiddenAP'));
		fvt_form_obj_set(form_name, "WIFIAuthTypeac1", fvt_meta_config("wlanac_auth_type"));
		fvt_form_obj_set(form_name, "WIFIEncrypTypeac1", fvt_meta_config("wlanac_security_type"));

		if (fvt_meta_config("wlanac_wpawpa2_presharedkey") == "")
			document.getElementById("id_WIFIWPAPSKac1").value = "00000000";
		else
			document.getElementById("id_WIFIWPAPSKac1").value = fvt_meta_config("wlanac_wpawpa2_presharedkey");

		//wifi_init(1);
		//wifi_initac(1);
	}
}

function fvt_form_submit(form_name)
{
	fvt_paramlist_clear();
	if (form_name=='quick_setup' || form_name=='*') {
		if(fvt_meta_config('sess_level')=='admin'){

			var old_onu_password = fvt_meta_config('kv_onu_password');
			var onu_password = fvt_form_obj_get(form_name,"onu_password");
			fvt_paramlist_cat_str ("slid_enable",	fvt_form_checkbox_get(form_name, "enableSLID"));

			if( onu_password != old_onu_password)
			{
				fvt_paramlist_cat_str ("onu_password",	onu_password);
				document.getElementById('quick_setup').action="wwwctrl.cgi?action=wait_restart";
				document.getElementById('quick_setup').target = "contentfrm";
			}

		}
		fvt_paramlist_cat_str('wan0_pppoe_username', fvt_form_obj_get(form_name, "WANUsername"));
		var pppoe_pw;
		if(fvt_form_obj_get(form_name, "WANPassword") != fvt_meta_config('wan0_pppoe_password'))
		{
			 pppoe_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WANPassword"));
		}
		else
		{
			 pppoe_pw =fvt_meta_config('wan0_pppoe_password');
		}
		fvt_paramlist_cat_str('wan0_pppoe_password', pppoe_pw);
		fvt_paramlist_cat_str('dhcp0_enable', fvt_form_obj_get(form_name, "DHCPSEnable"));

		//WIFI 11n
		fvt_paramlist_cat_str('wlan_enable', fvt_form_obj_get(form_name, "WIFIModuleEnable"));
		fvt_paramlist_cat_str('wlan_ssid', fvt_form_obj_get(form_name, "WIFISsid1"));
		fvt_paramlist_cat_str("wlan_auth_type", fvt_form_obj_get(form_name, "WIFIAuthType1"));
		fvt_paramlist_cat_str("wlan_security_type", fvt_form_obj_get(form_name, "WIFIEncrypType1"));

		var wlan_pw;
		if (document.quick_setup.WIFIAuthType1.value == "OPEN")
			fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", "");
		else
		{
			//fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
			if(fvt_form_obj_get(form_name, "WIFIWPAPSK1") != fvt_meta_config('wlan_wpawpa2_presharedkey'))
			{
				if (ency_set=="1")
				wlan_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
				else
				wlan_pw = fvt_form_obj_get(form_name, "WIFIWPAPSK1");
			}
			else
			{
				wlan_pw = fvt_meta_config('wlan_wpawpa2_presharedkey');
			}
			fvt_paramlist_cat_str('wlan_wpawpa2_presharedkey', wlan_pw);
		}

		//WIFI 11ac
		fvt_paramlist_cat_str('wlanac_enable', fvt_form_obj_get(form_name, "WIFIModuleEnableac"));
		fvt_paramlist_cat_str('wlanac_ssid', fvt_form_obj_get(form_name, "WIFISsidac1"));
		fvt_paramlist_cat_str("wlanac_auth_type", fvt_form_obj_get(form_name, "WIFIAuthTypeac1"));
		fvt_paramlist_cat_str("wlanac_security_type", fvt_form_obj_get(form_name, "WIFIEncrypTypeac1"));

		var wlanac_pw;
		if (document.quick_setup.WIFIAuthTypeac1.value == "OPEN")
			fvt_paramlist_cat_str("wlanac_wpawpa2_presharedkey", "");
		else
		{
			//fvt_paramlist_cat_str("wlanac_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSKac1"));
			if(fvt_form_obj_get(form_name, "WIFIWPAPSKac1") != fvt_meta_config('wlanac_wpawpa2_presharedkey'))
			{
				if (ency_set=="1")
				wlanac_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWPAPSKac1"));
				else
				wlanac_pw = fvt_form_obj_get(form_name, "WIFIWPAPSKac1");
			}
			else
			{
				wlanac_pw = fvt_meta_config('wlanac_wpawpa2_presharedkey');
			}
			fvt_paramlist_cat_str('wlanac_wpawpa2_presharedkey', wlanac_pw);
			}

		//TR-069
		cpe_deviceid_str = fvt_form_obj_get(form_name, "CWMPCpeID1") +'-'+cpeid[1]+'-'+ fvt_form_obj_get(form_name, "CWMPCpeID2");
		if (cpe_deviceid_str != cpe_deviceid_str_old)
			{
			//alert( cpe_deviceid_str+" ID diff "+cpe_deviceid_str_old);
			fvt_paramlist_cat_str("cwmp_cpe_device_id", cpe_deviceid_str);
			//fvt_paramlist_cat_str("cwmp_bootstrap", "1");
			}
	}
	fvt_paramlist_presubmit(form_name);
}

function bootstrap()
{
	var cpe_deviceid_str;
	cpe_deviceid_str = fvt_form_obj_get("quick_setup", "CWMPCpeID1") +'-'+cpeid[1]+'-'+ fvt_form_obj_get("quick_setup", "CWMPCpeID2");
	fvt_paramlist_clear();
	fvt_paramlist_cat_str("cwmp_cpe_device_id", cpe_deviceid_str);
	if (cpe_deviceid_str != cpe_deviceid_str_old)
		{
		//alert(cpe_deviceid_str+" ID diff "+cpe_deviceid_str_old);
		fvt_paramlist_cat_str("cwmp_cpe_device_id", cpe_deviceid_str);
		//fvt_paramlist_cat_str("cwmp_bootstrap", "1");
		}
	else
		{
		//alert(" cwmp_bootstrap ");
		fvt_paramlist_cat_str("cwmp_bootstrap", "1");
		}
	fvt_paramlist_presubmit("quick_setup");
	document.quick_setup.submit();
}

function bootstrap_init()
{
	var bootmsg=fvt_meta_config('cwmp_boottrap_status');
	if(bootmsg=='0'){
		document.getElementById("id_boot_notice").value=vTRSucess;
	}else if(bootmsg=='1'){
		document.getElementById("id_boot_notice").value=vTRfail;
	}else if(bootmsg=='2'){
		document.getElementById("id_boot_notice").value=vNetFail;
	}else {
		document.getElementById("id_boot_notice").value="";
	}
	document.getElementById("id_boot_notice1").innerHTML = document.getElementById("id_boot_notice").value;
	document.getElementById("id_boot_notice1").style.visibility="visible"
	cpe_deviceid_str_old=fvt_meta_config("cwmp_cpe_device_id");
}

</script>
</head>

<body align="left" onload="fvt_form_init('quick_setup');bootstrap_init();dhcpChange();changeEnable();wifi_init(1);wifi_initac(1);change_auth(1);change_authac(1);">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="quick_setup" name="quick_setup" method="post">

	<fieldset>
		<div class="lv1_title"> Quick Setup </div>
	</fieldset>

<div class="div1_indent lv3_new">

<!-- SLID -->
	<div name="slid_setup" id="slid_setup">
	<div><hr class="hr2"></div>
	<div class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">SLID</div>
	<div><hr class="hr5"></div>
	<div>
	<table><tbody>
		<tr id="id_hint" style="display:none">
			<!--<input type="checkbox" name="enableSLID" id="enableSLID" value="1" onchange="changeEnable();" />-->
			<td class="width_connectSetup2" colspan="2">
				<div><font color="red"><b>Can not modify this setting ! Please disconnect the PON fiber firstly.</b></font></div>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2" width="25%" nowrap="nowrap">
				<script language="javascript" type="text/javascript">
					document.write(vRegSLID);
				</script>
			</td>
			<td nowrap="nowrap">
				<input name="onu_password" id="onu_password" size="30" maxlength="22" value="" type="text">
				<script language="javascript" type="text/javascript">
					document.write(vEnterLN);
				</script>
			</td>
			<td width="25%"></td>
		</tr>
		<tr>
			<td class="width_connectSetup2" colspan="3"><br/><p>
			<script language="javascript" type="text/javascript">
				document.write("<strong>"+vNotice+"</strong>");
				document.write(vRegInfo);
			</script>
			</p></td>
		</tr>
		<tr>
			<td class="width_connectSetup2" colspan="3"><div class="title warning">
				<script language="javascript" type="text/javascript">
					document.write(vWarningRestart);
				</script>
			</div></td>
		</tr>
		<tr></tr>
	</tbody></table>
	</div>
	</div>

<!-- WAN -->
	<div><hr class="hr2"></div>
	<div id="id_wan_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">WAN Setup</div>
	<div id="id_wan_content">
	<div><hr class="hr5"></div>
	<table><tbody>
		<tr>
			<td class="width_connectSetup1"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write(vWanMode);
				</script>
			</div></td>
		</tr>
		<tr>
			<td style="padding-left:20px;" colspan="2"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write(vEnPPPoE);
				</script>
			</div></td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="361">User Name</div></td>
			<td>
				<input ctrlflip='etc' type="text" name="WANUsername" id="id_WANUsername" size="30" maxlength="30" value=''>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="262">Password</div></td>
			<td>
				<input ctrlflip='etc' type="password" name="WANPassword" class="width_routePpoe_password" id="id_WANPassword" maxlength="30" value='' >
			</td>
		</tr>
		<tr></tr>
	</tbody></table>
	</div>

<!-- LAN -->
	<div><hr class="hr2"></div>
	<div id="id_lan_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">LAN Setup</div>
	<div><hr class="hr5"></div>
	<div id="id_lan_content">
	<table><tbody>
		<tr>
			<td class="width_connectSetup1"><div ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
					document.write("DHCP "+vSetup);
				</script>
			</div></td>
		</tr>
		<tr>
			<!-- <input ctrlflip='etc' name="nosave_DHCPSEnable" id="mm_DHCPSEnable" type="hidden"> -->
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="75">DHCP Server</div></td>
			<td ctrlflip='etc'>
				<select ar='1' name="DHCPSEnable" id="id_DHCPSEnable" style="width:128px" onchange="dhcpChange();">
					<option value='0'>Disable</option>
					<option value='1'>Enable</option>
				</select>
			</td>
		</tr>
		<tr></tr>
	</tbody></table>
	</div>

<!-- TR069 -->
<div name="tr069_setup" id="tr069_setup">
	<div><hr class="hr2"></div>
	<div id="id_tr069_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">
		<script language="javascript" type="text/javascript">
			document.write("TR-069 "+vSetup);
		</script>
	</div>
	<div><hr class="hr5"></div>
	<div id="id_tr069_content">
		<table><tbody>
		<tr><td class="width_connectSetup2"><div ctrlflip="right" ctrlid="336">CHT&nbsp;CPE&nbsp;ID:</div></td>
			<td>
				<script>
				cpe_deviceid_str=fvt_meta_config("cwmp_cpe_device_id");
				if (cpe_deviceid_str != '')
				{
					var cpeid = cpe_deviceid_str.split("-");
				}
				else
				{
					var cpeid = new Array();
					cpeid[0] = '';
					cpeid[1] = '';
					cpeid[2] = '';
				}
				document.write("<input ctrlflip='etc' type='text' size='9' maxlength='9' name='CWMPCpeID1' value='"+cpeid[0]+"'>-"+cpeid[1]+"-");
				document.write("<input ctrlflip='etc' type='text' size='4' maxlength='4' name='CWMPCpeID2' value='"+cpeid[2]+"'>");
				</script>
			</td>
		</tr>
		<tr><td class="width_connectSetup2"><div ctrlflip="right" ctrlid="337">Bootstrap:</div></td>
			<td><input ctrlflip="etc" type="button" class="width_cwmp" name="CWMPBootTrap" value="Bootstrap" onclick="bootstrap();"></td>
		</tr>

		<tr>
			<td class="width_connectSetup2"></td>
			<td>
				<input type="hidden" name="boot_notice" id="id_boot_notice" value="">
				<font size="5" color="red">
				<div ctrlflip="right" ctrlid="337" name="boot_notice1" id="id_boot_notice1" style="visibility:hidden">test</div>
				</font>
			</td>
		</tr>
		</tbody></table>
	</div>
</div>

<!-- 11n -->
<div name="wifi_11n_setup" id="id_wifi_11n_setup">
	<div><hr class="hr2"></div>
	<div id="id_wifi11n_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">Wireless 11n Setup</div>
	<div><hr class="hr5"></div>
	<div id="id_wifi11n_content">
		<div class="div2_indent">
	<table><tbody>
		<tr>
			<td class="width_connectSetup2">Wi-Fi 11n</td>
			<td>
				<select ar='1' ctrlflip="etc" name="WIFIModuleEnable" id="WIFIModuleEnable" onchange="wifi_init(1);change_auth(1);" class="width_select80">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="119">
				<script language="javascript" type="text/javascript">
					document.write(vSSIDName);
				</script>
			</div></td>
			<td ctrlflip="etc"><input class="width_text150" id="id_ssid1" name="WIFISsid1" type="text" maxlength="32"/></td>
		</tr>
		<tr>
			<td class="width_connectSetup2">Authentication</td>
			<td>
				<select ar='1' ctrlflip="etc" id="id_WIFIAuthType1" name="WIFIAuthType1" onchange="Authen(1);change_auth(1);" width="170px">
				<option value="OPEN">
				<script language="javascript" type="text/javascript">
					document.write(vOpen);
				</script>
				</option>
				<option value="WPA2PSK">WPA2-PSK</option>
				<option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK Mixed</option>
				</select>
			</td>
		</tr>
		<tr style="display:none"> <!-- Hidden-->
			<td class="width_connectSetup2">Security</td>
			<td>
				<table><tr>
					<td>
					<input ctrlflip="etc" id="id_sercurityNon1" name="WIFIEncrypType1" value="NONE" onclick="encryptNone(1)" type="radio" class="radio">
					</td>
					<td class="width_wifiSe_n">
					<div ctrlflip="right" ctrlid="179">NONE</div>
					</td>
					<td>
					<input ctrlflip="etc" id="id_sercurityAes1" name="WIFIEncrypType1" value="AES" onclick="encryptAes(1)" type="radio" class="radio">
					</td>
					<td class="width_wifiSe_aes">
					<div ctrlflip="right" ctrlid="182">AES</div>
					</td>
					<td>
					<input ctrlflip="etc" id="id_sercurityTkipAes1" name="WIFIEncrypType1" value="TKIPAES" onclick="encryptTkipAes(1)" type="radio" class="radio">
					</td>
					<td>
					<div ctrlflip="right" ctrlid="183">TKIP/AES Mixed</div>
					</td>
				</tr></table>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2">Preshared Key<br>&nbsp;</td>
			<td colspan="2" width="350px" ctrlflip="etc">
				<input id="id_WIFIWPAPSK1" name="WIFIWPAPSK1" class="width_wifiSe_pkey" size="32" maxlength="63" type="password" />
				<script language="javascript" type="text/javascript">
					document.write(vWlanpw);
				</script>
			</td>
		</tr>
		<tr></tr>
	</tbody></table>
		</div>
	</div>
</div>

<!-- 11ac -->
<div name="wifi_11ac_setup" id="id_wifi_11ac_setup">
	<div><hr class="hr2"></div>
	<div id="id_wifi11ac_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">Wireless 11ac Setup</div>
	<div><hr class="hr5"></div>
	<div id="id_wifi11ac_content">
		<div class="div2_indent">
	<table><tbody>
		<tr>
			<td class="width_connectSetup2">Wi-Fi 11ac</td>
			<td>
				<select ar='1' ctrlflip="etc" name="WIFIModuleEnableac" id="WIFIModuleEnableac" onchange="wifi_initac(1);change_authac(1);" class="width_select80">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="119">
				<script language="javascript" type="text/javascript">
					document.write(vSSIDName);
				</script>
			</div></td>
			<td ctrlflip="etc"><input class="width_text150" id="id_ssidac1" name="WIFISsidac1" type="text" maxlength="32"/></td>
		</tr>
		<tr>
			<td class="width_connectSetup2">Authentication</td>
			<td>
				<select ar='1' ctrlflip="etc" id="id_WIFIAuthTypeac1" name="WIFIAuthTypeac1" onchange="Authenac(1);change_authac(1);" width="170px">
				<option value="OPEN">
				<script language="javascript" type="text/javascript">
					document.write(vOpen);
				</script>
				</option>
				<option value="WPA2PSK">WPA2-PSK</option>
				<option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK Mixed</option>
				</select>
			</td>
		</tr>
		<tr style="display:none"> <!-- Hidden-->
			<td class="width_connectSetup2">Security</td>
			<td>
				<table><tr>
					<td>
					<input ctrlflip="etc" id="id_sercurityNonac1" name="WIFIEncrypTypeac1" value="NONE" onclick="encryptNoneac(1)" type="radio" class="radio">
					</td>
					<td class="width_wifiSe_n">
					<div ctrlflip="right" ctrlid="179">NONE</div>
					</td>
					<td>
					<input ctrlflip="etc" id="id_sercurityAesac1" name="WIFIEncrypTypeac1" value="AES" onclick="encryptAesac(1)" type="radio" class="radio">
					</td>
					<td class="width_wifiSe_aes">
					<div ctrlflip="right" ctrlid="182">AES</div>
					</td>
					<td>
					<input ctrlflip="etc" id="id_sercurityTkipAesac1" name="WIFIEncrypTypeac1" value="TKIPAES" onclick="encryptTkipAesac(1)" type="radio" class="radio">
					</td>
					<td>
					<div ctrlflip="right" ctrlid="183">TKIP/AES Mixed</div>
					</td>
				</tr></table>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2">Preshared Key<br>&nbsp;</td>
			<td colspan="2" width="350px" ctrlflip="etc">
				<input id="id_WIFIWPAPSKac1" name="WIFIWPAPSKac1" class="width_wifiSe_pkey" size="32" maxlength="63" type="password"/>
				<script language="javascript" type="text/javascript">
					document.write(vWlanpw);
				</script>
			</td>
		</tr>
		<tr></tr>
	</tbody></table>
		</div>
	</div>
</div>


<div class="div1_indent">
	<div><hr class="hr2"></div>
	<div class="top_cwmp2">
		<table>
			<tr>
				<td class="button_center">
				<script language="javascript" type="text/javascript">
				document.write("<input ctrlflip='etc' type='submit' onclick='save_change()' ");
				document.write("name='applybtn' value='"+ vAppSave +"' ");
				document.write("class='btnstyle'>");
				</script>
				</td>
			</tr>
			<tr id="id_wait_progress" style="display:none">
				<td class="button_center">
					<img src="../images/progress1.gif">
				</td>
			</tr>
		</table>
	</div>
</div>

</div>

</form>
</td></tr>
</tbody></table>

</div>
<br>
</body>
</html>

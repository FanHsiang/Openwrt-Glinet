<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<link href="../css/zycss.css" rel="stylesheet" type="text/css" />
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<script language="javascript" type="text/javascript" src="../js/md5.js"></script>
<script language="javascript" type="text/javascript" src="../js/rc4.js"></script>

<script language="javascript" type="text/javascript">
var authtype_flag=0;
var security_flag=0;

var wan_max = 8;
var lan_max = 8;
if (fvt_meta_config('dev_wlanac0_interface') != '') var ac_installed = "1";

var userLang = navigator.language || navigator.userLanguage;
var English=1;
switch (userLang) {
	case 'zh':
	case 'zh-tw':
	case 'zh-TW':
		English=0
		break;
	default:
		break;
 }
//alert ("The language is: " + userLang + ", Eng=" + English);
if (English == 0)
{
var vHidden = "隱藏";
var vNotHidden = "不隱藏";
var vDhcpSetting = "DHCP 設定";
var vOpen = "開放系統";
var vNameSSID = "名稱\(SSID\)";
var vAppSave = "儲存";
var vLocalNet = "區域網路";
var vWanMode = "WAN端模式";
var vWanUserPasswd = "請輸入中華電信所提供之使用者名稱與密碼以建立網路連線";
var vWlanpw = "<br>\(8~63個ASCII字元. 預設值為 \"00000000\"\)"
}
else
{
var vHidden = "Hidden";
var vNotHidden = "Not hidden";
var vDhcpSetting = "DHCP Setting";
var vOpen = "Open Syatem";
var vNameSSID = "Name\(SSID\)";
var vAppSave = "Save";
var vLocalNet = "Local Network";
var vWanMode = "WAN Side Mode";
var vWanUserPasswd = "Please enter Username and Password which provided by ISP";
var vWlanpw = "<br>\(8~63 ASCII characters, default: \"00000000\"\)"
}
var rc4Key = "27885vt8118";
var ency_set = 1;

function faceinter()
{
	var ifname;
	for (var k=0;k<wan_max;k++)
	{
		if(fvt_meta_config("wan"+k+"_if_name") != '')
		{
			ifname = fvt_meta_config("wan"+k+"_if_name");
			ifinter = fvt_meta_config("dev_wan"+k+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"("+ifname+")</option>");
		}
	}
	for (var l=0;l<lan_max;l++)
	{
		if(fvt_meta_config("dev_lan"+l+"_interface") != '')
		{
			//ifname = fvt_meta_config("wan"+l+"_if_name");
			ifinter = fvt_meta_config("dev_lan"+l+"_interface");
			document.write("<option value='"+ifinter+"'>"+ifinter+"</option>");
		}
	}
}

function valueMatch(s1, s2, match_return)
{
	if(s1 == s2)
		return match_return;
	else
		return "";
}

function check_WAN()
{
	if(document.getElementById("id_WANUsername").value == "")
	{
			warn_not_empty("WAN User Name");
			return false;
	}
	if(document.getElementById("id_WANPassword").value == "")
	{
			warn_not_empty("WAN Password");
			return false;
	}
	return true;
}

function changedhcpIP(index)
{
	document.getElementById("id_DHCPSIPStart"+index).value = document.getElementById("id_LanIPAddr"+index).value;
	document.getElementById("id_DHCPSIPEnd"+index).value = document.getElementById("id_LanIPAddr"+index).value;
}

function check_LAN()
{
	merge_ip("id_LanIPAddr","id_LanIPAddr1","id_LanIPAddr2","id_LanIPAddr3","id_LanIPAddr4");
	merge_ip("id_LanNetmask","id_LanNetmask1","id_LanNetmask2","id_LanNetmask3","id_LanNetmask4");
	merge_ip("id_DHCPSIPStart","id_DHCPSIPStart1","id_DHCPSIPStart2","id_DHCPSIPStart3","id_DHCPSIPStart4");
	merge_ip("id_DHCPSIPEnd","id_DHCPSIPEnd1","id_DHCPSIPEnd2","id_DHCPSIPEnd3","id_DHCPSIPEnd4");
	if (document.connect_setup.LanIPAddr.value=="")
	{
		msg="IP Address";
		no="";
		warn_invalid(msg);
		//alert(msg +" " +no + " is invalid");
		return false;
	}

	if (document.connect_setup.LanIPAddr.value.match(/192.168.[2][.]/g) )
	{
		alert("192.168.2.X section is reserved for system!");
		document.getElementById("id_LanIPAddr3").value="";
		document.getElementById("id_DHCPSIPStart3").value="";
		document.getElementById("id_DHCPSIPEnd3").value="";
		return false;
	}

	//if( document.getElementById('id_LanIPAddr4').value >=251 && document.getElementById('id_LanIPAddr4').value <=254)
	//{
	//	alert("Lan IP range 251~254 is reserved for system");
	//	return false;
	//}

	if ((document.connect_setup.LanNetmask.value == "")||(!check_netmask(document.connect_setup.LanNetmask.value)))
	{
		warn_invalid("Subnet Mask");
		//alert("Subnet Mask is invalid!");
		return false ;
	}
	if (!check_ip(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value))
		{
				msg="IP Address";
				no="";
				warn_invalid(msg);
				//alert(msg +" " +no + " is invalid");
				return false;
		}
	if ( document.connect_setup.DHCPSEnable.selectedIndex == 1)
	{
		if (! check_ip(document.getElementById("id_DHCPSIPStart").value,document.connect_setup.LanNetmask.value))
		{
			warn_invalid("DHCP Starting IP Address1");
			//alert("DHCP Starting IP Address is invalid!");
			return false;
		}

		//if( (document.getElementById('id_DHCPSIPStart4').value >=251 && document.getElementById('id_DHCPSIPStart4').value <=254) ||
		//	(document.getElementById('id_DHCPSIPEnd4').value >=251 && document.getElementById('id_DHCPSIPEnd4').value <=254) )
		//{
		//	alert("DHCP pool range 251~254 is reserved for system");
		//	return false;
		//}

		if ( !checkSubnet(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value,document.getElementById("id_DHCPSIPStart").value))
		{
			warn_invalid("DHCP Starting IP Address2");
		//	alert("DHCP Starting IP Address is invalid!");
			document.getElementById("id_DHCPSIPStart").value = document.getElementById("id_DHCPSIPStart").defaultValue;
			return false;
		}

			if ( !check_ip(document.connect_setup.DHCPSIPEnd.value,document.connect_setup.LanNetmask.value))
			{
				warn_invalid("DHCP Ending IP Address");
				//alert("DHCP Ending IP Address is invalid!");
				return false;
			}

			if ( !checkSubnet(document.connect_setup.LanIPAddr.value,document.connect_setup.LanNetmask.value,document.connect_setup.DHCPSIPEnd.value))
			{
				warn_invalid("DHCP Ending IP Address");
				//alert("DHCP Ending IP Address is invalid!");
				document.connect_setup.DHCPSIPEnd.value = document.connect_setup.DHCPSIPEnd.defaultValue;
				return false;
			}
			if ( !checkClientRange(document.connect_setup.LanIPAddr.value,document.getElementById("id_DHCPSIPStart").value,document.connect_setup.DHCPSIPEnd.value) )
			{
				warn_ipdhcp();
				//alert("Invalid DHCP range value! Please check IP address and DHCP Address!");
				return false;

			}
	}
	return true;
}

function checkClientRange(gw,start,end)
{
	var gw_d,start_d,end_d;

	gw_d = getDigit(gw,4);
	gw_d +=	getDigit(gw,3)*256;
	gw_d +=	getDigit(gw,2)*256;
	gw_d +=	getDigit(gw,1)*256;

	start_d	= getDigit(start,4);
	start_d	+= getDigit(start,3)*256;
	start_d	+= getDigit(start,2)*256;
	start_d	+= getDigit(start,1)*256;

	end_d =	getDigit(end,4);
	end_d += getDigit(end,3)*256;
	end_d += getDigit(end,2)*256;
	end_d += getDigit(end,1)*256;
	if( start_d <= end_d ){
		if((start_d <= gw_d) &&	(gw_d <= end_d))
			return false;
		else
			return true;
	}

	return false;
}

function dhcpChange()
{
	var i;
	if ( document.connect_setup.DHCPSEnable.value == 0 )
	{
			document.getElementById("id_DHCPSIPStart1").disabled=true;
			document.getElementById("id_DHCPSIPStart2").disabled=true;
			document.getElementById("id_DHCPSIPStart3").disabled=true;
			document.getElementById("id_DHCPSIPStart4").disabled=true;
			document.getElementById("id_DHCPSIPEnd1").disabled=true;
			document.getElementById("id_DHCPSIPEnd2").disabled=true;
			document.getElementById("id_DHCPSIPEnd3").disabled=true;
			document.getElementById("id_DHCPSIPEnd4").disabled=true;
	}else
	{
			document.getElementById("id_DHCPSIPStart1").disabled=false;
			document.getElementById("id_DHCPSIPStart2").disabled=false;
			document.getElementById("id_DHCPSIPStart3").disabled=false;
			document.getElementById("id_DHCPSIPStart4").disabled=false;
			document.getElementById("id_DHCPSIPEnd1").disabled=false;
			document.getElementById("id_DHCPSIPEnd2").disabled=false;
			document.getElementById("id_DHCPSIPEnd3").disabled=false;
			document.getElementById("id_DHCPSIPEnd4").disabled=false;
	}
}

function Authen(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);
	var nvram;
	nvram=item1;
	document.getElementById("id_sercurityNon" + val).disabled= true;
	document.getElementById("id_sercurityTkipAes" + val).disabled= true;

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).disabled= false;
		set_auth_flag(0,val);
		encryptNone(val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAes" + val).disabled= false;
		set_auth_flag(4,val);
	}

	if (item2[0].checked) encryptNone(val);
	if (item2[1].checked) encryptTkipAes(val);
}

function Authenac(val)
{
	var item1=document.getElementById("id_WIFIAuthTypeac" + val).value;
	var item2=document.getElementsByName("WIFIEncrypTypeac" + val);
	var nvram;
	nvram=item1;
	document.getElementById("id_sercurityNonac" + val).disabled= true;
	document.getElementById("id_sercurityTkipAesac" + val).disabled= true;

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNonac" + val).disabled= false;
		set_auth_flagac(0,val);
		encryptNoneac(val);
	}

	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAesac" + val).disabled= false;
		set_auth_flagac(4,val);
	}

	if (item2[0].checked) encryptNoneac(val);
	if (item2[1].checked) encryptTkipAesac(val);
}

function change_auth(val)
{
	var item1=document.getElementById("id_WIFIAuthType" + val).value;
	var item2=document.getElementsByName("WIFIEncrypType" + val);

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNon" + val).checked= true;
		document.getElementById("id_WIFIWPAPSK" + val).disabled= true;
		set_auth_flag(0,val);
		encryptNone(val);
	}
	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAes" + val).checked= true;
		document.getElementById("id_WIFIWPAPSK" + val).disabled= false;
		set_auth_flag(4,val);
	}
	if (item2[0].checked) encryptNone(val);
	if (item2[1].checked) encryptTkipAes(val);
}

function change_authac(val)
{
	var item1=document.getElementById("id_WIFIAuthTypeac" + val).value;
	var item2=document.getElementsByName("WIFIEncrypTypeac" + val);

	if (item1=="OPEN")
	{
		document.getElementById("id_sercurityNonac" + val).checked= true;
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= true;
		set_auth_flagac(0,val);
		encryptNoneac(val);
	}
	if (item1=="WPAPSKWPA2PSK")
	{
		document.getElementById("id_sercurityTkipAesac" + val).checked= true;
		document.getElementById("id_WIFIWPAPSKac" + val).disabled= false;
		set_auth_flagac(4,val);
	}
	if (item2[0].checked) encryptNoneac(val);
	if (item2[1].checked) encryptTkipAesac(val);
}

function set_auth_flag(index,tag)
{
	switch (tag) {
		case 1:
			authtype_flag=index;
			break;
		case 2:
			authtype_flag2=index;
			break;
		case 3:
			authtype_flag3=index;
			break;
		case 4:
			authtype_flag4=index;
			break;
	}
}

function set_auth_flagac(index,tag)
{
	switch (tag) {
		case 1:
			authtype_flagac=index;
			break;
		case 2:
			authtype_flagac2=index;
			break;
		case 3:
			authtype_flagac3=index;
			break;
		case 4:
			authtype_flagac4=index;
			break;
	}
}

function set_security_flag(index,tag)
{
	switch (tag) {
		case 1:
			security_flag=index;
			break;
		case 2:
			security_flag2=index;
			break;
		case 3:
			security_flag3=index;
			break;
		case 4:
			security_flag4=index;
			break;
	}
}

function set_security_flagac(index,tag)
{
	switch (tag) {
		case 1:
			security_flagac=index;
			break;
		case 2:
			security_flagac2=index;
			break;
		case 3:
			security_flagac3=index;
			break;
		case 4:
			security_flagac4=index;
			break;
	}
}

function encryptNone(val)
{
	set_security_flag(0,val);
}

function encryptNoneac(val)
{
	set_security_flagac(0,val);
}

function encryptTkipAes(val)
{
	set_security_flag(4,val);
	if (val==1 && authtype_flag>4)
	{
		document.getElementById("id_WIFIWPAPSK" + val).disabled=true;
	}
}

function encryptTkipAesac(val)
{
	set_security_flagac(4,val);
	if (val==1 && authtype_flagac>4)
	{
		document.getElementById("id_WIFIWPAPSKac" + val).disabled=true;
	}
}

function checkSpecSymbol(s,index)
{
 for(i=0;i<s.length;i++)
 {
  c=s.charAt(i);
  if (index==1)
  {
	if((c==';')||(c=='\\'))
		return false;
  }
  else
  {
	if(c==';')
		return false;
  }
 }
 return true;
}


function check_ssidname()
{
	var temp_ssid= document.getElementById("id_ssid1").value;

	if (temp_ssid.length==0)
	{
		warn_not_empty("11n SSID1 SSID");
		//alert("SSID1 SSID can not be empty!!");
		return false;
	}
	else if (!checkSpecSymbol(temp_ssid,0))
	{
		warn_ssid_illegal("11n SSID1");
		//alert("SSID1 contains illegal characters, like" + " \";\"");
		return false;
	}
	else if (isChinese(temp_ssid))
	{
		warn_ssid_illegal2("11n SSID1 SSID");
		//alert("SSID1 SSID contains illegal characters.");
		return false;
	}

	return true;
}

function check_ssidnameac()
{
	var temp_ssid= document.getElementById("id_ssidac1").value;

	if (temp_ssid.length==0)
	{
		warn_not_empty("11ac SSID1 SSID");
		//alert("SSID1 SSID can not be empty!!");
		return false;
	}
	else if (!checkSpecSymbol(temp_ssid,0))
	{
		warn_ssid_illegal("11ac SSID1");
		//alert("SSID1 contains illegal characters, like" + " \";\"");
		return false;
	}
	else if (isChinese(temp_ssid))
	{
		warn_ssid_illegal2("11ac SSID1 SSID");
		//alert("SSID1 SSID contains illegal characters.");
		return false;
	}

	return true;
}

function wifi_init(val)
{
	if (document.connect_setup.WIFIModuleEnable.value == '0')  //all disable
	{
		document.connect_setup.WIFISsid1.disabled = true;
		document.connect_setup.WIFIAuthType1.disabled = true;
		document.getElementById("id_sercurityNon1").disabled = true;
		document.getElementById("id_sercurityTkipAes1").disabled = true;
		document.connect_setup.WIFIWPAPSK1.disabled = true;
	}
	else //all enable first
	{
		document.connect_setup.WIFISsid1.disabled = false;
		document.connect_setup.WIFIAuthType1.disabled = false;
		document.getElementById("id_sercurityNon1").disabled = false;
		document.getElementById("id_sercurityTkipAes1").disabled = false;
		document.connect_setup.WIFIWPAPSK1.disabled = false;
		Authen(1);
	}
}

function wifi_initac(val)
{
	if (document.connect_setup.WIFIModuleEnableac.value == '0')  //all disable
	{
		document.connect_setup.WIFISsidac1.disabled = true;
		document.connect_setup.WIFIAuthTypeac1.disabled = true;
		document.getElementById("id_sercurityNonac1").disabled = true;
		document.getElementById("id_sercurityTkipAesac1").disabled = true;
		document.connect_setup.WIFIWPAPSKac1.disabled = true;
	}
	else //all enable first
	{
		document.connect_setup.WIFISsidac1.disabled = false;
		document.connect_setup.WIFIAuthTypeac1.disabled = false;
		document.getElementById("id_sercurityNonac1").disabled = false;
		document.getElementById("id_sercurityTkipAesac1").disabled = false;
		document.connect_setup.WIFIWPAPSKac1.disabled = false;
		Authenac(1);
	}
}

function wifi_set1()
{
	var temp=new Array(4);
	var temp_preshared;

	temp_preshared = document.getElementById("id_WIFIWPAPSK1").value;

	if ((authtype_flag==0)&&(security_flag==4))
	{
		warn_wifi_not_match2("11n Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if ( (authtype_flag==4) && (security_flag==0) )
	{
		warn_wifi_not_match2("11n Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if( (security_flag==4) && !((authtype_flag==5)||(authtype_flag==6)) )
	{
		if (temp_preshared.length==0)
		{
			warn_not_empty2("11n Preshared Key",'SSID1');
			//alert("Preshared Key is empty!!");
			return false;
		}
		else if ((8>temp_preshared.length)||(temp_preshared.length>63)||!((temp_preshared.length!=0)&&
			(checkSpecSymbol(temp_preshared,0)&&isChinese(temp_preshared)==0)))
		{
			var item="Preshared Key";
			warn_invalid2("11n Preshared Key","SSID1");
			//alert(item + " is invalid!!");
			return false;
		}
	}

	return true;
}

function wifi_setac1()
{
	var temp=new Array(4);
	var temp_preshared;

	temp_preshared = document.getElementById("id_WIFIWPAPSKac1").value;

	if ((authtype_flagac==0)&&(security_flagac==4))
	{
		warn_wifi_not_match2("11ac Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if ( (authtype_flagac==4) && (security_flagac==0) )
	{
		warn_wifi_not_match2("11ac Authentication","Security Type","SSID1");
		//alert("Authentication and Security Type don't match!!");
		return false;
	}

	if( (security_flagac==4) && !((authtype_flagac==5)||(authtype_flagac==6)) )
	{
		if (temp_preshared.length==0)
		{
			warn_not_empty2("11ac Preshared Key",'SSID1');
			//alert("Preshared Key is empty!!");
			return false;
		}
		else if ((8>temp_preshared.length)||(temp_preshared.length>63)||!((temp_preshared.length!=0)&&
			(checkSpecSymbol(temp_preshared,0)&&isChinese(temp_preshared)==0)))
		{
			var item="Preshared Key";
			warn_invalid2("11ac Preshared Key","SSID1");
			//alert(item + " is invalid!!");
			return false;
		}
	}

	return true;
}

function save_change()
{
	if(!check_WAN())
	{
		return false;
	}
	if(!check_LAN())
	{
		return false;
	}
	if(!check_ssidname())
		return false;

	if(!check_ssidnameac())
		return false;

	if(!wifi_set1())
		return false;

	if(!wifi_setac1())
		return false;

	if (!check_integer_range(document.connect_setup.WIFITxPower.value,1,100))
	{
		item = "11n Tx Power";
		min = "1";
		max = "100";
		warn_int_between(item,min,max);
		return false;
	}

	if (!check_integer_range(document.connect_setup.WIFIACTxPower.value,1,100))
	{
		item = "11ac Tx Power";
		min = "1";
		max = "100";
		warn_int_between(item,min,max);
		return false;
	}

	if ((authtype_flag==5)||(authtype_flag==6))
	{
		if (!checkRadius())
			return false;
	}

	fvt_form_submit('connect_setup');
	document.connect_setup.submit();
}

function fvt_form_init(form_name)
{
	if(fvt_meta_config("wlan_enable")==0)
		{
		document.getElementById("id_wifi_11n_setup").style.display="none";
		}
	else
		{
		document.getElementById("id_wifi_11n_setup").style.display="inline";
		}

	if(fvt_meta_config("wlanac_enable")==0)
		{
		document.getElementById("id_wifi_11ac_setup").style.display="none";
		}
	else
		{
		if (ac_installed == "1")
			document.getElementById("id_wifi_11ac_setup").style.display="inline";
		else
			document.getElementById("id_wifi_11ac_setup").style.display="none";
		}

	if (form_name=='connect_setup' || form_name=='*') {
		fvt_form_obj_set(form_name, "WANUsername", fvt_meta_config('wan0_pppoe_username'));
		fvt_form_obj_set(form_name, "WANPassword", fvt_meta_config('wan0_pppoe_password'));
		fvt_form_obj_set(form_name, "DHCPSEnable", fvt_meta_config('dhcp0_enable'));

		fvt_form_obj_set(form_name, "WIFIModuleEnable", fvt_meta_config('wlan_enable'));
		fvt_form_obj_set(form_name, "WIFISsid1", fvt_meta_config('wlan_ssid'));
		fvt_form_obj_set(form_name, "WIFIHideSSID1", fvt_meta_config('wlan_hiddenAP'));
		fvt_form_obj_set(form_name, "WIFIAuthType1", fvt_meta_config("wlan_auth_type"));
		fvt_form_obj_set(form_name, "WIFIEncrypType1", fvt_meta_config("wlan_security_type"));
		fvt_form_obj_set(form_name, "WIFITxPower", fvt_meta_config('wlan_tx_power'));

		if (fvt_meta_config("wlan_wpawpa2_presharedkey") == "")
			//document.getElementById("id_WIFIWPAPSK1").value = "00000000";
			document.getElementById("id_WIFIWPAPSK1").value = rc4_encrypt(rc4Key,"00000000");
		else
		document.getElementById("id_WIFIWPAPSK1").value = fvt_meta_config("wlan_wpawpa2_presharedkey");

		fvt_form_obj_set(form_name, "WIFIModuleEnableac", fvt_meta_config('wlanac_enable'));
		fvt_form_obj_set(form_name, "WIFISsidac1", fvt_meta_config('wlanac_ssid'));
		fvt_form_obj_set(form_name, "WIFIHideSSIDac1", fvt_meta_config('wlanac_hiddenAP'));
		fvt_form_obj_set(form_name, "WIFIAuthTypeac1", fvt_meta_config("wlanac_auth_type"));
		fvt_form_obj_set(form_name, "WIFIEncrypTypeac1", fvt_meta_config("wlanac_security_type"));
		fvt_form_obj_set(form_name, "WIFIACTxPower", fvt_meta_config('wlanac_tx_power'));


		if (fvt_meta_config("wlanac_wpawpa2_presharedkey") == "")
			//document.getElementById("id_WIFIWPAPSKac1").value = "00000000";
			document.getElementById("id_WIFIWPAPSKac1").value = rc4_encrypt(rc4Key,"00000000");
		else
			document.getElementById("id_WIFIWPAPSKac1").value = fvt_meta_config("wlanac_wpawpa2_presharedkey");
	}
	Authen(1);
	Authenac(1);

}

function fvt_form_submit(form_name)		{
	fvt_paramlist_clear();
	if (form_name=='connect_setup' || form_name=='*') {
		fvt_paramlist_cat_str('wan0_pppoe_username', fvt_form_obj_get(form_name, "WANUsername"));
		fvt_paramlist_cat_str('wan0_pppoe_password', fvt_form_obj_get(form_name, "WANPassword"));

		fvt_paramlist_cat_str('dhcp0_enable', fvt_form_obj_get(form_name, "DHCPSEnable"));
		fvt_paramlist_cat_str('dhcp0_number_start', fvt_form_obj_get(form_name, "DHCPSIPStart"));		//hidden
		fvt_paramlist_cat_str('dhcp0_number_end', fvt_form_obj_get(form_name, "DHCPSIPEnd"));		//hidden
		fvt_paramlist_cat_str('lan0_ip', fvt_form_obj_get(form_name, "LanIPAddr"));		//hidden
		fvt_paramlist_cat_str('lan0_netmask', fvt_form_obj_get(form_name, "LanNetmask"));		//hidden

		//WIFI 11n
		fvt_paramlist_cat_str('wlan_enable', fvt_form_obj_get(form_name, "WIFIModuleEnable"));
		fvt_paramlist_cat_str('wlan_ssid', fvt_form_obj_get(form_name, "WIFISsid1"));
		fvt_paramlist_cat_str("wlan_auth_type", fvt_form_obj_get(form_name, "WIFIAuthType1"));
		fvt_paramlist_cat_str("wlan_security_type", fvt_form_obj_get(form_name, "WIFIEncrypType1"));
		fvt_paramlist_cat_str('wlan_tx_power', fvt_form_obj_get(form_name, "WIFITxPower"));

		if (document.connect_setup.WIFIAuthType1.value == "OPEN")
			fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", "");
		else
		{
			//fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
			var wlan_pw;
			if(fvt_form_obj_get(form_name, "WIFIWPAPSK1") != fvt_meta_config("wlan_wpawpa2_presharedkey"))
			{
				if (ency_set=="1")
					wlan_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWPAPSK1"));
				else
					wlan_pw = fvt_form_obj_get(form_name, "WIFIWPAPSK1");
			}
			else
			{
				wlan_pw = fvt_meta_config("wlan_wpawpa2_presharedkey");
			}
			fvt_paramlist_cat_str("wlan_wpawpa2_presharedkey", wlan_pw);
		}

		//WIFI 11ac
		fvt_paramlist_cat_str('wlanac_enable', fvt_form_obj_get(form_name, "WIFIModuleEnableac"));
		fvt_paramlist_cat_str('wlanac_ssid', fvt_form_obj_get(form_name, "WIFISsidac1"));
		fvt_paramlist_cat_str("wlanac_auth_type", fvt_form_obj_get(form_name, "WIFIAuthTypeac1"));
		fvt_paramlist_cat_str("wlanac_security_type", fvt_form_obj_get(form_name, "WIFIEncrypTypeac1"));
		fvt_paramlist_cat_str('wlanac_tx_power', fvt_form_obj_get(form_name, "WIFIACTxPower"));

		if (document.connect_setup.WIFIAuthTypeac1.value == "OPEN")
			fvt_paramlist_cat_str("wlanac_wpawpa2_presharedkey", "");
		else
		{
			//fvt_paramlist_cat_str("wlanac_wpawpa2_presharedkey", fvt_form_obj_get(form_name, "WIFIWPAPSKac1"));
			var wlan_pw;
			if(fvt_form_obj_get(form_name, "WIFIWPAPSKac1") != fvt_meta_config("wlanac_wpawpa2_presharedkey"))
			{
				if (ency_set=="1")
					wlan_pw = rc4_encrypt(rc4Key, fvt_form_obj_get(form_name, "WIFIWPAPSKac1"));
				else
					wlan_pw = fvt_form_obj_get(form_name, "WIFIWPAPSKac1");
			}
			else
			{
				wlan_pw = fvt_meta_config("wlanac_wpawpa2_presharedkey");
			}
			fvt_paramlist_cat_str("wlanac_wpawpa2_presharedkey", wlan_pw);
		}
	}
	fvt_paramlist_presubmit(form_name);
}

</script>
</head>

<body align="left" onload="fvt_form_init('connect_setup');dhcpChange();change_auth(1);change_authac(1);">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="connect_setup" name="connect_setup" method="post">
	<fieldset>
		<div class="lv1_title">
		Connection Setup&nbsp;&gt;&nbsp;Connect Setup</div>
	</fieldset>
<div class="div1_indent lv3_new">
	<div class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">WAN Setup</div>
	<div>
	<table><tbody>
	<div><hr class="hr5"></div>
		<tr>
			<td class="width_connectSetup1"><div  ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
				document.write(vWanMode);
				</script>
			</div></td>
		</tr>
		<tr>
			<td style="padding-left:20px;" colspan="2"><div	 ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
				document.write(vWanUserPasswd);
				</script>
			</div></td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div  ctrlflip="right" ctrlid="361">User Name</div></td>
			<td>
				<input ctrlflip='etc' type="text" name="WANUsername" id="id_WANUsername" size="30" maxlength="30" value=''>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div  ctrlflip="right" ctrlid="262">Password</div></td>
			<td>
				<input ctrlflip='etc' type="password" name="WANPassword" class="width_routePpoe_password" id="id_WANPassword" maxlength="30" value=''/>
			</td>
		</tr>
	</tbody></table>
	</div>

	<div><hr class="hr2"></div>
	<div class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">LAN Setup</div>
	<div>
	<table><tbody>
		<tr>
			<td class="width_connectSetup1"><div  ctrlflip="right" ctrlid="75">
			<script language="javascript" type="text/javascript">
			document.write(vDhcpSetting);
			</script>
			</div></td>
		</tr>
	<div><hr class="hr5"></div>
		<tr>
			<input ctrlflip='etc' name="nosave_DHCPSEnable" id="mm_DHCPSEnable" type="hidden">
			<td class="width_connectSetup2"><div  ctrlflip="right" ctrlid="75">DHCP Server</div></td>
			<td ctrlflip='etc'>
				<select ar='1' name="DHCPSEnable" id="id_DHCPSEnable" style="width:128px"  onchange="dhcpChange();">
					<option value='0'>Disable</option>
					<option value='1'>Enable</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip='right' ctrlid="79">DHCP&nbsp;Starting&nbsp;IP&nbsp;Address</div></td>
			<input ctrlflip='etc' name="DHCPSIPStart" id="id_DHCPSIPStart" type="hidden">

			<script language="javascript" type="text/javascript">
				var IP_Address = fvt_meta_config('dhcp0_number_start');
				var IP_Address_split = IP_Address.split(".");
				document.write("<td ctrlflip='right' ><div dir='ltr'>");
				document.write("<input id='id_DHCPSIPStart1' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[0]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart2' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[1]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart3' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[2]+"' type='text'>.");
				document.write("<input id='id_DHCPSIPStart4' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[3]+"' type='text' name='DHCPSIPStart4'>");
				document.write("</div></td>");
			</script>
		</tr>
		<tr>
		<td class="width_connectSetup2"><div ctrlflip='right' ctrlid="80">DHCP&nbsp;Ending&nbsp;IP&nbsp;Address</div></td>
		<input ctrlflip="etc" name="DHCPSIPEnd" id="id_DHCPSIPEnd" type="hidden">

		<script language="javascript" type="text/javascript">
			var IP_Address = fvt_meta_config('dhcp0_number_end');
			var IP_Address_split = IP_Address.split(".");
			document.write("<td ctrlflip='right'><div dir='ltr'>");
			document.write("<input id='id_DHCPSIPEnd1' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[0]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd2' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[1]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd3' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[2]+"' type='text'>.");
			document.write("<input id='id_DHCPSIPEnd4' class='width_ip' size='3' maxlength='3' value='"+IP_Address_split[3]+"' type='text' name='DHCPSIPEnd4'>");
			document.write("</div></td>");
		</script>
		</tr>
		<tr></tr>
		<tr>
			<td class="width_connectSetup1"><div  ctrlflip="right" ctrlid="75">
				<script language="javascript" type="text/javascript">
				document.write(vLocalNet);
				</script>
			TCP/IP</div></td>
		</tr>
		<tr>
			<input name="lan_gateway" value="0.0.0.0" type="hidden">
			<input name="LanIPAddr" id="id_LanIPAddr" type="hidden">
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="32">IP Address</div></td>
			<script language="javascript" type="text/javascript">
				var IP_Address = fvt_meta_config('lan0_ip');
				var IP_Address_split = IP_Address.split(".");
				document.write("<td ctrlflip='etc'><div dir=\"ltr\">");
				document.write("<input id=\"id_LanIPAddr1\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+IP_Address_split[0]+"' onkeyup=\"changedhcpIP(1)\" type=\"text\"> . ");
				document.write("<input id=\"id_LanIPAddr2\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+IP_Address_split[1]+"' onkeyup=\"changedhcpIP(2)\" type=\"text\"> . ");
				document.write("<input id=\"id_LanIPAddr3\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+IP_Address_split[2]+"' onkeyup=\"changedhcpIP(3)\" type=\"text\"> . ");
				document.write("<input id=\"id_LanIPAddr4\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+IP_Address_split[3]+"' type=\"text\">");
				document.write("</div></td>");
			</script>
		</tr>
		<tr>
			<input name="LanNetmask" id="id_LanNetmask" type="hidden">
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="69">Subnet Mask</div></td>
			<script language="javascript" type="text/javascript">
				var Sub_Mask = fvt_meta_config('lan0_netmask');
				var Sub_Mask_split = Sub_Mask.split(".");
				document.write("<td ctrlflip='etc'><div dir=\"ltr\">");
				document.write("<input id=\"id_LanNetmask1\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+Sub_Mask_split[0]+"' type=\"text\"> . ");
				document.write("<input id=\"id_LanNetmask2\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+Sub_Mask_split[1]+"' type=\"text\"> . ");
				document.write("<input id=\"id_LanNetmask3\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+Sub_Mask_split[2]+"' type=\"text\"> . ");
				document.write("<input id=\"id_LanNetmask4\" class=\"width_ip\" size=\"3\" maxlength=\"3\" value='"+Sub_Mask_split[3]+"' type=\"text\">");
				document.write("</div></td>");
			</script>
		</tr>
	  </tbody></table>
	</div>

<!-- 11n -->
<div name="wifi_11n_setup" id="id_wifi_11n_setup">
	<div><hr class="hr2"></div>
	<div id="id_wifi11n_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">Wireless 11n Setup</div>
	<div><hr class="hr5"></div>
	<div id="id_wifi11n_content">
	<table><tbody>
		<div class="div2_indent">
		<tr style="display:none">
			<td class="width_connectSetup2">Wi-Fi 11n</td>
			<td >
				<select ar='1' ctrlflip="etc" name="WIFIModuleEnable" id="WIFIModuleEnable" onchange="wifi_init(1);" class="width_select80">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="119">
				<script language="javascript" type="text/javascript">
				document.write(vNameSSID);
				</script>
			</div></td>
			<td ctrlflip="etc"><input class="width_text150" id="id_ssid1" name="WIFISsid1" type="text" maxlength="32"></input></td>
		</tr>
			<tr>
				<td class="width_connectSetup2">Authentication</td>
				<td>
					<select ar='1' ctrlflip="etc" id="id_WIFIAuthType1" name="WIFIAuthType1" onchange="Authen(1);change_auth(1);" width="170px">
					<option value="OPEN">
						<script language="javascript" type="text/javascript">
						document.write(vOpen);
						</script>
					</option>
					<option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK Mixed</option>
					</select>
				</td>
			</tr>
			<tr style="display:none"> <!-- Hidden-->
				<td class="width_connectSetup2">Security</td>
				<td>
					<table><tr>
						<td>
						<input ctrlflip="etc" id="id_sercurityNon1" name="WIFIEncrypType1" value="NONE" onclick="encryptNone(1)" type="radio" class="radio">
						</td>
						<td class="width_wifiSe_n">
						<div ctrlflip="right" ctrlid="179">NONE</div>
						</td>
						<td>
						<input ctrlflip="etc" id="id_sercurityTkipAes1" name="WIFIEncrypType1" value="TKIPAES" onclick="encryptTkipAes(1)" type="radio" class="radio">
						</td>
						<td>
						<div ctrlflip="right" ctrlid="183">TKIP/AES Mixed</div>
						</td>
					</tr></table>
				</td>
			</tr>

			<tr>
				<td class="width_connectSetup2">Preshared Key<br>&nbsp;</td>
				<td colspan="2" width="350px" ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWPAPSK1" name="WIFIWPAPSK1" class="width_wifiSe_pkey" size="32" maxlength="63" type="password">
					<script language="javascript" type="text/javascript">
						document.write(vWlanpw);
					</script>
				</td>
			</tr>
			<tr>
			<td class="width_connectSetup2">Tx Power</td>
			<td>
			<select ar='1' ctrlflip="etc" id="id_WIFITxPower" name="WIFITxPower" class="width_select80">
				<option value="100">Level 1(High)</option>
				<option value="70">Level 2</option>
				<option value="50">Level 3</option>
				<option value="35">Level 4(Low)</option>
			</select>
			</td>
			</tr>
		<tr></tr>
		</div>
	</tbody></table>
	</div>
</div>

<!-- 11ac -->
<div name="wifi_11ac_setup" id="id_wifi_11ac_setup">
	<div><hr class="hr2"></div>
	<div id="id_wifi11ac_label" class="lv1_new topbottom_usage1" ctrlflip="right" ctrlid="2">Wireless 11ac Setup</div>
	<div><hr class="hr5"></div>
	<div id="id_wifi11ac_content">
	<table><tbody>
		<div class="div2_indent">
		<tr style="display:none">
			<td class="width_connectSetup2">Wi-Fi 11ac</td>
			<td>
				<select ar='1' ctrlflip="etc" name="WIFIModuleEnableac" id="WIFIModuleEnableac" onchange="wifi_initac(1);" class="width_select80">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select>
			</td>
		</tr>
		<tr>
			<td class="width_connectSetup2"><div ctrlflip="right" ctrlid="119">
				<script language="javascript" type="text/javascript">
				document.write(vNameSSID);
				</script>
			</div></td>
			<td ctrlflip="etc"><input class="width_text150" id="id_ssidac1" name="WIFISsidac1" type="text" maxlength="32"></input></td>
		</tr>
			<tr>
				<td class="width_connectSetup2">Authentication</td>
				<td>
					<select ar='1' ctrlflip="etc" id="id_WIFIAuthTypeac1" name="WIFIAuthTypeac1" onchange="Authenac(1);change_authac(1);" width="170px">
					<option value="OPEN">
						<script language="javascript" type="text/javascript">
						document.write(vOpen);
						</script>
					</option>
					<option value="WPAPSKWPA2PSK">WPA-PSK/WPA2-PSK Mixed</option>
					</select>
				</td>
			</tr>
			<tr style="display:none"> <!-- Hidden-->
				<td class="width_connectSetup2">Security</td>
				<td>
					<table><tr>
						<td>
						<input ctrlflip="etc" id="id_sercurityNonac1" name="WIFIEncrypTypeac1" value="NONE" onclick="encryptNoneac(1)" type="radio" class="radio">
						</td>
						<td class="width_wifiSe_n">
						<div ctrlflip="right" ctrlid="179">NONE</div>
						</td>
						<td>
						<input ctrlflip="etc" id="id_sercurityTkipAesac1" name="WIFIEncrypTypeac1" value="TKIPAES" onclick="encryptTkipAesac(1)" type="radio" class="radio">
						</td>
						<td>
						<div ctrlflip="right" ctrlid="183">TKIP/AES Mixed</div>
						</td>
					</tr></table>
				</td>
			</tr>

			<tr>
				<td class="width_connectSetup2">Preshared Key<br>&nbsp;</td>
				<td colspan="2" width="350px" ctrlflip="etc">
					<input disabled="disabled" id="id_WIFIWPAPSKac1" name="WIFIWPAPSKac1" class="width_wifiSe_pkey" size="32" maxlength="63" type="password">
					<script language="javascript" type="text/javascript">
						document.write(vWlanpw);
					</script>
				</td>
			</tr>
			<tr>
			<td class="width_connectSetup2">Tx Power</td>
			<td>
			<select ar='1' ctrlflip="etc" id="id_WIFIACTxPower" name="WIFIACTxPower" class="width_select80">
				<option value="100">Level 1(High)</option>
				<option value="70">Level 2</option>
				<option value="50">Level 3</option>
				<option value="35">Level 4(Low)</option>
			</select>
			</td>
			</tr>
		<tr></tr>
		</div>
	</tbody></table>
	</div>
</div>

<div class="div1_indent">
   <div>
	<div><hr class="hr2"></div>

	<div class="top_cwmp2">
		<table>
			<tr>
				<td class="button_center">
					<script language="javascript" type="text/javascript">
				document.write("<input ctrlflip='etc' type='submit' onclick='save_change()'");
				document.write(" name='applybtn' value="+vAppSave);
				document.write(" class='btnstyle'>");
					</script>
				</td>
			</tr>
		</table>
	</div>
</div>
</form>
</td></tr>
</tbody></table>
</div>
<br>
</body>
</html>


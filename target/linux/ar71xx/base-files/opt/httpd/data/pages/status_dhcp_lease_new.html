<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<script language="javascript" type="text/javascript" src="../js/jquery-1.8.3.min.js"></script>
<style>
th {
    color: #00008B;
    font-weight: bold;
    font-size: 11pt;
    position: relative;
	padding-left:10px;
	background-color:white;
}
td {
    color: rgb(1, 1, 1);
    font-size: 10pt;
    position: relative;
	padding-left:10px;
}
table#leased_table tr:nth-of-type(odd) {
      background-color:#F0F0F0;
    }
</style>
</head>

<body align="left">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="dhcp_lease_form" name="dhcp_lease_form" method="post">
<fieldset>
		<div class="lv1_title">
		Status&nbsp;&gt;&nbsp;DHCP Lease
		</div>
</fieldset>
<div class="div1_indent lv3_new">
	<table id="leased_table">
		<tr>
			<th class="width_dhcpL_no">No.</th>
			<th class="width_dhcpL_ipAddr">IP Address</th>
			<th class="width_dhcpL_mac">MAC Address</th>
			<th class="width_dhcpL_hname">Host Name</th>
			<th class="width_dhcpL_expiry">Expiry</th>
		</tr>
		<tr style="height:5px;">
			<td colspan="5" style="padding-left:0px;">
				<hr class="hr2">
			</td>
		</tr>
	</table>
</div>
</form>
</td></tr>
</tbody></table>
</div>
<br>
<script type="text/javascript">
var gv_tab_data;
var igmp_status_now;
function init_page()
{
}
function do_load()
{
	loadTableData();
	setInterval(loadTableData, 15*1000);
	//setIntervalLimited(function(){loadTableData();}, 5000, 10);
};

function loadTableData()
{
	$.ajax({
		url: "status_dhcp_lease.cmd",
		data: {
			action: "get"
		},
		async: true,
		dataType: 'text',
		type: "POST",
		success: function (data) {
			var i=1;
			$(".removeOnReload").remove();
			if (data && $.trim(data).length > 0) {
				gv_tab_data = eval("(" + data + ")");
				//console.info("x="+gv_tab_data);
				var tab = $("#leased_table");
				$.each(gv_tab_data, function() {
					var row = $("<tr class='removeOnReload'></tr>");
					row.append($("<td>" + i + "</td>"));
					row.append($("<td>" + this.IpAddress + "</td>"));
					row.append($("<td>" + this.Mac + "</td>"));
					row.append($("<td>" + this.HostName + "</td>"));
					row.append($("<td>" + this.Expiry + "</td>"));
					row.appendTo(tab);
					i=i+1;
				})
			} else {
				gv_tab_data = false
			}
		},
		error: function () {
			//pop_up("error happens during load table data.", 0);
			//alert("error happens during load table data.");
		}
	})

};

function setIntervalLimited(callback, interval, x)
{
	for (var i = 0; i < x; i++)
	{
		setTimeout(callback, i * interval);
    }
}

</script>
<script type="text/javascript">
$(document).ready(function(){
	init_page();
	do_load();
});
</script>
</body>
</html>

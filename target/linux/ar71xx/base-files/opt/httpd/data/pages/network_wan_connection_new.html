<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<style type="text/css">
input.warning1{color: red; background-color:lightgreen;}
input.warning2{color: red;}
input.edit1{color: blue;}
div.vidstyle{color: #2F4F4F;}
div.Wname{color: #4B0082;}
td.tdcenter{text-align: center;}
th.thcenter{text-align: center;}
tr.trwan {
	border-top: 10px solid;
	border-bottom: 10px solid;
	border-color: transparent;
}
</style>
<script language="javascript" type="text/javascript">
var NavLang=GetNavLang();

if (NavLang == "ZH")
{
var vNoteDeafultRoute = "注意 : Default Route決定封包預設從哪個WAN出去";
var vChangeRoute = "是否確定要更改預設路由？"}
else
{
var vNoteDeafultRoute = "Note : Default Route means the outgoing WAN interface by default.";
var vChangeRoute = "Are you sure you want to change the default gateway ?"
}

var dr="";
var di="";
var dt="";
var routeRuleNumtmp=0;
var routeRuleNum_dsp=0;
var routeRuleNum_br=0;

var DefaultRouteRut="";
var DefaultRoutePPP="";
var IGMPRut="";
var IGMPPPP="";
var TR069Rut="";
var TR069PPP="";
var VoIPRut="";
var VoIPPPP="";
var bindingRut="";
var bindingPPP="";
var bindingtmp;
var Rutnum=0;
var PPPRutnum=0;
var phy_inf_flag=0;
var ppp_flag=0;
var untag_flag=0;

var value="";
var value1="";
var rule_col = 0;

var NodeLength_Rut=0;
var NodeLength_Ppp=0;
var untag_vid=4097;

if (DefaultRouteRut.length>0)
	dr=DefaultRouteRut;
else if(DefaultRoutePPP.length>0)
	dr=DefaultRoutePPP;
else
	dr="";
if (IGMPRut.length>0)
	di=IGMPRut;
else if(IGMPPPP.length>0)
	di=IGMPPPP;
else
	di="";
if (TR069Rut.length>0)
	dt=TR069Rut;
else if (TR069PPP.length>0)
	dt=TR069PPP;
else
	dt="";
if (bindingRut.length>0)
	bindingtmp=bindingRut;
else if (bindingPPP.length>0)
	bindingtmp=bindingPPP;
else
	bindingtmp="";

var dv="";

var au;

var routeRuleNum=0;
var otherRuleNum=parseInt(NodeLength_Rut+NodeLength_Ppp-routeRuleNumtmp);
var ssidNum;
if (fvt_meta_config('wlan_enable') == 1)
	ssidNum = fvt_meta_config('wlan_vap_num');
else
	ssidNum = 0;

var default_bridgeNum = 0;
var bridgeRuleNum=0;
var ruleNum = 0;
var bridge_ruleNum=4;
var maxrule = 8;
var bridge_maxrule=16;

function setDefaultRoute()
{
	if( fvt_meta_config("system_default_route_interface")=="")
		document.getElementById("id_wanMtn_form").GUIWanRoute.checked=true;
}

function active()
{
	if (ruleNum==0)
	{
		warn_reboot1('');
		//alert("Warning: The WAN config is empty, please add one wan rule at least before reboot!");
		return false;
	}
	else
	{
		fvt_form_submit('reboot_form');
		document.getElementById("id_reboot_form").submit();
	}
}

function editEntry(wan_mode,val)
{
	var aa,url,ap,am,ab,av,at,ai;
	//var ar;
	var sb,svt,svi,svp,s8,si,sn,sg,sd1,sd2,sd3,smt,sm;
	var db,dvt,dvi,dvp,d8,dh,dv,dc,dmt,dm;
	var pb,pvt,pvi,pvb,pu,pp,pac,ps,pi,pc,pd,pa,pmt,pm,ppa;
	var bvi,bvb,bup,bo,bet,bsm,bsmm,bdm,bdmm,bsi,bsim,bdi,bdim,bipp,bsp,bdp;
	var bten,btid,btpb;
	au = 2;
	aa = val;
	if(wan_mode == 0) //route
	{
		am = document.getElementById("id_hidden_mode"+val).value;
		//av = document.getElementById("id_hidden_service_voip"+val).value;
		//at = document.getElementById("id_hidden_service_cwmp"+val).value;
		//ai = document.getElementById("id_hidden_service_igmp"+val).value;
		//ab = document.getElementById("id_hidden_bind_type"+val).value;
		an = document.getElementById("id_hidden_nat"+val).value;
		aw = document.getElementById("id_hidden_wan"+val).value;
		if (am == 0)
		{
			svi = document.getElementById("id_hidden_static_vlan_id"+val).value;
			svp = document.getElementById("id_hidden_static_vlan_pbit"+val).value;
			s8 = document.getElementById("id_hidden_static_8021x"+val).value;
			si = document.getElementById("id_hidden_static_ip"+val).value;
			sn = document.getElementById("id_hidden_static_netmask"+val).value;
			sg = document.getElementById("id_hidden_static_gateway"+val).value;
			sd1 = document.getElementById("id_hidden_static_dns1"+val).value;
			sd2 = document.getElementById("id_hidden_static_dns2"+val).value;
			smt = document.getElementById("id_hidden_static_mtu_type"+val).value;
			sm = document.getElementById("id_hidden_static_mtu"+val).value;

			url = getlink_static_edit("wan_route_static",sb,svt,svi,svp,s8,si,sn,sg,sd1,sd2,sd3,smt,sm,au,aa,ab,an,aw);
		}
		else if (am == 1)
		{
			dvi = document.getElementById("id_hidden_dhcp_vlan_id"+val).value;
			dvp = document.getElementById("id_hidden_dhcp_vlan_pbit"+val).value;
			d8 = document.getElementById("id_hidden_dhcp_8021x"+val).value;
			dh = document.getElementById("id_hidden_dhcp_hostname"+val).value;
			do60en = document.getElementById("id_hidden_dhcp_op60_en"+val).value;
			do60vid = document.getElementById("id_hidden_dhcp_vid"+val).value;
			do61en = document.getElementById("id_hidden_dhcp_op61_en"+val).value;
			do61mac = document.getElementById("id_hidden_dhcp_op61_mac"+val).value;
			do61iaid = document.getElementById("id_hidden_dhcp_op61_iaid"+val).value;
			do61duid = document.getElementById("id_hidden_dhcp_op61_duid"+val).value;
			do125en = document.getElementById("id_hidden_dhcp_op125_en"+val).value;
			do125enum = document.getElementById("id_hidden_dhcp_op125_enterprise_num"+val).value;
			do125oui = document.getElementById("id_hidden_dhcp_op125_oui"+val).value;
			do125pdc = document.getElementById("id_hidden_dhcp_op125_product_class"+val).value;
			do125mn = document.getElementById("id_hidden_dhcp_op125_model_name"+val).value;
			do125snum = document.getElementById("id_hidden_dhcp_op125_serial_num"+val).value;
			dmt = document.getElementById("id_hidden_dhcp_mtu_type"+val).value;
			dm = document.getElementById("id_hidden_dhcp_mtu"+val).value;

			url = getlink_dhcp_edit("wan_route_dhcp",db,dvt,dvi,dvp,d8,dh,do60en,do60vid,do61en,do61mac,do61iaid,do61duid,do125en,do125enum,do125oui,do125pdc,do125mn,do125snum,dmt,dm,au,aa,ab,an,aw);
		}
		else if (am == 2)
		{
			pvi = document.getElementById("id_hidden_pppoe_vlan_id"+val).value;
			pvb = document.getElementById("id_hidden_pppoe_vlan_pbit"+val).value;
			pu = document.getElementById("id_hidden_pppoe_username"+val).value;
			pp = document.getElementById("id_hidden_pppoe_password"+val).value;
			pac = document.getElementById("id_hidden_pppoe_access"+val).value;
			ps = document.getElementById("id_hidden_pppoe_service"+val).value;
			pi = document.getElementById("id_hidden_pppoe_ipversion"+val).value;
			pc = document.getElementById("id_hidden_pppoe_connecttype"+val).value;
			pd = document.getElementById("id_hidden_pppoe_maxidletime"+val).value;
			pa = document.getElementById("id_hidden_pppoe_authtype"+val).value;
			pmt = document.getElementById("id_hidden_pppoe_mtu_type"+val).value;
			pm = document.getElementById("id_hidden_pppoe_mtu"+val).value;
			ppa = document.getElementById("id_hidden_pppoe_passthrough"+val).value;

			url = getlink_pppoe_edit("wan_route_pppoe",pb,pvt,pvi,pvb,pu,pp,pac,ps,pi,pc,pd,pa,pmt,pm,au,aa,ab,ppa,an,aw);
		}
	}
	else if(wan_mode == 1) //bridge
	{
		bvi = document.getElementById("id_hidden_bridge_vlan_id"+val).value;
		bvb = document.getElementById("id_hidden_bridge_vlan_pbit"+val).value;
		bup = document.getElementById("id_hidden_bridge_uniport"+val).value;
		if (bup=="?") bup = "%3F";
		bo = document.getElementById("id_hidden_bridge_order"+val).value;
		bet = document.getElementById("id_hidden_bridge_ethertype"+val).value;
		bsm = document.getElementById("id_hidden_bridge_smac"+val).value;
		bsmm = document.getElementById("id_hidden_bridge_smac_mask"+val).value;
		bdm = document.getElementById("id_hidden_bridge_dmac"+val).value;
		bdmm = document.getElementById("id_hidden_bridge_dmac_mask"+val).value;
		bsi = document.getElementById("id_hidden_bridge_sip"+val).value;
		bsim = document.getElementById("id_hidden_bridge_sipmask"+val).value;
		bdi = document.getElementById("id_hidden_bridge_dip"+val).value;
		bdim = document.getElementById("id_hidden_bridge_dipmask"+val).value;
		bipp = document.getElementById("id_hidden_bridge_ip_proto"+val).value;
		bsp = document.getElementById("id_hidden_bridge_sport"+val).value;
		bdp = document.getElementById("id_hidden_bridge_dport"+val).value;
		bten = document.getElementById("id_hidden_bridge_tagen"+val).value;
		btid = document.getElementById("id_hidden_bridge_tagid"+val).value;
		btpb = document.getElementById("id_hidden_bridge_tagpb"+val).value;

		url = getlink_bridge_edit("wan_route_bridge",bvi,bvb,bup,bo,bet,bsm,bsmm,bdm,bdmm,bsi,bsim,bdi,bdim,bipp,bsp,bdp,bten,btid,btpb,au,aa);
	}

	window.location.href = url;
}

function deleteEntry(wan_mode,val)
{
	if(confirm("Are you sure you want to delete?"))
	{
		if(wan_mode==0) // Router
		{
			document.getElementById("id_delete_item").value=val;
			fvt_form_submit('wanTbl_form');
			document.getElementById("id_wanTbl_form").submit();
		}
		else if(wan_mode==1) //Bridge
		{
			document.getElementById("id_delete_item").value=val;
			fvt_form_submit('bridgeTbl_form');
			document.getElementById("id_bridgeTbl_form").submit();
		}
	}
}

function deleteAll()
{
	if(confirm("Are you sure you want to delete all WAN rule?"))
	{
		document.getElementById("id_delete_item").value="99";
		document.getElementById('id_wait_progress').style.display="";
		fvt_form_submit('wanTbl_form');
		document.wanTbl_form.action="wwwctrl.cgi?action=del_allwan";
		document.getElementById('id_wanTbl_form').submit();
	}
}

function checkName(a)
{
	if (!isBlank(a))
	{
		for(var i=0;i<a.length;i++)
		{
			c=a.charAt(i);
			if((c!='_')&&(c!='-')&&(c!='.')&&(c!='&')&&(c!='/')&&(c!='=')&&(c!='~')&&(c!='@')&&(c!='?')&&(!((c>='a')&&(c<='z')))&&(!((c>='A')&&(c<='Z')))&&(!((c>='0')&&(c<='9'))))
			{
				return c;
			}
		}
	}
	return "OK";
}

function disableAllSrv()
{
	if (document.getElementById("id_wanMtn_form").GUIWanMode.selectedIndex==4)
	{
		document.getElementById("id_wanMtn_form").GUIWanTR069.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanIGMP.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanRoute.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanTR069.checked=false;
		document.getElementById("id_wanMtn_form").GUIWanIGMP.checked=false;
		document.getElementById("id_wanMtn_form").GUIWanRoute.checked=false;
	}
}

function GetUsedPortBased()
{
	var count=0;
	var binding="";
	var bindingalltmp="";
	var bindingall="";
	var i;

	bindingall=Str_delMulti(bindingalltmp,";");

	for (i=1;i<=4;i++)
	{
		if(bindingall.search("P"+i)>=0)
			count=count+1;
	}
	for (i=1;i<=ssidNum;i++)
	{
		if(bindingall.search("W"+i)>=0)
			count=count+1;
	}

	return count;
}

function changeMode()
{
	setDefaultRoute();
	disableAllSrv();
}

function checkWanMode()
{
	var count=GetUsedPortBased();
	var mode=parseInt("0");
	var r_macbased=parseInt("0");
	var br_num=0;
	//var wr_num=ruleNum;
	var wr_num=0;
	for(emptruleNum=0; emptruleNum < maxrule; emptruleNum++)
	{
		var wanname = fvt_meta_config("wan"+emptruleNum+"_if_name");
		if (wanname == '') continue;
		else wr_num=wr_num+1;
	}

	var total=parseInt(ssidNum) + 4;

		document.getElementById("id_wanMtn_form").GUIWanIGMP.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanRoute.disabled=true;


		if (wr_num>=maxrule && bridge_ruleNum<bridge_maxrule)
		{
			document.getElementById("id_wanMtn_form").nosave_addBtn.disabled=false;
			document.wanMtn_form.GUIWanMode.options[0].disabled=true;
			document.wanMtn_form.GUIWanMode.options[1].disabled=true;
			document.wanMtn_form.GUIWanMode.options[2].disabled=true;
			document.wanMtn_form.GUIWanMode.options[3].disabled=false;
			document.wanMtn_form.GUIWanMode.options[3].selected=true;
		}else if(wr_num<maxrule && bridge_ruleNum>=bridge_maxrule)
		{
			document.getElementById("id_wanMtn_form").nosave_addBtn.disabled=false;
			document.wanMtn_form.GUIWanMode.options[0].disabled=false;
			document.wanMtn_form.GUIWanMode.options[1].disabled=false;
			document.wanMtn_form.GUIWanMode.options[2].disabled=false;
			document.wanMtn_form.GUIWanMode.options[3].disabled=true;
		}else if(wr_num>=maxrule && bridge_ruleNum>=bridge_maxrule)
		{
			document.getElementById("id_wanMtn_form").nosave_addBtn.disabled=true;
			document.wanMtn_form.GUIWanMode.options[0].disabled=true;
			document.wanMtn_form.GUIWanMode.options[1].disabled=true;
			document.wanMtn_form.GUIWanMode.options[2].disabled=true;
			document.wanMtn_form.GUIWanMode.options[3].disabled=true;

		}
		if (document.getElementById("id_wanMtn_form").GUIWanMode.selectedIndex!=3)
			{
			if (dt!="")
				document.getElementById("id_wanMtn_form").nosave_addBtn.disabled=true;
			}
}

function checkEnable()
{
	var option_name = new Array ("id_bindport","id_bindmac","id_nobind");
	var Obj;
	for (i=0;i<3;i++)
	{
		Obj=document.getElementById(option_name[i]);
		if(Obj.checked==true && Obj.disabled==true)
			Obj.checked=false;
	}
	for (i=0;i<3;i++)
	{
		Obj=document.getElementById(option_name[i]);
		if (Obj.disabled!=true)
		{
			Obj.checked=true;
			break;
		}
	}
}

function init()
{
	changeMode();
}

function setBridgeMode()
{
	var count=GetUsedPortBased();
	if (document.getElementById("id_wanMtn_form").GUIWanMode.selectedIndex==3)
	{
		document.getElementById("id_wanMtn_form").id_GUIWanName.value="";
		document.getElementById("id_wanMtn_form").id_GUIWanName.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanTR069.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanIGMP.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanRoute.disabled=true;
		document.getElementById("id_wanMtn_form").GUIWanTR069.checked=false;
		document.getElementById("id_wanMtn_form").GUIWanIGMP.checked=false;
		document.getElementById("id_wanMtn_form").GUIWanRoute.checked=false;
	}
	else
	{
		document.getElementById("id_wanMtn_form").id_GUIWanName.disabled=false;
		changeMode();
	}
}

function changeSetting(val)
{
	var editEntry=document.getElementById("id_wanTbl_form").nosave_editEntry_Name.value;
	var i;
	fvt_paramlist_clear();

	if (editEntry == "DefaultRouteEnabled")
	{
		fvt_paramlist_cat_str("system_default_route_interface", ("dev_wan"+val+"_interface") );
	}
	else if (editEntry == "WanEnabled")
	{
		fvt_paramlist_cat_str("wan"+val+"_enable", document.getElementById("id_WanEnable"+val).value);
	}
	else if (editEntry == "IGMPEnabled")
	{
		for (i=0;i<maxrule;i++)
		{
			fvt_paramlist_cat_str("wan"+i+"_service_igmp", "0");
		}
		fvt_paramlist_cat_str("wan"+val+"_service_igmp", document.getElementById("id_WanIGMP"+val).value);
	}
	else if (editEntry == "TR069Enabled")
	{
		for (i=0;i<maxrule;i++)
		{
			fvt_paramlist_cat_str("wan"+i+"_service_cwmp", "0");
		}
		fvt_paramlist_cat_str("wan"+val+"_service_cwmp", document.getElementById("id_WanTR069"+val).value);
	}

	fvt_paramlist_presubmit('wanTbl_form');
	document.getElementById("id_wanTbl_form").submit();
}

// load 5vt env system_default_route_interface to object WanDefaultRoute
function set_default_route_button()
{
	var i=0;
	for(i=0; i<ruleNum; i++)
	{
		if( fvt_meta_config("system_default_route_interface") == ("dev_wan"+i+"_interface") )
		{
			document.getElementById('id_WanDefaultRoute'+i).checked = true;
		} else {
			document.getElementById('id_WanDefaultRoute'+i).checked = false;
		}
	}
}

function confirm_change_def_route(val)
{
	 if (confirm( vChangeRoute ))
	 {
		// update object WanDefaultRoute with new default route interface val
		defaultrouteSetting(val);
		// submit the val to web server
		changeSetting(val);
	 }
	 else
	 {
		// restore object WanDefaultRoute
		set_default_route_button();
	 }
}

// the string of "0"..."7"
function defaultrouteSetting(val)
{
	var i;
	for (i=0;i<ruleNum;i++)
	{
		if (parseInt(val, 10) == i)
			if (document.getElementById("id_WanDefaultRoute"+i))
				document.getElementById("id_WanDefaultRoute"+i).value=1;
		else
			if (document.getElementById("id_WanDefaultRoute"+i))
				document.getElementById("id_WanDefaultRoute"+i).value=0;
	}
	document.getElementById("id_wanTbl_form").nosave_editEntry_Name.value="DefaultRouteEnabled";
}

function releaseIP(wan_index)
{
	var key = "kv_dhcp_renew"+wan_index;
	fvt_paramlist_clear();
	fvt_paramlist_cat_str(key, '1');
	fvt_paramlist_presubmit('wanTbl_form');
	document.getElementById("id_wanTbl_form").submit();
}

function reconnect(wan_index)
{
	var key = "kv_pppoe_reconnect"+wan_index;
	fvt_paramlist_clear();
	fvt_paramlist_cat_str(key, '1');
	fvt_paramlist_presubmit('wanTbl_form');
	document.getElementById("id_wanTbl_form").submit();
}

function igmpSetting(val)
{
	var i;
	var igmp_value = fvt_meta_config("wan"+val+"_service_igmp");

	for (i=0;i<ruleNum;i++)
	{
		document.getElementById("id_WanIGMP"+i).value=0;
	}
	if (igmp_value == 0)
		document.getElementById("id_WanIGMP"+val).value=1;
	else if (igmp_value == 1)
		document.getElementById("id_WanIGMP"+val).value=0;
	document.getElementById("id_wanTbl_form").nosave_editEntry_Name.value="IGMPEnabled";
}

function tr069Setting(val)
{
	var i;
	var cwmp_value = fvt_meta_config("wan"+val+"_service_cwmp");

	for (i=0;i<ruleNum;i++)
	{
		document.getElementById("id_WanTR069"+i).value=0;
	}
	if (cwmp_value == 0)
		document.getElementById("id_WanTR069"+val).value=1;
	else if (cwmp_value == 1)
		document.getElementById("id_WanTR069"+val).value=0;
	document.getElementById("id_wanTbl_form").nosave_editEntry_Name.value="TR069Enabled";
}

function next()
{
	var aa,aq,ae,am,av,at,ai,ar,url;
	var item,syb,i,obj;
	au = 1;
	//aa = ruleNum;
	for(emptruleNum=0; emptruleNum < maxrule; emptruleNum++)
		{
			var wanname = fvt_meta_config("wan"+emptruleNum+"_if_name");
			if (wanname == '')
			{
				aa = emptruleNum;
				break;
			}
			else
			{
				continue;
			}
		}
	ae = document.getElementById("id_wanMtn_form").GUIWanMode.selectedIndex;
	aq = document.getElementById("id_wanMtn_form").GUIWanName.value;
	if (aq.length==0 && ae!=3) //Bridge ignore check Wan name
	{
		item="Interface Name";
		warn_not_empty(item);
	//	alert(item+" can't be empty.");
		return false;
	}
	if ((syb=checkName(aq))!="OK")
	{
		item="Interface Name";
		warn_CWMP_checkSyb(item,syb)
		// alert(item + " can't include special symbol ' " + syb + " '.");
		return false;
	}
	//for (i=1;i<=ruleNum;i++)
	for (i=1;i<=emptruleNum;i++)
	{
		obj = document.getElementById("id_hidden_app" + (i-1)).value;
		if (obj==aq)
		{
			item="Interface Name";
			warn_ssid_cant_same2(item,"rule",i);
			//alert(item + " can't be the same as Rule " + i + ".");
			return false;
		}
	}

	at = (document.getElementById("id_wanMtn_form").GUIWanTR069.checked)?"1":"0";
	ai = (document.getElementById("id_wanMtn_form").GUIWanIGMP.checked)?"1":"0";
	ar = (document.getElementById("id_wanMtn_form").GUIWanRoute.checked)?"1":"0";
	if (ae==5)
		ae++;
	if (ae == 0)
		url = getlink_add("wan_route_static",aq,ae,am,av,at,ai,ar,au,aa);
	else if (ae == 1)
		url = getlink_add("wan_route_dhcp",aq,ae,am,av,at,ai,ar,au,aa);
	else if (ae == 2)
		url = getlink_add("wan_route_pppoe",aq,ae,am,av,at,ai,ar,au,aa);
	else if (ae == 3)
	{
		aa = bridge_ruleNum;
		//url = getlink_add("wan_route_bridge",aq,ae,am,av,at,ai,ar,au,aa);
		url = "wwwctrl.cgi?action=wan_bridge_add";
	}
	window.location.href = url;
}

function fvt_form_init(form_name)
{
	if (form_name=='wanMtn_form' || form_name=='*') {
		fvt_form_obj_set("wanMtn_form", "GUIWanRoute", fvt_meta_config(''));
	} else if (form_name=='wanTbl_form' || form_name=='*') {
		for(ruleNum=(maxrule-1); ruleNum >= 0; ruleNum--)
		{
			var wanname = fvt_meta_config("wan"+ruleNum+"_if_name");
			if (wanname == '')
			{
				continue;
			}
			else
			{
				ruleNum = ruleNum+1
				routeRuleNum = ruleNum;
				return;
			}
		}

	} else if (form_name=='bridgeTbl_form' || form_name=='*') {
		var index = 0;
		var bridgeName="";
		var i =0;
		for(bridge_ruleNum=default_bridgeNum; bridge_ruleNum < bridge_maxrule; bridge_ruleNum++)
		{
			bridgeName = fvt_meta_config("l2_proto_vlan"+bridge_ruleNum+"_name");
			if (bridgeName == '')
			{
				return;
			}
			else
			{
				bridgeRuleNum = bridge_ruleNum;
			}
		}
	} else if (form_name=='reboot_form' || form_name=='*') {
	}
	checkWanMode();
}

function valueMatch(s1, s2, match_return)
{
	if(s1 == s2)
		return match_return;
	else
		return "";
}

function get_wan_status(ip, mode, index)
{
	var dhcp_key = "kv_dhclient_wan" + index;
	var pppoe_key ="kv_pppoe_start";

	if(mode=='1')//DHCP
	{
		if(fvt_meta_config(dhcp_key)=="")
			return "Unconnect";
	}
	else if(mode=='2')//PPPoE
	{
		if(fvt_meta_config(pppoe_key)=="")
			return "Unconnect";
	}

	if( ip != "")
	{
		var res = ip.match(/^169.254|0.0.0.0/g);
		if( res != null)
		{
			return "connecting";
		}
		return "connected";
	}

	return "connecting";
}

//index: 0~6
function get_portName(index)
{
	var portName=["ETH1", "ETH2", "ETH3", "ETH4", "ETH5", "GPON", "WIFI"];

	if( (index+1) > portName.length)
		return "?";
	else
		return portName[index];
}

function list_bridge_interface2()
{

	var Brgvlan = new Array();

	document.write("<tr id='BrWan_id' style='display: none;'>");
	document.write("<td colspan=1><div><hr class='hr2'></div></td>");
	document.write("<td colspan=2><div class='overview_title2' style='text-align: center;'>Bridge Wan</div></td>");
	document.write("<td colspan=1><div><hr class='hr2'></div></td>");
	document.write("</tr>");

	var totalvlan=0;
	for (var i=0;i<bridge_maxrule;i++)
	{
		var vlanid;
		vlanid=fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark");
		if (vlanid!="")
		{
			var matchvlan = Brgvlan.indexOf(vlanid);
			if (matchvlan < 0)
			{
			Brgvlan[totalvlan] = vlanid;
			//alert(totalvlan+"="+Brgvlan[totalvlan]);
			totalvlan++;
			}
		}
	}

	for (var i=0;i<Brgvlan.length;i++)
	{
	rule_col = rule_col+1;
	if(rule_col%2 == 0)
		document.write("<tr class='color_rowh trwan'>");
	else
		document.write("<tr class='color_rown trwan'>");

	var Show_Brg = "Untag";
	if (Brgvlan[i]!=untag_vid) Show_Brg = Brgvlan[i];

	document.write("<td><div class='Wname'>Br-"+Show_Brg+"</div></td>");
	document.write("<td>Bridge<div class='vidstyle'>"+Show_Brg+"</div></td>");
	document.write("<td class='tdcenter'>-</td>");
	document.write("<td class='tdcenter'>-</td>");
	document.write("<td class='tdcenter'>-</td>");
	document.write("<td class='tdcenter'>-</td>");
	document.write("<td class='tdcenter'>-</td>");
	document.write("<td class='tdcenter'>-</td>");
	var list_br = 0;
	for (var j=0;j<bridge_maxrule;j++)
	{
		var vlan_en;
		var vlan_id;
		vlan_en=fvt_meta_config("l2_proto_vlan"+j+"_enable");
		vlan_id=fvt_meta_config("l2_proto_vlan"+j+"_vlan_mark");
		if (vlan_en=="1" && vlan_id == Brgvlan[i]) list_br = 1;
	}
	if (list_br == 1) document.write("<td class='tdcenter'>enable</td>");
	else document.write("<td class='tdcenter'>disable</td>");

	document.write("<td class='width_wanpon_update' align='right'>");
	document.write("<table><tr>");
	document.write("<td><input class='width_wanpon_edit edit1' type='button' name='nosave_edit' value='Edit' onclick='editBrEntry("+Brgvlan[i]+");' ></td>");
	document.write("<td><input type='button' class='width_wanpon_del warning2' name='nosave_delete' value='Delete' onclick='deleteBrEntry("+Brgvlan[i]+");' ></td>");
	document.write("</tr></table>");
	document.write("</td></tr>");
	}
}

function deleteBrEntry(VID)
{
	var Show_Brg = "Untag";
	if ( VID != untag_vid ) Show_Brg=VID;

	//if(confirm("Are you sure you want to delete interface Br-"+ VID +"?"))
	if(confirm("Are you sure you want to delete interface Br-"+ Show_Brg +"?"))
	{
		var keep_vlanid = new Array();
		fvt_paramlist_clear();
		for (var i=0;i<bridge_maxrule;i++)
		{
			keep_vlanid[i]=fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark");
		}
		var step = 0;
		var newbr = 0;
		for (var i=0;i<bridge_maxrule;i++)
		{
			if (keep_vlanid[i]!=VID)
			{
				Move_Br(i,newbr);
				newbr++;
				//deleteoneBr( (i-step), (step+1));
				//step++;
			}
		}

		for (var i=newbr;i<bridge_maxrule;i++)
		{
			Clean_Br(i);
		}
		fvt_paramlist_presubmit("wanTbl_form");
		document.getElementById("id_wanTbl_form").submit();
	}
}

//function deleteoneBr(Del_Br,step)
//{
//	for (var k=Del_Br;k<bridge_maxrule;k++)
//	{
//	var Next_Br = k + step;
//	Nexr_Br_name = fvt_meta_config("l2_proto_vlan"+Next_Br+"_name")
//	if ( Nexr_Br_name != "")
//		{
//		Move_Br(Next_Br,k)
//		}
//	else
//		{
//		Clean_Br(k);
//		}
//	}
//}

function Clean_Br(Br)
{
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_enable", "0");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_order", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_name", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_vlan_mark", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_pbit_mark", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_uniport", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_ethertype", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_smac", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_smac_mask", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dmac", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dmac_mask", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_sip", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_sipmask", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dip", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dipmask", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_ip_proto", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_sport", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_sport_max", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dport", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_dport_max", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_vlantag_enable", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_vlantag_id", "");
	fvt_paramlist_cat_str("l2_proto_vlan"+Br+"_vlantag_pbit", "");
}

function Move_Br(source,target)
{
	Move_metakey(source,target,"_enable");
	Move_metakey(source,target,"_order");
	Move_metakey(source,target,"_name");
	Move_metakey(source,target,"_vlan_mark");
	Move_metakey(source,target,"_pbit_mark");
	Move_metakey(source,target,"_uniport");
	Move_metakey(source,target,"_ethertype");
	Move_metakey(source,target,"_smac");
	Move_metakey(source,target,"_smac_mask");
	Move_metakey(source,target,"_dmac");
	Move_metakey(source,target,"_dmac_mask");
	Move_metakey(source,target,"_sip");
	Move_metakey(source,target,"_sipmask");
	Move_metakey(source,target,"_dip");
	Move_metakey(source,target,"_dipmask");
	Move_metakey(source,target,"_ip_proto");
	Move_metakey(source,target,"_sport");
	Move_metakey(source,target,"_sport_max");
	Move_metakey(source,target,"_dport");
	Move_metakey(source,target,"_dport_max");
	Move_metakey(source,target,"_vlantag_enable");
	Move_metakey(source,target,"_vlantag_id");
	Move_metakey(source,target,"_vlantag_pbit");
}

function Move_metakey(source,target,metakey)
{
	var pre_metakey = "l2_proto_vlan";
	fvt_paramlist_cat_str( pre_metakey+target+metakey, fvt_meta_config(pre_metakey+source+metakey) );
}

function editBrEntry(VID)
{
//alert ("editBrEntry "+ VID);
window.location.href="wwwctrl.cgi?action=wan_bridge_edit&vid="+VID;
}

function list_bridge_interface()
{
	fvt_form_init('bridgeTbl_form');

	var Brgvlan = new Array();
	var totalvlan=0;
	for (var i=0;i<bridge_maxrule;i++)
	{
		var vlanid;
		vlanid=fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark");
		if (vlanid!="")
		{
			var matchvlan = Brgvlan.indexOf(vlanid);
			if (matchvlan < 0)
			{
			Brgvlan[totalvlan] = vlanid;
			//alert(totalvlan+"="+Brgvlan[totalvlan]);
			totalvlan++;
			}
		}
	}

	for (var i=0;i<Brgvlan.length;i++)
	{
	document.write("<td>"+Brgvlan[i]+"</td>");
	}

	for (var i=0;i<default_bridgeNum;i++)
	{
		if(i%2 == 0)
			document.write("<tr class='color_rowh'>");
		else
			document.write("<tr class='color_rown'>");

		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark")+"</td>");
		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_pbit_mark")+"</td>");
	}

	for (var i=default_bridgeNum;i<bridge_ruleNum;i++)
	{
		if(i%2 == 0)
			document.write("<tr class='color_rowh'>");
		else
			document.write("<tr class='color_rown'>");

		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_name")+"</td>");
		var uni = fvt_meta_config("l2_proto_vlan"+i+"_uniport");
		if(uni=="*")
			document.write("<td>ALL</td>");
		else if(uni=="")
			document.write("<td>&nbsp;</td>");
		else if(uni=="?")
			document.write("<td>ETH1-4</td>");
		else{
			uni=parseInt(uni);
			document.write("<td>"+get_portName(uni)+"</td>");
		}

		var smac = fvt_meta_config("l2_proto_vlan"+i+"_smac");
		var smac_mask = fvt_meta_config("l2_proto_vlan"+i+"_smac_mask");
		var dmac = fvt_meta_config("l2_proto_vlan"+i+"_dmac");
		var dmac_mask = fvt_meta_config("l2_proto_vlan"+i+"_dmac_mask");
		if(dmac!=""){
			document.write("<td><table><tr><td>"+dmac+"</td></tr>");
			document.write("<tr><td>/"+dmac_mask+"</td></tr></table></td>");
		}else
			document.write("<td></td>");

		if(smac!=""){
			document.write("<td><table><tr><td>"+smac+"</td></tr>");
			document.write("<tr><td>/"+smac_mask+"</td></tr></table></td>");
		}else
			document.write("<td></td>");

		var vtag_en = fvt_meta_config("l2_proto_vlan"+i+"_vlantag_enable");
		var vtag_id = fvt_meta_config("l2_proto_vlan"+i+"_vlantag_id");
		var vtag_pb = fvt_meta_config("l2_proto_vlan"+i+"_vlantag_pbit");
		if(vtag_en=="1")
		{
			document.write("<td><table><tr><td>"+vtag_id+"</td></tr>");
			document.write("<tr><td>/"+vtag_pb+"</td></tr></table></td>");
		}else
		{
			document.write("<td></td>");
		}

		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_ethertype")+"</td>");

		if(fvt_meta_config("l2_proto_vlan"+i+"_ip_proto")=="6")
			document.write("<td align='center'>TCP</td>");
		else if(fvt_meta_config("l2_proto_vlan"+i+"_ip_proto")=="17")
			document.write("<td align='center'>UDP</td>");
		else
		document.write("<td></td>");

		if(fvt_meta_config("l2_proto_vlan"+i+"_dip")!=""){
			document.write("<td><table><tr><td>"+fvt_meta_config("l2_proto_vlan"+i+"_dip")+"</td></tr>");
			document.write("<tr><td>/"+fvt_meta_config("l2_proto_vlan"+i+"_dipmask")+"</td></tr></table></td>");
		}else
			document.write("<td></td>");

		if(fvt_meta_config("l2_proto_vlan"+i+"_sip")!=""){
			document.write("<td><table><tr><td>"+fvt_meta_config("l2_proto_vlan"+i+"_sip")+"</td></tr>");
			document.write("<tr><td>/"+fvt_meta_config("l2_proto_vlan"+i+"_sipmask")+"</td></tr></table></td>");
		}else
			document.write("<td></td>");

		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_sport")+"</td>");
		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_dport")+"</td>");

		if (fvt_meta_config("l2_proto_vlan"+i+"_enable") == 1)
			document.write("<td>en</td>");
		else
			document.write("<td>dis</td>");

		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark")+"</td>");
		document.write("<td>"+fvt_meta_config("l2_proto_vlan"+i+"_pbit_mark")+"</td>");

		document.write("<td class='width_wanpon_update' align='right'><table><tr><td><input class='width_wanpon_edit' type='button' name='nosave_edit' value='Edit' onclick='editEntry(\"1\",\""+i+"\");' ></td>");
		document.write("<td><input type='button' class='width_wanpon_del' name='nosave_delete' value='Delete' onclick='deleteEntry(\"1\",\""+i+"\");' ></td></tr></table></td>");
	}
	for (var i=0;i<bridge_ruleNum;i++)
	{
		document.write("<td><input type='hidden' id='id_hidden_bridge_enable"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_name"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_name")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_vlan_id"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_vlan_mark")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_vlan_pbit"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_pbit_mark")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_uniport"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_uniport")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_order"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_order")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_ethertype"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_ethertype")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_smac"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_smac")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_smac_mask"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_smac_mask")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_dmac"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_dmac")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_dmac_mask"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_dmac_mask")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_sip"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_sip")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_sipmask"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_sipmask")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_dip"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_dip")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_dipmask"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_dipmask")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_ip_proto"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_ip_proto")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_sport"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_sport")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_dport"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_dport")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_tagen"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_vlantag_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_tagid"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_vlantag_id")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bridge_tagpb"+i+"' value='"+fvt_meta_config("l2_proto_vlan"+i+"_vlantag_pbit")+"'></td>");

		document.write("</tr>");
	}
}

function list_wan_interface()
{

	fvt_form_init('wanTbl_form');
	if (routeRuleNum >0)
	{
		document.write("<tr class='color_rowh'>");
		if(ruleNum >= maxrule)
		{
			var haveEmptrule = 0;
			for(emptruleNum=0; emptruleNum < maxrule; emptruleNum++)
			{
				var wanname = fvt_meta_config("wan"+emptruleNum+"_if_name");
				if (wanname == '')
				{
					haveEmptrule = 1;
					break;
				}
				else
				{
					continue;
				}
			}
			if (haveEmptrule == 0)
			{
			document.write("<td colspan='9' style='color:#980000;font-weight:bold;'>Your routes rule is already full, can not add other groups.</td>");
			}
			else
			{
			document.write("<td colspan='9' style='color:#980000;font-weight:bold;'></td>");
			}
		}else {
			document.write("<td class=''>&nbsp;</td>");
			document.write("<td class=''>&nbsp;</td>");
			document.write("<td class=''>&nbsp;</td>");
			//document.write("<td class=''>&nbsp;</td>");
			document.write("<td style='display:none' class=''>&nbsp;</td>");
			document.write("<td style='display:none' class=''>&nbsp;</td>");
		}
		var binding="";
		var bindingP="";
		var bindingW="";
		bindingtmp=fvt_meta_config("wan"+routeRuleNum+"_bind_type");
		if (bindingtmp.indexOf("P")>=0)
			bindingP=bindingtmp.substring(0,bindingtmp.lastIndexOf("P")+1+1);
		if (bindingtmp.indexOf("W")>=0)
			bindingW=bindingtmp.substring(bindingtmp.indexOf("W"),bindingtmp.lastIndexOf("W")+1+1);
		bindingP=bindingP.replace(/;/g,",");
		bindingP=bindingP.replace(/P/g,"");
		bindingW=bindingW.replace(/;/g,",");
		bindingW=bindingW.replace(/W/g,"");
		if (bindingP.length>0 && bindingW.length>0)
			binding="LAN("+bindingP+")WLAN("+bindingW+")";
		else if (bindingP.length>0 && bindingW.length<=0)
			binding="LAN("+bindingP+")";
		else if (bindingP.length<=0 && bindingW.length>0)
			binding="WLAN("+bindingW+")";
		if (bindingP.length<=0 && bindingW.length<=0)
			binding="";
		if (binding.length >0)
			document.write("<td>"+binding+"</td>");
		else
			document.write("<td>&nbsp;</td>");

		//document.write("<td colspan='9' class='width_wanpon_update' align='right'> ");
		document.write("<td colspan='7' class='width_wanpon_update' align='right'> ");
		document.write("<input type='button' class='width_wanpon_delall warning1' name='nosave_deleteAll' value='&nbsp;Delete All WAN&nbsp;' onclick='deleteAll();'>");
		document.write("</td>");
		document.write("</tr>");
	}

	var reloadw_flag=0;

	for (var i=0;i<ruleNum;i++)
	{
		if (fvt_meta_config("wan"+i+"_if_name") == '') { continue; }
		rule_col = rule_col+1;
		if(rule_col%2 == 0)
			document.write("<tr class='color_rowh trwan'>");
		else
			document.write("<tr class='color_rown trwan'>");

		var mode=fvt_meta_config("wan"+i+"_ip_assignment");
		document.write("<td><div class='Wname'>"+fvt_meta_config("wan"+i+"_if_name")+"</div></td>");
		var vid_if=fvt_meta_config("dev_wan"+i+"_interface");
		if (vid_if != '')
		{
			var vid = vid_if.split(".");
			if (vid.length == '1')
				vid[1]='';
			else if (vid.length == '3')
				vid[1]=vid[2];
		}
		else
		{
			var vid = new Array();
			vid[0] = '';
			vid[1] = '';
		}
		if (mode == 0)
		{
			document.write("<td>IPoE(Static IP)");
			document.write("<div class='vidstyle'>"+vid[1]+"</div></td>");
		}
		else if (mode == 1)
		{
			document.write("<td>IPoE(DHCP)");
			document.write("<div class='vidstyle'>"+vid[1]+"</div></td>");
		}
		else if (mode == 2)
		{
			document.write("<td>PPPoE");
			document.write("<div class='vidstyle'>"+vid[1]+"</div></td>");
		}

		document.write("<td style='display:none' class='tdcenter'>"+fvt_meta_config("wan"+i+"_pbit")+"</td>");

		var key="kv_info_wan"+i+"_status";
		var connectStatus = fvt_meta_config(key);
		var keyv6="kv_info_wan"+i+"_v6status";
		var connectStatusv6 = fvt_meta_config(keyv6);

		if (mode == 0) //static ip
		{
			document.write("<td class='tdcenter'>"+connectStatus+"</td>");
			document.write("<td>"+
						fvt_meta_config("wan"+i+"_ip")+"/"+
						mask2cidr(fvt_meta_config("wan"+i+"_netmask"))+"<br>"+
						fvt_meta_config("wan"+i+"_gateway")+
						"</td>");
			var Wan_ipv6=fvt_meta_config("wan"+i+"_ipv6_ip");
			document.write("<td class='tdcenter'>"+connectStatusv6+"</td>");
			if (Wan_ipv6!="" )
				{
				document.write("<td>"+
					fvt_meta_config("wan"+i+"_ipv6_ip")+"<br>"+
					fvt_meta_config("wan"+i+"_ipv6_gateway")+
					"</td>");
				}
			else
				{
				document.write("<td></td>");
				}
		}
		else
		{
			if(connectStatus=="Connected")
			{
				document.write("<td class='tdcenter'>"+connectStatus+"</td>");
				document.write("<td>"+
						fvt_meta_config('kv_info_wan'+i+'_ip')+"/"+
						mask2cidr(fvt_meta_config('kv_info_wan'+i+'_netmask'))+"<br>"+
						fvt_meta_config('kv_info_wan'+i+'_gateway')+
						"</td>");
			}else{
				document.write("<td class='tdcenter'>"+connectStatus+"</td>");
				document.write("<td>(null)/(null)");
				document.write("<br>(null)</td>");
			}

			if(connectStatusv6=="Connected")
			{
				var Wan_ipv6=fvt_meta_config('kv_info_wan'+i+'_ipv6G');
				if (Wan_ipv6!="" )
					{
					document.write("<td class='tdcenter'>"+connectStatusv6+"</td>");
					document.write("<td>"+
							fvt_meta_config('kv_info_wan'+i+'_ipv6G')+"<br>"+
							fvt_meta_config('kv_info_wan'+i+'_ipv6gateway')+
							"</td>");
					}
			}else{
				document.write("<td class='tdcenter'>"+connectStatusv6+"</td>");
				document.write("<td>(null)");
				document.write("<br>(null)</td>");
			}
			if((connectStatus=="Connecting") || (connectStatusv6=="Connecting")) reloadw_flag=1;
		}

		var n=i;
		document.write("<td class='tdcenter'>");
		document.write("<input type='radio' id='id_WanDefaultRoute"+n+"' name='WanDefaultRoute' "+valueMatch(fvt_meta_config("system_default_route_interface"), ("dev_wan"+n+"_interface") , 'checked')+" onclick='confirm_change_def_route(\""+n+"\");'>");
		document.write("</td>");
		if(fvt_meta_config("nat"+n+"_enable")==0)
			document.write("<td class='tdcenter'>disable</td>");
		else
			document.write("<td class='tdcenter'>enable</td>");

		document.write("<td style='display:none' class='tdcenter'><input type='radio' id='id_WanIGMP"+n+"' name='WanIGMP' "+valueMatch(fvt_meta_config("wan"+n+"_service_igmp"), '1', 'checked')+" onclick='igmpSetting(\""+n+"\");changeSetting(\""+n+"\");'></td>");

		if(fvt_meta_config("wan"+n+"_enable")==0)
			document.write("<td class='tdcenter'>disable</td>");
		else
			document.write("<td class='tdcenter'>enable</td>");

		if(mode == 1)
		{
			document.write("<td class='width_wanpon_update' align='right'><table><tr><td><input class='width_wanpon_edit' type='button' name='nosave_edit' value='Renew' onclick='releaseIP(\""+i+"\");' ></td>");
			document.write("<td class='width_wanpon_update' align='right'><td><input class='width_wanpon_edit edit1' type='button' name='nosave_edit' value='Edit' onclick='editEntry(\"0\",\""+i+"\");' ></td>");
		}
		else if(mode == 2)
		{
			document.write("<td class='width_wanpon_update' align='right'><table><tr><td><input class='width_wanpon_edit' type='button' name='nosave_edit' value='Reconnect' onclick='reconnect(\""+i+"\");' ></td>");
			document.write("<td class='width_wanpon_update' align='right'><td><input class='width_wanpon_edit edit1' type='button' name='nosave_edit' value='Edit' onclick='editEntry(\"0\",\""+i+"\");' ></td>");
		}
		else
		{
			document.write("<td class='width_wanpon_update' align='right'><table><tr><td><input class='width_wanpon_edit edit1' type='button' name='nosave_edit' value='Edit' onclick='editEntry(\"0\",\""+i+"\");' ></td>");
		}
		document.write("<td><input type='button' class='width_wanpon_del warning2' name='nosave_delete' value='Delete' onclick='deleteEntry(\"0\",\""+i+"\");' ></td></tr></table></td>");

		document.write("<td><input type='hidden' id='id_hidden_app"+i+"' value='"+fvt_meta_config("wan"+i+"_if_name")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_mode"+i+"' value='"+fvt_meta_config("wan"+i+"_ip_assignment")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_bind_type"+i+"' value='"+fvt_meta_config("wan"+i+"_bind_type")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_service_cwmp"+i+"' value='"+fvt_meta_config("wan"+i+"_service_cwmp")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_service_igmp"+i+"' value='"+fvt_meta_config("wan"+i+"_service_igmp")+"'></td>");
		//document.write("<td><input type='hidden' id='id_hidden_service_droute"+i+"' value='"+fvt_meta_config("wan"+i+"_service_droute")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_nat"+i+"' value='"+fvt_meta_config("nat"+i+"_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_wan"+i+"' value='"+fvt_meta_config("wan"+i+"_enable")+"'></td>");

		document.write("<td><input type='hidden' id='id_hidden_static_vlan_id"+i+"' value='"+vid[1]+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_vlan_pbit"+i+"' value='"+fvt_meta_config("wan"+i+"_pbit")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_8021x"+i+"' value='"+fvt_meta_config("wan"+i+"_static_8021x")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_ip"+i+"' value='"+fvt_meta_config("wan"+i+"_ip")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_netmask"+i+"' value='"+fvt_meta_config("wan"+i+"_netmask")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_gateway"+i+"' value='"+fvt_meta_config("wan"+i+"_gateway")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_dns1"+i+"' value='"+fvt_meta_config("wan"+i+"_dns1")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_dns2"+i+"' value='"+fvt_meta_config("wan"+i+"_dns2")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_mtu_type"+i+"' value='"+fvt_meta_config("wan"+i+"_staticip_mtu_select")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_static_mtu"+i+"' value='"+fvt_meta_config("wan"+i+"_staticip_mtu")+"'></td>");
		//document.write("<td><input type='hidden' id='id_hidden_dhcp_bind"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_bind")+"'></td>");
		//document.write("<td><input type='hidden' id='id_hidden_dhcp_vlan_type"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_vlan_type")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_vlan_id"+i+"' value='"+vid[1]+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_vlan_pbit"+i+"' value='"+fvt_meta_config("wan"+i+"_pbit")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_8021x"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_8021x")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_hostname"+i+"' value='"+fvt_meta_config('dhcp0_domain')+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op60_en"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_client_option60_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_vid"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_vendor_class_id")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op61_en"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_client_option61_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op61_mac"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_dhcpv4_opt61_mac")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op61_duid"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_dhcpv4_opt61_duid")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op61_iaid"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_dhcpv4_opt61_iaid")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_en"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_client_option125_enable")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_enterprise_num"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_enterprise_number")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_oui"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_manufacturer_oui")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_product_class"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_product_class")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_model_name"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_model_name")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_op125_serial_num"+i+"' value='"+fvt_meta_config("wan"+i+"_cht_serial_number")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_mtu_type"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_mtu_select")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_dhcp_mtu"+i+"' value='"+fvt_meta_config("wan"+i+"_dhcp_mtu")+"'></td>");
		//document.write("<td><input type='hidden' id='id_hidden_pppoe_bind"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_bind")+"'></td>");
		//document.write("<td><input type='hidden' id='id_hidden_pppoe_vlan_type"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_vlan_type")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_vlan_id"+i+"' value='"+vid[1]+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_vlan_pbit"+i+"' value='"+fvt_meta_config("wan"+i+"_pbit")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_username"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_username")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_password"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_password").replace(/=/g, "%3D")+"'></td>");

		document.write("<td><input type='hidden' id='id_hidden_pppoe_access"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_access")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_service"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_service")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_ipversion"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_ipversion")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_passthrough"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_passthrough")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_connecttype"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_connecttype")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_maxidletime"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_maxidletime")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_authtype"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_authtype")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_mtu_type"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_mtu_select")+"'></td>");
		document.write("<td><input type='hidden' id='id_hidden_pppoe_mtu"+i+"' value='"+fvt_meta_config("wan"+i+"_pppoe_mtu")+"'></td>");

		document.write("</tr>");
	}
	if (reloadw_flag=='1') reloadw();
}

function fvt_form_submit(form_name) {
	fvt_paramlist_clear();
	if (form_name=='wanMtn_form' || form_name=='*') {

	} else if (form_name=='wanTbl_form' || form_name=='*')
		{
		var del_num=document.getElementById("id_delete_item").value;
		if (del_num == 99)	// del all wan interface
			{
			// Delete All L2 Protocal Vlan
			fvt_paramlist_cat_str("kv_reset_AllWan", "1");

	//		fvt_paramlist_cat_str("system_default_route_interface", "");
	//		for (var i=0; i< maxrule; i++)
	//			{
	//				if ( fvt_meta_config("wan"+i+"_if_name") != "" )
	//				{
	//			fvt_paramlist_cat_str("dev_wan"+i+"_interface", "");
	//			fvt_paramlist_cat_str("wan"+i+"_if_name", "");
	//			fvt_paramlist_cat_str("wan"+i+"_ip_assignment", "");
	//			fvt_paramlist_cat_str("wan"+i+"_ipv6_assignment", "");	// for ipv6
	//			//fvt_paramlist_cat_str("wan"+i+"_bind_type", "");
	//			fvt_paramlist_cat_str("wan"+i+"_service_cwmp", "0");
	//			fvt_paramlist_cat_str("nat"+i+"_enable", "0");
	//			fvt_paramlist_cat_str("wan"+i+"_enable", "0");
	//
	//			//fvt_paramlist_cat_str("wan"+i+"_static_bind", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_static_vlan_type", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_static_vlan_id", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
	//			fvt_paramlist_cat_str("wan"+i+"_ip", "0.0.0.0");
	//			fvt_paramlist_cat_str("wan"+i+"_netmask", "255.255.255.0");
	//			fvt_paramlist_cat_str("wan"+i+"_gateway", "0.0.0.0");
	//			fvt_paramlist_cat_str("wan"+i+"_dns1", "");
	//			fvt_paramlist_cat_str("wan"+i+"_dns2", "");
	//			fvt_paramlist_cat_str("wan"+i+"_staticip_mtu_select", "");
	//			fvt_paramlist_cat_str("wan"+i+"_staticip_mtu", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_dhcp_bind", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_dhcp_vlan_type", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_dhcp_vlan_id", "");
	//			////fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
	//			fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option60_enable", "0");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_vendor_class_id", "");
	//			fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option61_enable", "0");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_mac", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_iaid", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_duid", "");
	//			fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option125_enable", "0");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_enterprise_number", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_manufacturer_oui", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_product_class", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_model_name", "");
	//			fvt_paramlist_cat_str("wan"+i+"_cht_serial_number", "");
	//			fvt_paramlist_cat_str("wan"+i+"_dhcp_mtu_select", "");
	//			fvt_paramlist_cat_str("wan"+i+"_dhcp_mtu", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_pppoe_bind", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_pppoe_vlan_type", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_pppoe_vlan_id", "");
	//			////fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_username", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_password", "");
	//			//fvt_paramlist_cat_str("wan"+i+"_pppoe_service", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_passthrough", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_connecttype", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_maxidletime", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_authtype", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_mtu_select", "");
	//			fvt_paramlist_cat_str("wan"+i+"_pppoe_mtu", "");
	//				}
	//			}
			}
			else
			{
				i=del_num;
				fvt_paramlist_cat_str("dev_wan"+i+"_interface", "");
				fvt_paramlist_cat_str("wan"+i+"_if_name", "");
				fvt_paramlist_cat_str("wan"+i+"_ip_assignment", "");
				fvt_paramlist_cat_str("wan"+i+"_ipv6_assignment", "");	// for ipv6
				fvt_paramlist_cat_str("wan"+i+"_service_cwmp", "");
				fvt_paramlist_cat_str("nat"+i+"_enable", "0");
				fvt_paramlist_cat_str("wan"+i+"_enable", "0");
				fvt_paramlist_cat_str("wan"+i+"_ipv6_enable", "0");
				fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
				fvt_paramlist_cat_str("wan"+i+"_ip", "0.0.0.0");
				fvt_paramlist_cat_str("wan"+i+"_netmask", "255.255.255.0");
				fvt_paramlist_cat_str("wan"+i+"_gateway", "0.0.0.0");
				fvt_paramlist_cat_str("wan"+i+"_dns1", "");
				fvt_paramlist_cat_str("wan"+i+"_dns2", "");
				fvt_paramlist_cat_str("wan"+i+"_staticip_mtu_select", "");
				fvt_paramlist_cat_str("wan"+i+"_staticip_mtu", "");
				//fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
				fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option60_enable", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_vendor_class_id", "");
				fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option61_enable", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_mac", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_iaid", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_dhcpv4_opt61_duid", "");
				fvt_paramlist_cat_str("wan"+i+"_dhcp_client_option125_enable", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_enterprise_number", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_manufacturer_oui", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_product_class", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_model_name", "");
				fvt_paramlist_cat_str("wan"+i+"_cht_serial_number", "");
				fvt_paramlist_cat_str("wan"+i+"_dhcp_mtu_select", "");
				fvt_paramlist_cat_str("wan"+i+"_dhcp_mtu", "");
				//fvt_paramlist_cat_str("wan"+i+"_pbit", fvt_meta_config("wan"+i+"_pbit"));
				fvt_paramlist_cat_str("wan"+i+"_pppoe_username", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_password", "");
				//fvt_paramlist_cat_str("wan"+i+"_pppoe_service", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_passthrough", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_connecttype", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_maxidletime", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_authtype", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_mtu_select", "");
				fvt_paramlist_cat_str("wan"+i+"_pppoe_mtu", "");
			}
		}
	else if (form_name=='bridgeTbl_form' || form_name=='*') {
		var del_num=document.getElementById("id_delete_item").value;
		var j=default_bridgeNum;
		for (var i=default_bridgeNum; i< bridge_maxrule; i++)
		{
			if (del_num == 99)
			{
				if ( fvt_meta_config("l2_proto_vlan"+i+"_name") != "" )
					{
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", "0");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", "");
					}
			}
			else if (j < bridge_ruleNum)
			{
				if(i == del_num)
				{
					j++;
					if( del_num == bridge_ruleNum-1 )
					{
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", "0");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", "");
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", "");
					}
					else
					{
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", document.getElementById("id_hidden_bridge_enable"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", document.getElementById("id_hidden_bridge_name"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", document.getElementById("id_hidden_bridge_vlan_id"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", document.getElementById("id_hidden_bridge_vlan_pbit"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", document.getElementById("id_hidden_bridge_uniport"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", document.getElementById("id_hidden_bridge_order"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", document.getElementById("id_hidden_bridge_ethertype"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", document.getElementById("id_hidden_bridge_smac"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", document.getElementById("id_hidden_bridge_smac_mask"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", document.getElementById("id_hidden_bridge_dmac"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", document.getElementById("id_hidden_bridge_dmac_mask"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", document.getElementById("id_hidden_bridge_sip"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", document.getElementById("id_hidden_bridge_sipmask"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", document.getElementById("id_hidden_bridge_dip"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", document.getElementById("id_hidden_bridge_dipmask"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", document.getElementById("id_hidden_bridge_ip_proto"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", document.getElementById("id_hidden_bridge_sport"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", document.getElementById("id_hidden_bridge_dport"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", document.getElementById("id_hidden_bridge_tagen"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", document.getElementById("id_hidden_bridge_tagid"+j).value);
						fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", document.getElementById("id_hidden_bridge_tagpb"+j).value);
					}
				}
				else if(i==(bridge_ruleNum-1))
				{
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", "0");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", "");
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", "");
				}
				else
				{
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", document.getElementById("id_hidden_bridge_enable"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", document.getElementById("id_hidden_bridge_name"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", document.getElementById("id_hidden_bridge_vlan_id"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", document.getElementById("id_hidden_bridge_vlan_pbit"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", document.getElementById("id_hidden_bridge_uniport"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", document.getElementById("id_hidden_bridge_order"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", document.getElementById("id_hidden_bridge_ethertype"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", document.getElementById("id_hidden_bridge_smac"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", document.getElementById("id_hidden_bridge_smac_mask"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", document.getElementById("id_hidden_bridge_dmac"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", document.getElementById("id_hidden_bridge_dmac_mask"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", document.getElementById("id_hidden_bridge_sip"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", document.getElementById("id_hidden_bridge_sipmask"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", document.getElementById("id_hidden_bridge_dip"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", document.getElementById("id_hidden_bridge_dipmask"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", document.getElementById("id_hidden_bridge_ip_proto"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", document.getElementById("id_hidden_bridge_sport"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", document.getElementById("id_hidden_bridge_dport"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", document.getElementById("id_hidden_bridge_tagen"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", document.getElementById("id_hidden_bridge_tagid"+j).value);
					fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", document.getElementById("id_hidden_bridge_tagpb"+j).value);
				}
				j++;
			}
			else
			{
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_enable", "0");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_name", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlan_mark", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_pbit_mark", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_uniport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_order", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ethertype", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_smac_mask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dmac_mask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sip", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sipmask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dip", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dipmask", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_ip_proto", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_sport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_dport", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_enable", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_id", "");
				fvt_paramlist_cat_str("l2_proto_vlan"+i+"_vlantag_pbit", "");
			}
		}

	} else if (form_name=='reboot_form' || form_name=='*') {
		fvt_paramlist_cat_str('kv_reboot', "1");
	}

	fvt_paramlist_presubmit(form_name);
}

function reloadPage()
{
	window.location.replace("/cgi-bin/wwwctrl.cgi?action=wan_pon_connections");
	//window.parent.contentfrm.location.replace(window.parent.contentfrm.location.href);
	timer = setTimeout("reloadPage()",10000);
}

function reloadw()
{
	timer = setTimeout("reloadPage()",10000);
}
//-->
</script>
</head>

<body align="left" onload="init();">
<table align="center" width="95%"><tbody>
<tr><td valign="top">
<div class="lv1_indent lv1_td" style="margin-left:0em;margin-top:20px">
<form id="id_wanMtn_form" name="wanMtn_form" method="post">
	<fieldset>
		<div class="lv1_title">Advanced Setup&nbsp;&gt;&nbsp;WAN Connections</div>
	</fieldset>
<div class="div1_indent lv2_new">
	<table><tbody>
		<tr>
			<td class="width_Nwanpon1"><div>Name</div></td>
			<td>
				<input id="id_GUIWanName" name="GUIWanName" class="width_text150" maxlength="12" type="text">
			</td>
		</tr>
		<tr>
			<td><div>WAN Mode</div></td>
			<td>
				<select class="width_Nwanpon_select" name="GUIWanMode" onchange="checkWanMode();setBridgeMode()" onclick="checkWanMode();setBridgeMode();setDefaultRoute();">
					<option value="0">IPoE(Static IP)</option>
					<option value="1">IPoE(DHCP)</option>
					<option value="2">PPPoE</option>
					<option value="3">Bridge</option>
				</select>
			</td>
		</tr>

		<tr style="display:none">
			<td><div class="lv1_th">Local Service</div></td>
		</tr>
		<tr style="display:none">
			<td></td>
			<td>
				<table><tr>
					<td><input name="GUIWanTR069" type="checkbox" class="checkbox"></td>
					<td><div>TR069</div></td>
				</tr></table>
			</td>
		</tr>
		<tr style="display:none">
			<td></td>
			<td>
				<table><tr>
					<td><input name="GUIWanIGMP" type="checkbox" class="checkbox"></td>
					<td><div>IGMP Proxy</div></td>
				</tr></table>
			</td>
		</tr>
		<tr style="display:none">
			<td></td>
			<td>
				<table><tr>
					<td><input name="GUIWanRoute" type="checkbox" class="checkbox"></td>
					<td><div>Default Route</div></td>
				</tr></table>
			</td>
		</tr>
		<tr>
			<td></td>
			<td><input name="nosave_addBtn" onclick="next()" value="Add" class="width_Nwanpon_add edit1" type="button"></td>
		</tr>
		<tr></tr>
	</tbody></table>

	<div><hr class="hr2" /></div>
</div>
</form>
<form id="id_wanTbl_form" name="wanTbl_form" method="post">
<div class="top_Nwanpon_2 lv3_new">
	<input name="nosave_deleteitem" id='id_delete_item' value="" type="hidden">
	<input name="nosave_deleteEntry" value="-1" type="hidden">
	<input name="nosave_deleteEntry_Type" value="" type="hidden">
	<input name="nosave_editEntry" value="-1" type="hidden">
	<input name="nosave_editEntry_Type" value="" type="hidden">
	<input name="nosave_editEntry_Value" value="0" type="hidden">
	<input name="nosave_editEntry_Name" value="" type="hidden">
	<div>
	<table id="wan_pon_overview" name="wan_pon_overview" border="0"><tbody>
		<tr>
			<th colspan="10"><div class="overview_title1">Wan interface</div></th>
		</tr>
		<tr class="lv2_new">
			<th class="width_Nwanpon_name">
				<div class="overview_title2">Name</div>
			</th>
			<th width="100px">
				<div class="overview_title2">Mode<br>VID</div>
			</th>
			<th style="display:none" class="width_Nwanpon_pbit">
				<div class="overview_title2">Pbit</div>
			</th>
			<th width="85px" class="thcenter">
				<div class="overview_title2">IPv4<br>Status</div>
			</th>
			<th width="180px">
				<div class="overview_title2">IPv4 Address/Mask<br>IPv4 Gateway</div>
			</th>
			<th width="85px" class="thcenter">
				<div class="overview_title2">IPv6<br>Status</div>
			</th>
			<th width="180px">
				<div class="overview_title2">IPv6 Address<br>IPv6 Gateway</div>
			</th>
			<th style="display:none" class="width_Nwanpon_dns">
				<div class="overview_title2">DNS1</div>
			</th>
			<th style="display:none" class="width_Nwanpon_dns">
				<div class="overview_title2">DNS2</div>
			</th>
			<th class="width_Nwanpon_Droute thcenter">
				<div class="overview_title2">Default Route</div>
			</th>
			<th style="display:none" class="width_Nwanpon_igmp">
				<div class="overview_title2">IGMP Proxy</div>
			</th>
			<th style="display:none" class="width_Nwanpon_cwmp">
				<div class="overview_title2">TR069</div>
			</th>
			<th class="width_Nwanpon_nat thcenter">
				<div class="overview_title2">NAT</div>
			</th>
			<th class="width_Nwanpon_enable thcenter">
				<div class="overview_title2">Interface</div>
			</th>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr style="height:5px;">
			<td colspan="12">
				<div><hr class="hr2"></div>
			</td>
		</tr>
		<script language="javascript" type="text/javascript">
			list_wan_interface();
			list_bridge_interface2();
		</script>
		<tr>
			<td colspan="6" style='color:#FF0000;font-weight:bold;'>
				<script language="javascript" type="text/javascript">
				document.write( vNoteDeafultRoute );
				</script>
			<td>
		</tr>
		<tr style="height:5px;">
			<td colspan="15">
				<div><hr class="hr2"></div>
			</td>
		</tr>
		<tr id="id_wait_progress" style="display:none">
			<td class="button_center">
				<img src="../images/wait.gif">
			</td>
		</tr>
	</tbody></table>
	</div>
</div>
</form>
<form id="id_bridgeTbl_form" name="bridgeTbl_form" method="post">
<div class="top_Nwanpon_2 lv3_new" style="display:none">
	<div class="lv2_new div1_topbottom">&nbsp;</div>
	<input name="nosave_deleteitem" id='id_delete_item' value="" type="hidden">
	<input name="nosave_deleteEntry" value="-1" type="hidden">
	<input name="nosave_deleteEntry_Type" value="" type="hidden">
	<input name="nosave_editEntry" value="-1" type="hidden">
	<input name="nosave_editEntry_Type" value="" type="hidden">
	<input name="nosave_editEntry_Value" value="0" type="hidden">
	<input name="nosave_editEntry_Name" value="" type="hidden">
	<div>
	<table id="bridge_overview" name="bridge_overview" border="0"><tbody>
		<tr>
			<th colspan="12"><div class="overview_title1">Bridge</div></th>
		</tr>
		<tr class="lv2_new">
			<th width="75px"><div class="overview_title2">Name</div></th>
			<th width="55px"><table><tr><td><div class="overview_title2">LAN</div></td></tr>
				<tr><td><div class="overview_title2">Port</div></td></tr></table></th>

			<th width="120px"><table><tr><td><div class="overview_title2">Dest. Mac</div></td></tr>
				<tr><td><div class="overview_title2">&nbsp;&nbsp;/Mask</div></td></tr></table></th>
			<th width="120px"><table><tr><td><div class="overview_title2">Sour. Mac</div></td></tr>
				<tr><td><div class="overview_title2">&nbsp;&nbsp;/Mask</div></td></tr></table></th>

			<th width="75px"><table><tr><td><div class="overview_title2">VLan ID</div></td></tr>
				<tr><td><div class="overview_title2">&nbsp;&nbsp;/Pbit</div></td></tr></table></th>

			<th width="55px"><table><tr><td><div class="overview_title2">Ether</div></td></tr>
				<tr><td><div class="overview_title2">Type</div></td></tr></table></th>
			<th width="65px"><div class="overview_title2">Protocol</div></th>

			<th width="120px"><table><tr><td><div class="overview_title2">Dest. IP</div></td></tr>
				<tr><td><div class="overview_title2">&nbsp;&nbsp;/Mask</div></td></tr></table></th>
			<th width="120px"><table><tr><td><div class="overview_title2">Sour. IP</div></td></tr>
				<tr><td><div class="overview_title2">&nbsp;&nbsp;/Mask</div></td></tr></table></th>
			<th width="55px"><table><tr><td><div class="overview_title2">Sour.</div></td></tr>
				<tr><td><div class="overview_title2">Port</div></td></tr></table></th>
			<th width="75px"><table><tr><td><div class="overview_title2">Dest.</div></td></tr>
				<tr><td><div class="overview_title2">Port</div></td></tr></table></th>

			<th width="45px"><div class="overview_title2">Intf.</div></th>
			<th width="45px"><div class="lv2_new">VID</div></th>
			<th width="40px"><div class="lv2_new">Pbit</div></th>
		</tr>
		<tr style="height:5px;">
			<td colspan="15">
				<div><hr class="hr2"></div>
			</td>
		</tr>
		<script language="javascript" type="text/javascript">
			//list_bridge_interface();
		</script>
	</tbody></table>
	</div>
</div>
</form>
<form id="id_reboot_form" name="reboot_form" method="post">
	<input id="id_reboot_flag" name="nosave_reboot_flag" value="0" type="hidden">
</form>
</div>

</td></tr>
</tbody></table>

</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>

<script language="javascript" type="text/javascript">

var L3_Rule=parseInt(URLParams("l3r"));

var filter_max = 16;

function check_process()
{
	var process="Success";
	if (process=="Existed")
		alert("Please wait!!");
}

function compare_port(start_port, end_port, no)
{
	var temp;

	if (no==1)
		temp='st';
	else if (no==2)
		temp='nd';
	else if (no==3)
		temp='rd';
	else
		temp='th';

	if ((!isBlank(start_port))&&(!isBlank(end_port)))
	{
		if (parseInt(start_port)>parseInt(end_port))
		{
			alert("Starting Port of group "+no+" should be equal or smaller than the relative Ending Port!");
			return false;
		}
	}
	return true;
}

function compare_ip(starting_ip, ending_ip, no)
{
	var i;
	var part_ip;
	var part_start;
	var part_end;

	var temp;

	if (no==1)
		temp='st';
	else if (no==2)
		temp='nd';
	else if (no==3)
		temp='rd';
	else
		temp='th';

	if ((!isBlank(starting_ip))&&(!isBlank(ending_ip)))
	{
		part_start = starting_ip.split('.');
		part_end = ending_ip.split('.');

		for (i=0; i<3; i++)
		{
			if (part_start[i]!=part_end[i])
			{
				alert("Starting IP and Ending IP of group "+no+" don't match!");
				return false;
			}
		}

		if (parseInt(part_start[3]) > parseInt(part_end[3]))
		{
			alert("Starting IP and Ending IP of group "+no+" don't match!");
			return false;
		}
	}

	return true;
}

function dscp_fun()
{
	if (document.l3sub_filter_form.DSCPFilterEnable.value!="Disable")//fanny edit 2012/06/25 0 to Disable
		document.l3sub_filter_form.DSCPFilterMarking.disabled=false;
	else
		document.l3sub_filter_form.DSCPFilterMarking.disabled=true;
}

function checkSpecSymbol(s)
{
	for(i=0;i<s.length;i++)
	{
	c=s.charAt(i);
		if(c==';')
			return false;
	}
	return true;
}

function SourceIP_All()
{
	if ( document.getElementById("id_SRCIPALL").checked )
		{
		document.getElementById("id_IPFilterSRCIP").disabled=true;
		document.getElementById("id_IPFilterSRCPl").disabled=true;
		}
	else
		{
		document.getElementById("id_IPFilterSRCIP").disabled=false;
		document.getElementById("id_IPFilterSRCPl").disabled=false;
		}
}

function DestIP_All()
{
	if ( document.getElementById("id_DSTIPALL").checked )
		{
		document.getElementById("id_IPFilterDSTIP").disabled=true;
		document.getElementById("id_IPFilterDSTPl").disabled=true;
		}
	else
		{
		document.getElementById("id_IPFilterDSTIP").disabled=false;
		document.getElementById("id_IPFilterDSTPl").disabled=false;
		}
}

function SourcePort_All()
{
	if ( document.getElementById("id_SRCPortALL").checked)
		{
		document.getElementById("id_IPSRCStartPort").disabled=true;
		document.getElementById("id_IPSRCEndPort").disabled=true;
		}
	else
		{
		document.getElementById("id_IPSRCStartPort").disabled=false;
		document.getElementById("id_IPSRCEndPort").disabled=false;
		}
}

function DestPort_All()
{
	if ( document.getElementById("id_DSTPortALL").checked)
		{
		document.getElementById("id_IPDSTStartPort").disabled=true;
		document.getElementById("id_IPDSTEndPort").disabled=true;
		}
	else
		{
		document.getElementById("id_IPDSTStartPort").disabled=false;
		document.getElementById("id_IPDSTEndPort").disabled=false;
		}
}

function natfw_filter()
{
	var i, j;
	var temp=document.l3sub_filter_form;
	var no;
	var set;
	var item;

	if ((!isBlank(document.getElementById("id_IPFilterName").value))||(!isBlank(document.getElementById("id_IPFilterSRCIP").value))||(!isBlank(document.getElementById("id_IPSRCStartPort").value))
	 ||(!isBlank(document.getElementById("id_IPSRCEndPort").value)))
	{
		if ((isBlank(document.getElementById("id_IPFilterName").value)))
		{
			alert("Please fill with the [Filter Name] of group!");
			return;
		}
	}

	if (!checkSpecSymbol(document.getElementById("id_IPFilterName").value))
	{
		item="Filter Name";
		alert("The "+ item +" of group is invalid!");
		return;
	}

	if (!checkIPv6(document.getElementById("id_IPFilterSRCIP" ).value) &&
		!check_integer_range(document.getElementById("id_IPFilterSRCPl").value,1,128) &&
		!(document.getElementById("id_SRCIPALL" ).checked))
	{
		item="Source IP Address";
		alert("The "+ item +" of group is invalid!");
		return;
	}

	if (!checkIPv6(document.getElementById("id_IPFilterDSTIP" ).value) &&
		!check_integer_range(document.getElementById("id_IPFilterDSTPl").value,1,128) &&
		!(document.getElementById("id_DSTIPALL" ).checked))
	{
		item="Destination IP Address";
		alert("The "+ item +" of group is invalid!");
		return;
	}

	if(!(isBlank(document.getElementById("id_IPSRCStartPort").value)))
	{
		if ( !check_port(document.getElementById("id_IPSRCStartPort").value))
		{
			item="Source Starting Port";
			alert("The " + item + " of group should be an integer between 1 and 65535");
			return;
		}
	}

	if(!(isBlank(document.getElementById("id_IPSRCEndPort").value)))
	{
		if (!check_port(document.getElementById("id_IPSRCEndPort").value))
		{
			item="Source Ending Port";
			alert("The " + item + " of group should be an integer between 1 and 65535");
			return;
		}
	}

	if(!(isBlank(document.getElementById("id_IPDSTStartPort").value)))
	{
		if ( !check_port(document.getElementById("id_IPDSTStartPort").value))
		{
			item="Destination Starting Port";
			alert("The " + item + " of group should be an integer between 1 and 65535");
			return;
		}
	}

	if(!(isBlank(document.getElementById("id_IPDSTEndPort").value)))
	{
		if (!check_port(document.getElementById("id_IPDSTEndPort").value))
		{
			item="Destination Ending Port";
			alert("The " + item + " of group should be an integer between 1 and 65535");
			return;
		}
	}
	if (document.getElementById("id_DSTIPALL").checked
	 && document.getElementById("id_DSTPortALL").checked
	 && document.getElementById("id_SRCIPALL").checked
	 && document.getElementById("id_SRCPortALL").checked
	 && document.getElementById("id_IPFilterProtocol").value == 'tcp'
	 && document.getElementById("id_IPFilterType").value == "OUTBOUND")
	{
		if (!confirm("Note: your own IP within this rule! you will unable to login after apply this rule.\nAre you sure to apply this rule?"))
		{return;}
	}

	fvt_form_submit();
	document.getElementById('id_apply_tr').style.display="none";
	document.getElementById('id_wait_progress').style.display="";
	check_process();
	temp.submit();
	localStorage.setItem("redirectPage", "1");
}

function check_redirectPage()
{
	if (localStorage.getItem("redirectPage")=="1") Back();
}

function fvt_form_init()
{
	var i;
	var j;
	var f_name_key;
	var f_name_val;
	var f_name_id;
	var f_ip_type_key;
	var f_ip_type_val;
	var f_ip_type_id;
	var f_action_key;
	var f_action_val;
	var f_action_id;
	var f_srcip_key;
	var f_srcip_val;
	var f_srcip_id;
	var f_srcip_item_id;
	var f_srcip_item_ary;
	var f_srcpl_key;
	var f_srcpl_val;
	var f_srcpl_id;
	var f_protocol_key;
	var f_protocol_val;
	var f_protocol_id;
	var f_sportstart_key;
	var f_sportstart_val;
	var f_sportstart_id;
	var f_sportend_key;
	var f_sportend_val;
	var f_sportend_id;
	var f_enable_key;
	var f_enable_val;
	var f_enable_id;

	var f_dstip_key;
	var f_dstip_val;
	var f_dstip_id;
	var f_dstpl_key;
	var f_dstpl_val;
	var f_dstpl_id;
	var f_dportstart_key;
	var f_dportstart_val;
	var f_dportstart_id;
	var f_dportend_key;
	var f_dportend_val;
	var f_dportend_id;

	f_name_key = 'fw_ipv6_acl'+L3_Rule+'_name';
	f_ip_type_key = 'fw_ipv6_acl'+L3_Rule+'_type';
	f_action_key = 'fw_ipv6_acl'+L3_Rule+'_action';
	f_srcip_key = 'fw_ipv6_acl'+L3_Rule+'_srcip';
	f_srcpl_key = 'fw_ipv6_acl'+L3_Rule+'_srcpl';
	f_protocol_key = 'fw_ipv6_acl'+L3_Rule+'_proto';
	f_sportstart_key = 'fw_ipv6_acl'+L3_Rule+'_sport';
	f_sportend_key = 'fw_ipv6_acl'+L3_Rule+'_sportend';
	f_enable_key = 'fw_ipv6_acl'+L3_Rule+'_en';
	f_dstip_key = 'fw_ipv6_acl'+L3_Rule+'_dstip';
	f_dstpl_key = 'fw_ipv6_acl'+L3_Rule+'_dstpl';
	f_dportstart_key = 'fw_ipv6_acl'+L3_Rule+'_dport';
	f_dportend_key = 'fw_ipv6_acl'+L3_Rule+'_dportend';

	f_name_id = 'id_IPFilterName';
	f_ip_type_id = 'id_IPFilterType';
	f_action_id = 'id_IPFilterAction';
	f_srcip_id = 'id_IPFilterSRCIP';
	f_srcpl_id = 'id_IPFilterSRCPl';
	f_protocol_id = 'id_IPFilterProtocol';
	f_sportstart_id = 'id_IPSRCStartPort';
	f_sportend_id = 'id_IPSRCEndPort';
	f_enable_id = 'id_IPFilterEnable';
	f_dstip_id = 'id_IPFilterDSTIP';
	f_dstpl_id = 'id_IPFilterDSTPl';
	f_dportstart_id = 'id_IPDSTStartPort';
	f_dportend_id = 'id_IPDSTEndPort';

	f_name_val = fvt_meta_config(f_name_key);

	f_ip_type_val = fvt_meta_config(f_ip_type_key);
	f_action_val = fvt_meta_config(f_action_key);
	f_srcip_val = fvt_meta_config(f_srcip_key);
	//if (f_srcip_val=="") f_srcip_val="::";
	f_srcpl_val = fvt_meta_config(f_srcpl_key);
	//if (f_srcpl_val=="") f_srcpl_val="0";
	f_protocol_val = fvt_meta_config(f_protocol_key);
	f_sportstart_val = fvt_meta_config(f_sportstart_key);
	f_sportend_val = fvt_meta_config(f_sportend_key);
	f_enable_val = fvt_meta_config(f_enable_key);
	f_dstip_val = fvt_meta_config(f_dstip_key);
	//if (f_dstip_val=="") f_dstip_val="::";
	f_dstpl_val = fvt_meta_config(f_dstpl_key);
	//if (f_dstpl_val=="") f_dstpl_val="0";
	f_dportstart_val = fvt_meta_config(f_dportstart_key);
	f_dportend_val = fvt_meta_config(f_dportend_key);

	document.getElementById(f_name_id).value = f_name_val;
	document.getElementById(f_ip_type_id).value = f_ip_type_val;
	document.getElementById(f_action_id).value = f_action_val;

	document.getElementById('id_IPFilterSRCIP').value = f_srcip_val;

	document.getElementById(f_srcpl_id).value = f_srcpl_val;
	document.getElementById(f_protocol_id).value = f_protocol_val;
	document.getElementById(f_sportstart_id).value = f_sportstart_val;
	document.getElementById(f_sportend_id).value = f_sportend_val;
	document.getElementById(f_enable_id).value = f_enable_val;
	//alert ("en="+f_enable_val)
	if (f_enable_val==1)
		document.getElementById(f_enable_id)[0].selected='selected';
	else
		document.getElementById(f_enable_id)[1].selected='selected';

	document.getElementById('id_IPFilterDSTIP').value = f_dstip_val;
	document.getElementById(f_dstpl_id).value = f_dstpl_val;
	document.getElementById(f_dportstart_id).value = f_dportstart_val;
	document.getElementById(f_dportend_id).value = f_dportend_val;
	if(f_srcip_val == "") document.getElementById("id_SRCIPALL").checked = true;
	if(f_dstip_val == "") document.getElementById("id_DSTIPALL").checked = true;
	if(f_sportstart_val == "") document.getElementById("id_SRCPortALL").checked = true;
	if(f_dportstart_val == "") document.getElementById("id_DSTPortALL").checked = true;
	localStorage.setItem("redirectPage", "0");
}

function fvt_form_submit()	{
	var i;
	var f_name_key;
	var f_name_val;
	var f_name_id;
	var f_ip_type_key;
	var f_ip_type_val;
	var f_ip_type_id;
	var f_action_key;
	var f_action_val;
	var f_action_id;
	var f_srcip_key;
	var f_srcip_val;
	var f_srcip_id;
	var f_srcpl_key;
	var f_srcpl_val;
	var f_srcpl_id;
	var f_protocol_key;
	var f_protocol_val;
	var f_protocol_id;
	var f_sportstart_key;
	var f_sportstart_val;
	var f_sportstart_id;
	var f_sportend_key;
	var f_sportend_val;
	var f_sportend_id;
	var f_enable_key;
	var f_enable_val;
	var f_enable_id;

	var f_dstip_key;
	var f_dstip_val;
	var f_dstip_id;
	var f_dstpl_key;
	var f_dstpl_val;
	var f_dstpl_id;
	var f_dportstart_key;
	var f_dportstart_val;
	var f_dportstart_id;
	var f_dportend_key;
	var f_dportend_val;
	var f_dportend_id;

	fvt_paramlist_clear();

		f_name_key = 'fw_ipv6_acl'+L3_Rule+'_name';
		f_ip_type_key = 'fw_ipv6_acl'+L3_Rule+'_type';
		f_action_key = 'fw_ipv6_acl'+L3_Rule+'_action';
		f_srcip_key = 'fw_ipv6_acl'+L3_Rule+'_srcip';
		f_srcpl_key = 'fw_ipv6_acl'+L3_Rule+'_srcpl';
		f_protocol_key = 'fw_ipv6_acl'+L3_Rule+'_proto';
		f_sportstart_key = 'fw_ipv6_acl'+L3_Rule+'_sport';
		f_sportend_key = 'fw_ipv6_acl'+L3_Rule+'_sportend';
		f_enable_key = 'fw_ipv6_acl'+L3_Rule+'_en';
		f_dstip_key = 'fw_ipv6_acl'+L3_Rule+'_dstip';
		f_dstpl_key = 'fw_ipv6_acl'+L3_Rule+'_dstpl';
		f_dportstart_key = 'fw_ipv6_acl'+L3_Rule+'_dport';
		f_dportend_key = 'fw_ipv6_acl'+L3_Rule+'_dportend';

		f_name_id = 'id_IPFilterName';
		f_ip_type_id = 'id_IPFilterType';
		f_action_id = 'id_IPFilterAction';
		f_srcip_id = 'id_IPFilterSRCIP';
		f_srcpl_id = 'id_IPFilterSRCPl';
		f_protocol_id = 'id_IPFilterProtocol';
		f_sportstart_id = 'id_IPSRCStartPort';
		f_sportend_id = 'id_IPSRCEndPort';
		f_enable_id = 'id_IPFilterEnable';
		f_dstip_id = 'id_IPFilterDSTIP';
		f_dstpl_id = 'id_IPFilterDSTPl';
		f_dportstart_id = 'id_IPDSTStartPort';
		f_dportend_id = 'id_IPDSTEndPort';

		f_name_val = document.getElementById(f_name_id).value;

		if((f_name_val=='') || (f_ip_type_id=='') || (f_protocol_id=='') )
		{
			fvt_paramlist_cat_str(f_name_key, "");
			fvt_paramlist_cat_str(f_ip_type_key, "");
			fvt_paramlist_cat_str(f_protocol_key, "");
			fvt_paramlist_cat_str(f_srcip_key, "");
			fvt_paramlist_cat_str(f_srcpl_key, "");
			fvt_paramlist_cat_str(f_sportstart_key, "");
			fvt_paramlist_cat_str(f_sportend_key, "");
			fvt_paramlist_cat_str(f_dstip_key, "");
			fvt_paramlist_cat_str(f_dstpl_key, "");
			fvt_paramlist_cat_str(f_dportstart_key, "");
			fvt_paramlist_cat_str(f_dportend_key, "");
			fvt_paramlist_cat_str(f_enable_key, "");
			fvt_paramlist_cat_str(f_action_key, "");
		}
		else
		{
			f_ip_type_val = document.getElementById(f_ip_type_id).value;
			if ( (f_srcip_id=='') || (document.getElementById("id_SRCIPALL").checked) ) f_srcip_val = "";
			else f_srcip_val = document.getElementById(f_srcip_id).value;
			f_srcpl_val = document.getElementById(f_srcpl_id).value;
			f_protocol_val = document.getElementById(f_protocol_id).value;
			if ( (document.getElementById("id_SRCPortALL").checked) )
			{
				f_sportstart_val = "";
				f_sportend_val = "";
			}
			else
			{
				f_sportstart_val = document.getElementById(f_sportstart_id).value;
				f_sportend_val = document.getElementById(f_sportend_id).value;
			}
			f_enable_val = document.getElementById(f_enable_id).value;

			if ( (f_dstip_id=='') || (document.getElementById("id_DSTIPALL").checked)) f_dstip_val = "";
			else f_dstip_val = document.getElementById(f_dstip_id).value;
			f_dstpl_val = document.getElementById(f_dstpl_id).value;
			if ( (document.getElementById("id_DSTPortALL").checked) )
			{
				f_dportstart_val = "";
				f_dportend_val = "";
			}
			else
			{
				f_dportstart_val = document.getElementById(f_dportstart_id).value;
				f_dportend_val = document.getElementById(f_dportend_id).value;
			}

			fvt_paramlist_cat_str(f_name_key, f_name_val);
			fvt_paramlist_cat_str(f_ip_type_key, f_ip_type_val);
			fvt_paramlist_cat_str(f_srcip_key, f_srcip_val);
			fvt_paramlist_cat_str(f_dstip_key, f_dstip_val);

			if(f_srcip_val == "") fvt_paramlist_cat_str(f_srcpl_key, "");
			else fvt_paramlist_cat_str(f_srcpl_key, f_srcpl_val);

			if(f_dstip_val == "") fvt_paramlist_cat_str(f_dstpl_key, "");
			else
			fvt_paramlist_cat_str(f_dstpl_key, f_dstpl_val);

			fvt_paramlist_cat_str(f_protocol_key, f_protocol_val);

			if(f_protocol_val != "icmp" )
			{
				fvt_paramlist_cat_str(f_sportstart_key, f_sportstart_val);
				fvt_paramlist_cat_str(f_sportend_key, f_sportend_val);
				fvt_paramlist_cat_str(f_dportstart_key, f_dportstart_val);
				fvt_paramlist_cat_str(f_dportend_key, f_dportend_val);
			}
			fvt_paramlist_cat_str(f_enable_key, f_enable_val);
			//fvt_paramlist_cat_str(f_action_key, "DROP");
			f_action_val = document.getElementById(f_action_id).value;
			fvt_paramlist_cat_str(f_action_key, f_action_val);
		}

	fvt_paramlist_presubmit('l3sub_filter_form');
}

function block_port_range()
{
	var id = "id_IPFilterProtocol";
	var startPortId = "id_IPSRCStartPort";
	var endPortId = "id_IPSRCEndPort";
	var protocol = document.getElementById(id).value;
	var action = false;

	if(protocol == "ICMP" || protocol == "icmp")
	{
		action = true;
		document.getElementById(startPortId).value = "";
		document.getElementById(endPortId).value = "";
		document.getElementById(startPortId).disabled = action;
		document.getElementById(endPortId).disabled = action;
	}
}

function Back()
{
	window.location.href="wwwctrl.cgi?action=l3_filter_ipv6";
}
</script>
</head>

<body align="left" onload="check_redirectPage();fvt_form_init();SourcePort_All();DestPort_All();SourceIP_All();DestIP_All();check_process();">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="id_l3sub_filter_form" name="l3sub_filter_form" method="post">
	<fieldset>
		<div class="lv1_title">Firewall Setup&nbsp;&gt;&nbsp;IPv6 Layer 3 Filter</div>
	</fieldset>
	<fieldset>
		<div class="lv2_title" style="margin:10px 0em">
		<script language="javascript" type="text/javascript">
			document.write("Layer 3 Filter IPv6 rule [" + L3_Rule + "] Setting :");
		</script>

		<div class="lv2_th" style="margin:10px 0">
		<table><tbody>
			<tr>
				<th><div class="lv2_th" style="text-align:left;width:180px;">Enable</div></th>
				<td>
					<select style='width:65px' name='IPFilterEnable' id='id_IPFilterEnable'>
					<option value='1'>Enable</option>
					<option value='0'>Disable</option>
					</select>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Filter&nbsp;Name</div></th>
				<td>
				<input style='width:90px' type='text' name='IPFilterName' id='id_IPFilterName' size='8' maxlength='16'>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Filter&nbsp;Action</div></th>
				<td>
					<select style='width:80px' name='IPFilterAction' class='width_select40' id='id_IPFilterAction'>
					<option value='DROP'>DROP</option>
					<option value='ACCEPT'>ACCEPT</option>
					</select>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Filter&nbsp;Type</div></th>
				<td>
					<select style='width:80px' name='IPFilterType' class='width_select40' id='id_IPFilterType'>
					<option value='INBOUND'>Incoming</option>
					<option value='OUTBOUND'>Outgoing</option>
					</select>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Protocol</div></th>
				<td>
					<select style='width:65px' name='IPFilterProtocol' class='width_select40' id='id_IPFilterProtocol' onchange='block_port_range()'>
					<option value='tcp'>TCP</option>
					<option value='udp'>UDP</option>
					<option value='icmpv6'>ICMPv6</option>
					</select>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Source&nbsp;IP Addr/Prefix</div></th>
				<td>
					<input style='width:200px;text-align:right;' type='text' name='IPFilterSRCIP' id='id_IPFilterSRCIP' maxlength=39>
					/
					<input style='width:20px;text-align:right;' type='text' name='IPFilterSRCPl' id='id_IPFilterSRCPl' maxlength=3>
				</td>
				<td>
					<label>&nbsp;<input type='checkbox' name='SRCIPALL' id='id_SRCIPALL' onclick='SourceIP_All();'> All IP</label>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Source Port</div></th>
				<td>
					Start<input style='width:60px' type='text' name='IPSRCStartPort' class='width_portw' id='id_IPSRCStartPort' maxlength=5>
				</td>
				<td>
					<label>&nbsp;<input type='checkbox' name='SRCPortALL' id='id_SRCPortALL' onclick='SourcePort_All();'> All Port</label>
				</td>
			</tr>
			<tr>
				<td></td>
				<td>
				End&nbsp;&nbsp;<input style='width:60px' type='text' name='IPSRCEndPort' class='width_portw' id='id_IPSRCEndPort' maxlength=5>
				</td>
			</tr>

<!-- Destination  -->
			<tr></tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Destination&nbsp;IP Addr/Prefix</div></th>
				<td>
					<input style='width:200px;text-align:right;' type='text' name='IPFilterDSTIP' id='id_IPFilterDSTIP' maxlength=39>
					/
					<input style='width:20px;text-align:right;' type='text' name='IPFilterDSTPl' id='id_IPFilterDSTPl' maxlength=3>
				</td>
				<td>
					<label>&nbsp;<input type='checkbox' name='DSTIPALL' id='id_DSTIPALL' onclick='DestIP_All();'> All IP</label>
				</td>
			</tr>
			<tr>
				<th><div class="lv2_th" style="text-align:left;">Destination Port</div></th>
				<td>
					Start <input style='width:60px' type='text' name='IPDSTStartPort' class='width_portw' id='id_IPDSTStartPort' maxlength=5>
				</td>
				<td>
					<label>&nbsp;<input type='checkbox' name='DSTPortALL' id='id_DSTPortALL' onclick='DestPort_All();'> All Port</label>
				</td>
			</tr>
			<tr>
				<td></td>
				<td>
					End&nbsp;&nbsp;<input style='width:60px' type='text' name='IPDSTEndPort' class='width_portw' id='id_IPDSTEndPort' maxlength=5>
				</td>
			</tr>
			<tr></tr>
		</tbody></table>
		</div>

		<div style="margin-top:20px">
			<table>
			<tr id="id_apply_tr">
				<td width="600px" align="center">
				<input type="button" onclick="natfw_filter()" class="width_apply" name="applybtn" value="Apply Changes" id="add_applybtn">
				<input type="button" onclick="Back()" name="applybtn" value="Back" class="width_apply">
				</td>
			</tr>
			<tr id="id_wait_progress" style="display:none">
				<td width="800px" align="center">
						<img src="../images/progress1.gif">
				</td>
			</tr>
			</table>
		</div>
	</div>
</form>
</td></tr>
</tbody></table>
</div>

<br>
</body>
</html>

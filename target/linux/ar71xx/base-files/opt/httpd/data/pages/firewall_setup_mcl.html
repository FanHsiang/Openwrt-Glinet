<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../css/common.css" media="all">
<script language="javascript" type="text/javascript" src="../js/menu_base.js"></script>
<script language="javascript" type="text/javascript" src="../js/menu.js"></script>
<script language="javascript" type="text/javascript" src="../js/common.js"></script>
<script language="javascript" type="text/javascript" src="../js/fvt.js"></script>
<style type="text/css">
tr.rowt{background-color:#E0E0E0}
tr.rowh{background-color:#F0F0F0}
/* DarkBlue */
div.rowh{color:#00008B}
div.cellt{color:DarkGray}
/* DarkSlateGrey */
div.cells{color:#2F4F4F}
td.warning{color:red; font-weight: bold;}
</style>
<script language="javascript" type="text/javascript">
//var mcl_wan_max = 16;
var maxWan=8;

var mcl_wan_max=16;
var mcl_check_wan_max=16;
var mcl_lan_max=4;
var Have_TR069=0;
if ( fvt_meta_config('system_modelname')=="I-040GW" )
	{
	//Have_TR069=1;
	mcl_wan_max=25;
	mcl_check_wan_max=24;
	}

function WanwriteToHidden(index)
{
	var master="id_mcl_wanIP" + index;
	var item1="id_mcl_wanIP" + index + "_item1";
	var item2="id_mcl_wanIP" + index + "_item2";
	var item3="id_mcl_wanIP" + index + "_item3";
	var item4="id_mcl_wanIP" + index + "_item4";
	merge_ip(master,item1,item2,item3,item4);
}

function checkIP()
{
	var i;
	for(i=0;i<mcl_wan_max;i++)
	{
		if(!check_ip_range(document.getElementById("id_mcl_wanIP"+i).value, document.getElementById("id_mcl_wanNetmask"+i).options[document.getElementById("id_mcl_wanNetmask"+i).selectedIndex].innerHTML))
		{
			alert("WAN: Accept IP "+(i+1)+" is invalid!");
			return false;
		}
		for(var j=(i+1);j<(mcl_check_wan_max);j++)	//CHT ignore check rule 24, 25 is same.
		{
			if((document.getElementById("id_mcl_wanIP"+i).value !="")&&(document.getElementById("id_mcl_wanIP"+j).value!=""))
			{
				if(document.getElementById("id_mcl_wanIP"+i).value == document.getElementById("id_mcl_wanIP"+j).value)
				{
					alert("WAN: Accept IP "+(i+1)+" and Accept IP "+(j+1)+" are the same!");
					return false;
				}
			}
		}
	}

	for(i=0;i<mcl_lan_max;i++)
	{
		if(!check_ip_range(document.getElementById("id_mcl_lanIP"+i).value, document.getElementById("id_mcl_lanNetmask"+i).options[document.getElementById("id_mcl_lanNetmask"+i).selectedIndex].innerHTML))
		{
			alert("LAN: Accept IP "+(i+1)+" is invalid!");
			return false;
		}
		for(var j=(i+1);j<(mcl_lan_max);j++)
		{
			if((document.getElementById("id_mcl_lanIP"+i).value !="")&&(document.getElementById("id_mcl_lanIP"+j).value!=""))
			{
				if(document.getElementById("id_mcl_lanIP"+i).value == document.getElementById("id_mcl_lanIP"+j).value)
				{
					alert("LAN: Accept IP "+(i+1)+" and Accept IP "+(j+1)+" are the same!");
					return false;
				}
			}
		}
	}

	return true;
}

function MCLSetting()
{
	if (!checkIP())
	{
		return false;
	}
	fvt_form_submit('MCL_form');
	document.getElementById('id_apply_tr').style.display="none";
	document.getElementById('id_wait_progress').style.display="";
	document.getElementById('MCL_form').submit();
}

function changeWan_disable()
{
	var i;
	var val;
	if (document.getElementById('MCL_WANPolicy').value==1)
		val=true;
	else
		val=false;
	for(i=0;i<mcl_wan_max;i++)
	{
		document.getElementById("id_mcl_wanIP"+i+"_item1").disabled = val;
		document.getElementById("id_mcl_wanIP"+i+"_item2").disabled = val;
		document.getElementById("id_mcl_wanIP"+i+"_item3").disabled = val;
		document.getElementById("id_mcl_wanIP"+i+"_item4").disabled = val;
		document.getElementById("id_mcl_wanNetmask"+i).disabled = val;
	}
}

function submit_ssh_enable()
{
	var keySSHW="";
	var keySSHL="";
	var keyTFTPW="";
	var keySNMPW="";
	var keyTR069W="";
	var keyWEBW="";
	var keyPINGW="";
	var keyTFTPL="";
	var keyWEBL="";
	var keySNMPL="";
	var keyTR069L="";
	var valSSHW=fvt_form_obj_get("MCL_form", "remoteSSHEnableW");
	var valSSHL=fvt_form_obj_get("MCL_form", "remoteSSHEnableL");
	var valTFTPW=fvt_form_obj_get("MCL_form", "TFTPEnableW");
	var valSNMPW=fvt_form_obj_get("MCL_form", "SNMPEnableW");
	var valTR069W=fvt_form_obj_get("MCL_form", "TR069EnableW");
	var valWEBW=fvt_form_obj_get("MCL_form", "WEBEnableW");
	var valPINGW=fvt_form_obj_get("MCL_form", "PINGEnableW");
	var valTFTPL=fvt_form_obj_get("MCL_form", "TFTPEnableL");
	var valWEBL=fvt_form_obj_get("MCL_form", "WEBEnableL");
	var valSNMPL=fvt_form_obj_get("MCL_form", "SNMPEnableL");
	var valTR069L=fvt_form_obj_get("MCL_form", "TR069EnableL");

	var i=0;

	for(i=0; i<maxWan; i++)
	{
		keySSHW="fw_service_w"+i+"_ssh_enable";
		fvt_paramlist_cat_str(keySSHW, valSSHW);

		keyTFTPW="fw_service_w"+i+"_tftp_enable";
		fvt_paramlist_cat_str(keyTFTPW, valTFTPW);

		keySNMPW="fw_service_w"+i+"_snmp_enable";
		fvt_paramlist_cat_str(keySNMPW, valSNMPW);

		keyTR069W="fw_service_w"+i+"_tr069_enable";
		fvt_paramlist_cat_str(keyTR069W, valTR069W);

		keyWEBW="fw_service_w"+i+"_web_enable";
		fvt_paramlist_cat_str(keyWEBW, valWEBW);

		keyPINGW="fw_service_w"+i+"_ping_enable";
		fvt_paramlist_cat_str(keyPINGW, valPINGW);
	}

	for(i=0; i<4; i++)
	{
		keySSHL="fw_service_l"+i+"_ssh_enable";
		fvt_paramlist_cat_str(keySSHL, valSSHL);

		keyTFTPL="fw_service_l"+i+"_tftp_enable";
		fvt_paramlist_cat_str(keyTFTPL, valTFTPL);

		keyWEBL="fw_service_l"+i+"_web_enable";
		fvt_paramlist_cat_str(keyWEBL, valWEBL);

		keySNMPL="fw_service_l"+i+"_snmp_enable";
		fvt_paramlist_cat_str(keySNMPL, valSNMPL);

		keyTR069L="fw_service_l"+i+"_tr069_enable";
		fvt_paramlist_cat_str(keyTR069L, valTR069L);
	}
}

function submit_telnet_enable()
{
	var keyW="";
	var keyL="";
	var valW=fvt_form_obj_get("MCL_form", "remoteTelnetEnableW");
	var valL=fvt_form_obj_get("MCL_form", "remoteTelnetEnableL");
	var i=0;

	for(i=0; i<maxWan; i++)
	{
		keyW="fw_service_w"+i+"_telnet_enable";
		fvt_paramlist_cat_str(keyW, valW);
	}

	for(i=0; i<4; i++)
	{
		keyL="fw_service_l"+i+"_telnet_enable";
		fvt_paramlist_cat_str(keyL, valL);
	}
}

function fvt_form_init(form_name){
	var i;
	var ip;
	if (form_name=='MCL_form' || form_name=='*')
	{
		fvt_form_obj_set("MCL_form", "MCL_WANPolicy", fvt_meta_config("fw_remotemng_accept_any"));
		for(i=0;i<mcl_wan_max;i++)
		{
			ip = fvt_meta_config("fw_remotemng_accept"+i+"_ip").split("/")
			fvt_form_obj_set("MCL_form", "mcl_wanIP"+i, ip[0]);
		}
		changeWan_disable();

		fvt_form_obj_set("MCL_form", "MCL_LANPolicy", fvt_meta_config("fw_lanmng_accept_any"));
		for(i=0;i<mcl_lan_max;i++)
		{
			ip = fvt_meta_config("fw_lanmng_accept"+i+"_ip").split("/")
			fvt_form_obj_set("MCL_form", "mcl_lanIP"+i, ip[0]);
		}
		changeLan_disable();

		fvt_form_obj_set("MCL_form", "remoteTelnetEnableW", fvt_meta_config('fw_service_w0_telnet_enable'));
		fvt_form_obj_set("MCL_form", "remoteTelnetEnableL", fvt_meta_config('fw_service_l0_telnet_enable'));
		fvt_form_obj_set("MCL_form", "remoteSSHEnableW", fvt_meta_config('fw_service_w0_ssh_enable'));
		fvt_form_obj_set("MCL_form", "remoteSSHEnableL", fvt_meta_config('fw_service_l0_ssh_enable'));
		fvt_form_obj_set("MCL_form", "TFTPEnableW", fvt_meta_config('fw_service_w0_tftp_enable'));
		fvt_form_obj_set("MCL_form", "TFTPEnableL", fvt_meta_config('fw_service_l0_tftp_enable'));
		fvt_form_obj_set("MCL_form", "SNMPEnableW", fvt_meta_config('fw_service_w0_snmp_enable'));
		fvt_form_obj_set("MCL_form", "SNMPEnableL", fvt_meta_config('fw_service_l0_snmp_enable'));
		fvt_form_obj_set("MCL_form", "TR069EnableW", fvt_meta_config('fw_service_w0_tr069_enable'));
		fvt_form_obj_set("MCL_form", "TR069EnableL", fvt_meta_config('fw_service_l0_tr069_enable'));
		fvt_form_obj_set("MCL_form", "WEBEnableW", fvt_meta_config('fw_service_w0_web_enable'));
		fvt_form_obj_set("MCL_form", "WEBEnableL", fvt_meta_config('fw_service_l0_web_enable'));
		fvt_form_obj_set("MCL_form", "PINGEnableW", fvt_meta_config('fw_service_w0_ping_enable'));
	}
	if (Have_TR069==1)
	{
		document.getElementById('tb_tr069W').style.display = 'table-row';
		document.getElementById('tb_tr069L').style.display = 'table-row';
	}
	document.getElementById('id_lanips').style.display="none";
}

function fvt_form_submit(form_name){
	var i;
	var mask;
	var mclip
	fvt_paramlist_clear();
	if (form_name=='MCL_form' || form_name=='*') {
		fvt_paramlist_cat_str("kv_remote_ip_k", fvt_meta_config('kv_remote_ip'));
		fvt_paramlist_cat_str("fw_remotemng_accept_any", fvt_form_obj_get("MCL_form", "MCL_WANPolicy"));
		// for Wan
		for(i=0;i<mcl_wan_max;i++)
		{
			mask = document.getElementById("id_mcl_wanNetmask"+i).value;
			mclip =	 fvt_form_obj_get("MCL_form", "mcl_wanIP"+i);
			if( mclip != "")
				mclip+=("/"+mask);
			fvt_paramlist_cat_str("fw_remotemng_accept"+i+"_ip", mclip);
		}
		// for Lan
		fvt_paramlist_cat_str("fw_lanmng_accept_any", fvt_form_obj_get("MCL_form", "MCL_LANPolicy"));
		for(j=0;j<mcl_lan_max;j++)
		{
			mask = document.getElementById("id_mcl_lanNetmask"+j).value;
			mclip =	 fvt_form_obj_get("MCL_form", "mcl_lanIP"+j);
			if( mclip != "")
				mclip+=("/"+mask);
			fvt_paramlist_cat_str("fw_lanmng_accept"+j+"_ip", mclip);
		}
		submit_ssh_enable();
		submit_telnet_enable();
	}
	fvt_paramlist_presubmit('MCL_form');
}

function show_wan_netmask(i, IP_Netmask, show)
{
	if(IP_Netmask == 0 || IP_Netmask == undefined)
		IP_Netmask = 32;
	if (show == 1)
		document.write("<select name='MclWanNetmask"+padLeft(i+"","2")+"' id='id_mcl_wanNetmask"+i+"' >");
	else
		document.write("<select name='MclWanNetmask"+padLeft(i+"","2")+"' id='id_mcl_wanNetmask"+i+"' disabled='disabled'>");

	document.write(" <option value='32' "+((IP_Netmask=="32" ) ? " selected" : "")+" >255.255.255.255</option>\n");
	document.write(" <option value='31' "+((IP_Netmask=="31" ) ? " selected" : "")+" >255.255.255.254</option>\n");
	document.write(" <option value='30' "+((IP_Netmask=="30" ) ? " selected" : "")+" >255.255.255.252</option>\n");
	document.write(" <option value='29' "+((IP_Netmask=="29" ) ? " selected" : "")+" >255.255.255.248</option>\n");
	document.write(" <option value='28' "+((IP_Netmask=="28" ) ? " selected" : "")+" >255.255.255.240</option>\n");
	document.write(" <option value='27' "+((IP_Netmask=="27" ) ? " selected" : "")+" >255.255.255.224</option>\n");
	document.write(" <option value='26' "+((IP_Netmask=="26" ) ? " selected" : "")+" >255.255.255.192</option>\n");
	document.write(" <option value='25' "+((IP_Netmask=="25" ) ? " selected" : "")+" >255.255.255.128</option>\n");
	document.write(" <option value='24' "+((IP_Netmask=="24" ) ? " selected" : "")+" >255.255.255.0</option>\n");
	document.write(" <option value='23' "+((IP_Netmask=="23" ) ? " selected" : "")+" >255.255.254.0</option>\n");
	document.write(" <option value='22' "+((IP_Netmask=="22" ) ? " selected" : "")+" >255.255.252.0</option>\n");
	document.write(" <option value='21' "+((IP_Netmask=="21" ) ? " selected" : "")+" >255.255.248.0</option>\n");
	document.write(" <option value='20' "+((IP_Netmask=="20" ) ? " selected" : "")+" >255.255.240.0</option>\n");
	document.write(" <option value='19' "+((IP_Netmask=="19" ) ? " selected" : "")+" >255.255.224.0</option>\n");
	document.write(" <option value='18' "+((IP_Netmask=="18" ) ? " selected" : "")+" >255.255.192.0</option>\n");
	document.write(" <option value='17' "+((IP_Netmask=="17" ) ? " selected" : "")+" >255.255.128.0</option>\n");
	document.write(" <option value='16' "+((IP_Netmask=="16" ) ? " selected" : "")+" >255.255.0.0</option>\n");
	document.write(" <option value='15' "+((IP_Netmask=="15" ) ? " selected" : "")+" >255.254.0.0</option>\n");
	document.write(" <option value='14' "+((IP_Netmask=="14" ) ? " selected" : "")+" >255.252.0.0</option>\n");
	document.write(" <option value='13' "+((IP_Netmask=="13" ) ? " selected" : "")+" >255.248.0.0</option>\n");
	document.write(" <option value='12' "+((IP_Netmask=="12" ) ? " selected" : "")+" >255.240.0.0</option>\n");
	document.write(" <option value='11' "+((IP_Netmask=="11" ) ? " selected" : "")+" >255.224.0.0</option>\n");
	document.write(" <option value='10' "+((IP_Netmask=="10" ) ? " selected" : "")+" >255.192.0.0</option>\n");
	document.write(" <option value='9' "+((IP_Netmask=="9" ) ? " selected" : "")+" >255.128.0.0</option>\n");
	document.write(" <option value='8' "+((IP_Netmask=="8" ) ? " selected" : "")+" >255.0.0.0</option>\n");
	document.write(" <option value='7' "+((IP_Netmask=="7" ) ? " selected" : "")+" >254.0.0.0</option>\n");
	document.write(" <option value='6' "+((IP_Netmask=="6" ) ? " selected" : "")+" >252.0.0.0</option>\n");
	document.write(" <option value='5' "+((IP_Netmask=="5" ) ? " selected" : "")+" >248.0.0.0</option>\n");
	document.write(" <option value='4' "+((IP_Netmask=="4" ) ? " selected" : "")+" >240.0.0.0</option>\n");
	document.write(" <option value='3' "+((IP_Netmask=="3" ) ? " selected" : "")+" >224.0.0.0</option>\n");
	document.write(" <option value='2' "+((IP_Netmask=="2" ) ? " selected" : "")+" >192.0.0.0</option>\n");
	document.write(" <option value='1' "+((IP_Netmask=="1" ) ? " selected" : "")+" >128.0.0.0</option>\n");
	document.write("</select>");
}

function list_wan_mcl()
{
	var i;
	for(i=0;i<mcl_wan_max;i++)
	{
		var vmclip = fvt_meta_config("fw_remotemng_accept"+i+"_ip");
		var mask;
		if(vmclip !="")
		{
			mcl_ip = vmclip.split("/");
			var mask = parseInt(mcl_ip[1],10);
			var ip = mcl_ip[0];

			mcl_ip=ip.split(".");
		}
		else
		{
			var mcl_ip = new Array();
			mcl_ip[0] ="";
			mcl_ip[1] ="";
			mcl_ip[2] ="";
			mcl_ip[3] ="";
			mask = 32;
		}

		/*if(vmclip !=""){
			mcl_ip = vmclip.split(".");
		}
		else{
			var mcl_ip = new Array();
			mcl_ip[0] ="";
			mcl_ip[1] ="";
			mcl_ip[2] ="";
			mcl_ip[3] ="";
		}*/

		document.write("<tr>");
		document.write("<td class='width_lanset1'>Accept IP "+(i+1)+"&nbsp;</td>");
		document.write("<td><div>");
		document.write("<input type='hidden' name='mcl_wanIP"+i+"' id='id_mcl_wanIP"+i+"' size='17' maxlength='17' value='"+ip+"'>");
		document.write("<input type='text' id='id_mcl_wanIP"+i+"_item1' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[0]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_wanIP"+i+"_item2' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[1]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_wanIP"+i+"_item3' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[2]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_wanIP"+i+"_item4' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[3]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>");
		document.write("</div></td>");
		document.write("<td>&nbsp;</td>");
		document.write("<td><div>");
		show_wan_netmask(i,mask,1);
		document.write("</div></td>");

		document.write("</tr>");
	}
//// for cht hiden
//	for(i=mcl_wan_max;i<mcl_wan_max+8;i++)
//	{
//		var vmclip = fvt_meta_config("fw_remotemng_accept"+i+"_ip");
//		var mask;
//		if(vmclip !=""){
//			mcl_ip = vmclip.split("/");
//			var mask = parseInt(mcl_ip[1],10);
//			var ip = mcl_ip[0];
//			mcl_ip=ip.split(".");
//		}
//		else{
//			var mcl_ip = new Array();
//			mcl_ip[0] ="";
//			mcl_ip[1] ="";
//			mcl_ip[2] ="";
//			mcl_ip[3] ="";
//			mask = 32;
//		}
//
//		document.write("<tr>");
//		document.write("<td class='width_lanset1'><b>Accept IP "+(i+1)+"&nbsp;</b></td>");
//		document.write("<td><div>");
//		document.write("<input type='hidden' name='mcl_wanIP"+i+"' id='id_mcl_wanIP"+i+"' size='17' maxlength='17' value='"+ip+"'>");
//		document.write("<input type='text' disabled='disabled' id='id_mcl_wanIP"+i+"_item1' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[0]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
//		document.write("<input type='text' disabled='disabled' id='id_mcl_wanIP"+i+"_item2' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[1]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
//		document.write("<input type='text' disabled='disabled' id='id_mcl_wanIP"+i+"_item3' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[2]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>.");
//		document.write("<input type='text' disabled='disabled' id='id_mcl_wanIP"+i+"_item4' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[3]+"' onkeyup='WanwriteToHidden(\""+i+"\")'>");
//		document.write("</div></td>");
//		document.write("<td>&nbsp;</td>");
//		document.write("<td><div>");
//		show_wan_netmask(i,mask,1);
//		document.write("</div></td>");
//
//		document.write("</tr>");
//	}
}

function show_wan_netmask(i, IP_Netmask, show)
{
	if(IP_Netmask == 0 || IP_Netmask == undefined)
		IP_Netmask = 32;
	if (show == 1)
		document.write("<select name='MclWanNetmask"+padLeft(i+"","2")+"' id='id_mcl_wanNetmask"+i+"' >");
	else
		document.write("<select name='MclWanNetmask"+padLeft(i+"","2")+"' id='id_mcl_wanNetmask"+i+"' disabled='disabled'>");

	document.write(" <option value='32' "+((IP_Netmask=="32" ) ? " selected" : "")+" >255.255.255.255</option>\n");
	document.write(" <option value='31' "+((IP_Netmask=="31" ) ? " selected" : "")+" >255.255.255.254</option>\n");
	document.write(" <option value='30' "+((IP_Netmask=="30" ) ? " selected" : "")+" >255.255.255.252</option>\n");
	document.write(" <option value='29' "+((IP_Netmask=="29" ) ? " selected" : "")+" >255.255.255.248</option>\n");
	document.write(" <option value='28' "+((IP_Netmask=="28" ) ? " selected" : "")+" >255.255.255.240</option>\n");
	document.write(" <option value='27' "+((IP_Netmask=="27" ) ? " selected" : "")+" >255.255.255.224</option>\n");
	document.write(" <option value='26' "+((IP_Netmask=="26" ) ? " selected" : "")+" >255.255.255.192</option>\n");
	document.write(" <option value='25' "+((IP_Netmask=="25" ) ? " selected" : "")+" >255.255.255.128</option>\n");
	document.write(" <option value='24' "+((IP_Netmask=="24" ) ? " selected" : "")+" >255.255.255.0</option>\n");
	document.write(" <option value='23' "+((IP_Netmask=="23" ) ? " selected" : "")+" >255.255.254.0</option>\n");
	document.write(" <option value='22' "+((IP_Netmask=="22" ) ? " selected" : "")+" >255.255.252.0</option>\n");
	document.write(" <option value='21' "+((IP_Netmask=="21" ) ? " selected" : "")+" >255.255.248.0</option>\n");
	document.write(" <option value='20' "+((IP_Netmask=="20" ) ? " selected" : "")+" >255.255.240.0</option>\n");
	document.write(" <option value='19' "+((IP_Netmask=="19" ) ? " selected" : "")+" >255.255.224.0</option>\n");
	document.write(" <option value='18' "+((IP_Netmask=="18" ) ? " selected" : "")+" >255.255.192.0</option>\n");
	document.write(" <option value='17' "+((IP_Netmask=="17" ) ? " selected" : "")+" >255.255.128.0</option>\n");
	document.write(" <option value='16' "+((IP_Netmask=="16" ) ? " selected" : "")+" >255.255.0.0</option>\n");
	document.write(" <option value='15' "+((IP_Netmask=="15" ) ? " selected" : "")+" >255.254.0.0</option>\n");
	document.write(" <option value='14' "+((IP_Netmask=="14" ) ? " selected" : "")+" >255.252.0.0</option>\n");
	document.write(" <option value='13' "+((IP_Netmask=="13" ) ? " selected" : "")+" >255.248.0.0</option>\n");
	document.write(" <option value='12' "+((IP_Netmask=="12" ) ? " selected" : "")+" >255.240.0.0</option>\n");
	document.write(" <option value='11' "+((IP_Netmask=="11" ) ? " selected" : "")+" >255.224.0.0</option>\n");
	document.write(" <option value='10' "+((IP_Netmask=="10" ) ? " selected" : "")+" >255.192.0.0</option>\n");
	document.write(" <option value='9' "+((IP_Netmask=="9" ) ? " selected" : "")+" >255.128.0.0</option>\n");
	document.write(" <option value='8' "+((IP_Netmask=="8" ) ? " selected" : "")+" >255.0.0.0</option>\n");
	document.write(" <option value='7' "+((IP_Netmask=="7" ) ? " selected" : "")+" >254.0.0.0</option>\n");
	document.write(" <option value='6' "+((IP_Netmask=="6" ) ? " selected" : "")+" >252.0.0.0</option>\n");
	document.write(" <option value='5' "+((IP_Netmask=="5" ) ? " selected" : "")+" >248.0.0.0</option>\n");
	document.write(" <option value='4' "+((IP_Netmask=="4" ) ? " selected" : "")+" >240.0.0.0</option>\n");
	document.write(" <option value='3' "+((IP_Netmask=="3" ) ? " selected" : "")+" >224.0.0.0</option>\n");
	document.write(" <option value='2' "+((IP_Netmask=="2" ) ? " selected" : "")+" >192.0.0.0</option>\n");
	document.write(" <option value='1' "+((IP_Netmask=="1" ) ? " selected" : "")+" >128.0.0.0</option>\n");
	document.write("</select>");
}

function list_lan_mcl()
{
	var i;
	for(i=0;i<mcl_lan_max;i++)
	{
		var vmclip = fvt_meta_config("fw_lanmng_accept"+i+"_ip");
		var mask;
		if(vmclip !="")
		{
			mcl_ip = vmclip.split("/");
			var mask = parseInt(mcl_ip[1],10);
			var ip = mcl_ip[0];

			mcl_ip=ip.split(".");
		}
		else
		{
			var mcl_ip = new Array();
			mcl_ip[0] ="";
			mcl_ip[1] ="";
			mcl_ip[2] ="";
			mcl_ip[3] ="";
			mask = 32;
		}

		document.write("<tr>");
		document.write("<td class='width_lanset1'>Accept IP "+(i+1)+"&nbsp;</td>");
		document.write("<td><div>");
		document.write("<input type='hidden' name='mcl_lanIP"+i+"' id='id_mcl_lanIP"+i+"' size='17' maxlength='17' value='"+ip+"'>");
		document.write("<input type='text' id='id_mcl_lanIP"+i+"_item1' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[0]+"' onkeyup='LanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_lanIP"+i+"_item2' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[1]+"' onkeyup='LanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_lanIP"+i+"_item3' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[2]+"' onkeyup='LanwriteToHidden(\""+i+"\")'>.");
		document.write("<input type='text' id='id_mcl_lanIP"+i+"_item4' class='width_ip' size='3' maxlength='3' value='"+mcl_ip[3]+"' onkeyup='LanwriteToHidden(\""+i+"\")'>");
		document.write("</div></td>");
		document.write("<td>&nbsp;</td>");
		document.write("<td><div>");
		show_lan_netmask(i,mask,1);
		document.write("</div></td>");

		document.write("</tr>");
	}
}

function show_lan_netmask(i, IP_Netmask, show)
{
	if(IP_Netmask == 0 || IP_Netmask == undefined)
		IP_Netmask = 32;
	if (show == 1)
		document.write("<select name='MclLanNetmask"+padLeft(i+"","2")+"' id='id_mcl_lanNetmask"+i+"' >");
	else
		document.write("<select name='MclLanNetmask"+padLeft(i+"","2")+"' id='id_mcl_lanNetmask"+i+"' disabled='disabled'>");

	document.write(" <option value='32' "+((IP_Netmask=="32" ) ? " selected" : "")+" >255.255.255.255</option>\n");
	document.write(" <option value='31' "+((IP_Netmask=="31" ) ? " selected" : "")+" >255.255.255.254</option>\n");
	document.write(" <option value='30' "+((IP_Netmask=="30" ) ? " selected" : "")+" >255.255.255.252</option>\n");
	document.write(" <option value='29' "+((IP_Netmask=="29" ) ? " selected" : "")+" >255.255.255.248</option>\n");
	document.write(" <option value='28' "+((IP_Netmask=="28" ) ? " selected" : "")+" >255.255.255.240</option>\n");
	document.write(" <option value='27' "+((IP_Netmask=="27" ) ? " selected" : "")+" >255.255.255.224</option>\n");
	document.write(" <option value='26' "+((IP_Netmask=="26" ) ? " selected" : "")+" >255.255.255.192</option>\n");
	document.write(" <option value='25' "+((IP_Netmask=="25" ) ? " selected" : "")+" >255.255.255.128</option>\n");
	document.write(" <option value='24' "+((IP_Netmask=="24" ) ? " selected" : "")+" >255.255.255.0</option>\n");
	document.write(" <option value='23' "+((IP_Netmask=="23" ) ? " selected" : "")+" >255.255.254.0</option>\n");
	document.write(" <option value='22' "+((IP_Netmask=="22" ) ? " selected" : "")+" >255.255.252.0</option>\n");
	document.write(" <option value='21' "+((IP_Netmask=="21" ) ? " selected" : "")+" >255.255.248.0</option>\n");
	document.write(" <option value='20' "+((IP_Netmask=="20" ) ? " selected" : "")+" >255.255.240.0</option>\n");
	document.write(" <option value='19' "+((IP_Netmask=="19" ) ? " selected" : "")+" >255.255.224.0</option>\n");
	document.write(" <option value='18' "+((IP_Netmask=="18" ) ? " selected" : "")+" >255.255.192.0</option>\n");
	document.write(" <option value='17' "+((IP_Netmask=="17" ) ? " selected" : "")+" >255.255.128.0</option>\n");
	document.write(" <option value='16' "+((IP_Netmask=="16" ) ? " selected" : "")+" >255.255.0.0</option>\n");
	document.write(" <option value='15' "+((IP_Netmask=="15" ) ? " selected" : "")+" >255.254.0.0</option>\n");
	document.write(" <option value='14' "+((IP_Netmask=="14" ) ? " selected" : "")+" >255.252.0.0</option>\n");
	document.write(" <option value='13' "+((IP_Netmask=="13" ) ? " selected" : "")+" >255.248.0.0</option>\n");
	document.write(" <option value='12' "+((IP_Netmask=="12" ) ? " selected" : "")+" >255.240.0.0</option>\n");
	document.write(" <option value='11' "+((IP_Netmask=="11" ) ? " selected" : "")+" >255.224.0.0</option>\n");
	document.write(" <option value='10' "+((IP_Netmask=="10" ) ? " selected" : "")+" >255.192.0.0</option>\n");
	document.write(" <option value='9' "+((IP_Netmask=="9" ) ? " selected" : "")+" >255.128.0.0</option>\n");
	document.write(" <option value='8' "+((IP_Netmask=="8" ) ? " selected" : "")+" >255.0.0.0</option>\n");
	document.write(" <option value='7' "+((IP_Netmask=="7" ) ? " selected" : "")+" >254.0.0.0</option>\n");
	document.write(" <option value='6' "+((IP_Netmask=="6" ) ? " selected" : "")+" >252.0.0.0</option>\n");
	document.write(" <option value='5' "+((IP_Netmask=="5" ) ? " selected" : "")+" >248.0.0.0</option>\n");
	document.write(" <option value='4' "+((IP_Netmask=="4" ) ? " selected" : "")+" >240.0.0.0</option>\n");
	document.write(" <option value='3' "+((IP_Netmask=="3" ) ? " selected" : "")+" >224.0.0.0</option>\n");
	document.write(" <option value='2' "+((IP_Netmask=="2" ) ? " selected" : "")+" >192.0.0.0</option>\n");
	document.write(" <option value='1' "+((IP_Netmask=="1" ) ? " selected" : "")+" >128.0.0.0</option>\n");
	document.write("</select>");
}

function changeLan_disable()
{
	var i;
	var val;
	if (document.getElementById('MCL_LANPolicy').value==1)
	{
		val=true;
		document.getElementById("id_allow_warning").style.display="none";
	}
	else
	{
		val=false;
		document.getElementById("id_allow_warning").style.display="inline";
	}
	for(i=0;i<mcl_lan_max;i++)
	{
		document.getElementById("id_mcl_lanIP"+i+"_item1").disabled = val;
		document.getElementById("id_mcl_lanIP"+i+"_item2").disabled = val;
		document.getElementById("id_mcl_lanIP"+i+"_item3").disabled = val;
		document.getElementById("id_mcl_lanIP"+i+"_item4").disabled = val;
		document.getElementById("id_mcl_lanNetmask"+i).disabled = val;
	}
}
function LanwriteToHidden(index)
{
	var master="id_mcl_lanIP" + index;
	var item1="id_mcl_lanIP" + index + "_item1";
	var item2="id_mcl_lanIP" + index + "_item2";
	var item3="id_mcl_lanIP" + index + "_item3";
	var item4="id_mcl_lanIP" + index + "_item4";
	merge_ip(master,item1,item2,item3,item4);
}
</script>
</head>

<body align="left" onload="fvt_form_init('MCL_form');">
<div id="container">
<table align="center" width="90%"><tbody>
<tr><td valign="top">
<form id="MCL_form" name="MCL_form" method="post">
	<fieldset>
		<div class="lv1_title">Firewall Setup&nbsp;&gt;&nbsp;MCL</div>
	</fieldset>
	<br>
	<div class="div1_topbottom lv1_new rowh" ctrlflip="right" ctrlid="297">Allow Remote Management from WAN</div>
	<div class="div1_indent lv2_new">
		<table>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">Telnet</div></td>
				<td><select ar='1' ctrlflip="etc" id="remoteTelnetEnableW" name="remoteTelnetEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">SSH</div></td>
				<td><select ar='1' ctrlflip="etc" id="remoteSSHEnableW" name="remoteSSHEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">TFTP</div></td>
				<td><select ar='1' ctrlflip="etc" id="TFTPEnableW" name="TFTPEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">WEB</div></td>
				<td><select ar='1' ctrlflip="etc" id="WEBEnableW" name="WEBEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">SNMP</div></td>
				<td><select ar='1' ctrlflip="etc" id="SNMPEnableW" name="SNMPEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr id="tb_tr069W" style="display:none">
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">TR069</div></td>
				<td><select ar='1' ctrlflip="etc" id="TR069EnableW" name="TR069EnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">PING</div></td>
				<td><select ar='1' ctrlflip="etc" id="PINGEnableW" name="PINGEnableW" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
		</table>
	</div>
	<div id="id_wanips" class="div2_indent lv2_new">
		<table>
			<tr>
				<td colspan="2" width="500"><hr noshade="noshade" style="border:1px #AAA dotted;"></td>
			</tr>
			<tr>
				<td><div class="lv1_new rowh">Only the WAN IP Listed can Access</div></td>
				<td><select name="MCL_WANPolicy" id="MCL_WANPolicy" class="width_select80" onclick="changeWan_disable();">
					<option value="1" selected>Disable</option>
					<option value="0">Enable</option>
				</select></td>
			</tr>
			<tr><td>&nbsp;</td></tr>
		</table>
		<table>
			<script language="javascript" type="text/javascript">
				list_wan_mcl();
			</script>
			<tr><td>&nbsp;</td></tr>
		</table>
	</div>
	<div><hr class="hr2"></div>
	<br>
	<div class="div1_topbottom lv1_new rowh" ctrlflip="right" ctrlid="297">Allow Local Management from LAN</div>
	<div class="div1_indent lv2_new">
		<table>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">Telnet</div></td>
				<td><select ar='1' ctrlflip="etc" id="remoteTelnetEnableL" name="remoteTelnetEnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">SSH</div></td>
				<td><select ar='1' ctrlflip="etc" id="remoteSSHEnableL" name="remoteSSHEnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">TFTP</div></td>
				<td><select ar='1' ctrlflip="etc" id="TFTPEnableL" name="TFTPEnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">WEB</div></td>
				<td><select ar='1' ctrlflip="etc" id="WEBEnableL" name="WEBEnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr>
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">SNMP</div></td>
				<td><select ar='1' ctrlflip="etc" id="SNMPEnableL" name="SNMPEnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
			<tr id="tb_tr069L" style="display:none">
				<td class="width_systemset3"><div ctrlflip="right" ctrlid="298">TR069</div></td>
				<td><select ar='1' ctrlflip="etc" id="TR069EnableL" name="TR069EnableL" onchange="" class="">
					<option value="0">Disable</option>
					<option value="1">Enable</option>
				</select></td>
			</tr>
		</table>
	</div>
	<div id="id_lanips" class="div2_indent lv2_new">
		<table>
			<tr>
				<td colspan="2" width="500"><hr noshade="noshade" style="border:1px #AAA dotted;"></td>
			</tr>
			<tr>
				<td><div class="lv1_new rowh">Only the LAN IP Listed can Access</div></td>
				<td><select name="MCL_LANPolicy" id="MCL_LANPolicy" class="width_select80" onclick="changeLan_disable();">
					<option value="1" selected>Disable</option>
					<option value="0">Enable</option>
				</select></td>
			</tr>
		</table>
		<table>
			<tr>
				<td>&nbsp;</td>
				<td id="id_allow_warning" style="display:none" class="warning">
					Remember to set your own IP address to Accept IP list, otherwise you will unable to login!
				</td>
			</tr>
		</table>
		<table>
			<script language="javascript" type="text/javascript">
				list_lan_mcl();
			</script>
			<tr><td>&nbsp;</td></tr>
		</table>
	</div>
	<div><hr class="hr2"></div>
	<div>
		<table class="utiltable" ><tbody>
			<tr id="id_apply_tr"><td></td><td></td>
			<td><input type="button" onclick="MCLSetting()" id="add_applybtn" name="applybtn" value="Apply Changes" style="padding:0px 2px;width:auto;height:20px;"><td>
			</tr>
			<tr id="id_wait_progress" style="display:none">
				<td></td><td></td>
				<td>
					<img src="../images/progress1.gif">
				</td>
			</tr>
		</tbody></table>
	</div>
</form>
</td></tr>
</tbody></table>
</div>

<br>
</body>
</html>

